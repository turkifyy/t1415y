<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="Ù…Ù†ØµØ© Ù…ØªÙ‚Ø¯Ù…Ø© Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ù…Ø¹ ØªØ­Ù„ÙŠÙ„Ø§Øª ÙˆÙ†Ø·Ø§Ù‚Ø§Øª Ù…Ø®ØµØµØ© ÙˆÙ…ÙŠØ²Ø§Øª Ù…ØªØ·ÙˆØ±Ø©">
    <meta name="keywords" content="ØªÙ‚ØµÙŠØ± Ø§Ù„Ø±ÙˆØ§Ø¨Ø·, Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±ÙˆØ§Ø¨Ø·, ØªØ­Ù„ÙŠÙ„Ø§Øª, ØªØ³ÙˆÙŠÙ‚ Ø±Ù‚Ù…ÙŠ">
    <title>Turkify Pro - Ù…Ù†ØµØ© Ù…ØªÙ‚Ø¯Ù…Ø© Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±ÙˆØ§Ø¨Ø·</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-purple: #4A154B;
            --secondary-red: #EF5A5F;
            --accent-teal: #2EC4B6;
            --light-gray: #f8f9fa;
            --dark-gray: #343a40;
            --gradient-start: #6a11cb;
            --gradient-end: #2575fc;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Tajawal', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, var(--light-gray) 0%, #eef2f5 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            color: #333;
            line-height: 1.8;
        }
        
        .navbar {
            background: linear-gradient(90deg, var(--primary-purple) 0%, #5d1d63 100%);
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            padding: 0.8rem 0;
        }
        
        .logo {
            font-weight: 700;
            color: white;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo span {
            color: var(--secondary-red);
        }
        
        .logo-icon {
            background: var(--secondary-red);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .navbar-toggler {
            border: none;
            outline: none;
            box-shadow: none;
        }
        
        .nav-link {
            padding: 0.5rem 1rem;
            transition: all 0.3s;
            display: flex;
            align-items: center;
        }
        
        .nav-link:hover {
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
        }
        
        .navbar-collapse {
            justify-content: flex-end;
        }
        
        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø¹ØµØ±ÙŠØ© */
.nav-link-modern {
    display: flex !important;
    align-items: center;
    gap: 8px;
    padding: 0.7rem 1.2rem !important;
    border-radius: 12px;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
    font-weight: 500;
    margin: 0 5px;
}

.nav-link-modern:hover {
    background: rgba(255, 255, 255, 0.15) !important;
    transform: translateY(-1px);
    box-shadow: 0 4px 15px rgba(255, 255, 255, 0.1);
}

.nav-link-modern.nav-active {
    background: rgba(255, 255, 255, 0.2) !important;
    border: 1px solid rgba(255, 255, 255, 0.3);
}

.nav-icon {
    font-size: 1.1rem;
    transition: transform 0.3s ease;
}

.nav-link-modern:hover .nav-icon {
    transform: scale(1.1);
}

.nav-text {
    font-size: 0.95rem;
    white-space: nowrap;
}

/* Ø´Ø§Ø±Ø§Øª Ø§Ù„Ø¹Ø¯Ø¯ */
.nav-badge {
    background: linear-gradient(135deg, #EF5A5F, #e94348);
    color: white;
    font-size: 0.7rem;
    padding: 2px 6px;
    border-radius: 10px;
    font-weight: 600;
    min-width: 18px;
    text-align: center;
    animation: pulse 2s infinite;
}

.nav-indicator {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    position: absolute;
    top: 8px;
    right: 8px;
}

.analytics-indicator {
    background: linear-gradient(135deg, #2EC4B6, #20bfa9);
    animation: pulse 1.5s infinite;
}

.admin-link {
    background: linear-gradient(135deg, rgba(239, 90, 95, 0.1), rgba(233, 67, 72, 0.1)) !important;
    border: 1px solid rgba(239, 90, 95, 0.2);
}

.admin-crown {
    font-size: 0.8rem;
    filter: drop-shadow(0 0 3px rgba(255, 193, 7, 0.5));
}

/* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ø¬ÙˆØ§Ù„ */
@media (max-width: 991px) {
    .nav-link-modern {
        padding: 0.8rem 1rem !important;
        margin: 5px 0;
        width: 100%;
        justify-content: flex-start;
    }
    
    .navbar-nav {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 12px;
        padding: 15px;
        margin-top: 15px;
    }
    
    .nav-text {
        margin-left: 10px;
    }
}

/* ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø­Ø±ÙƒØ© */
@keyframes pulse {
    0% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.7; transform: scale(1.1); }
    100% { opacity: 1; transform: scale(1); }
}

/* Ù‚Ø³Ù… Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ø¹ØµØ±ÙŠ */
.auth-section {
    display: flex;
    align-items: center;
    gap: 15px;
}

.user-profile-modern {
    display: flex;
    align-items: center;
    gap: 12px;
    background: rgba(255, 255, 255, 0.1);
    padding: 8px 15px;
    border-radius: 25px;
    transition: all 0.3s ease;
}

.user-profile-modern:hover {
    background: rgba(255, 255, 255, 0.15);
}

.user-avatar {
    width: 35px;
    height: 35px;
    border-radius: 50%;
    border: 2px solid rgba(255, 255, 255, 0.3);
    object-fit: cover;
}

.user-info {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
}

.user-name {
    font-size: 0.9rem;
    font-weight: 600;
    color: white;
    margin: 0;
}

.user-role {
    font-size: 0.7rem;
    color: rgba(255, 255, 255, 0.7);
    margin: 0;
}

.sign-in-btn-modern {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.1));
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: white;
    padding: 10px 20px;
    border-radius: 25px;
    transition: all 0.3s ease;
    font-weight: 500;
}

.sign-in-btn-modern:hover {
    background: rgba(255, 255, 255, 0.2);
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(255, 255, 255, 0.1);
}

/* Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø­Ø§Ù„Ø© */
.status-indicator {
    position: relative;
}

.status-indicator::after {
    content: '';
    position: absolute;
    top: -2px;
    right: -2px;
    width: 10px;
    height: 10px;
    border-radius: 50%;
    border: 2px solid white;
}

.status-online::after {
    background: #28a745;
}

.status-busy::after {
    background: #ffc107;
}

/* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© */
.navbar-toggler {
    border: none;
    padding: 8px;
    border-radius: 8px;
    background: rgba(255, 255, 255, 0.1);
}

.navbar-toggler:focus {
    box-shadow: 0 0 0 0.25rem rgba(255, 255, 255, 0.2);
}

.navbar-brand {
    transition: transform 0.3s ease;
}

.navbar-brand:hover {
    transform: scale(1.05);
}
        
        .card {
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            border: none;
            margin-bottom: 30px;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            overflow: hidden;
            background: white;
        }
        
        .card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }
        
        .card-header {
            background: linear-gradient(90deg, var(--primary-purple) 0%, #5d1d63 100%);
            color: white;
            font-weight: 600;
            border-radius: 16px 16px 0 0 !important;
            padding: 1.2rem 1.5rem;
            font-size: 1.1rem;
        }
        
        .btn-primary {
            background: linear-gradient(90deg, var(--primary-purple) 0%, #5d1d63 100%);
            border: none;
            padding: 0.8rem 1.8rem;
            font-weight: 500;
            border-radius: 12px;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            background: linear-gradient(90deg, #3a1043 0%, #4a154b 100%);
            transform: translateY(-2px);
            box-shadow: 0 7px 15px rgba(74, 21, 75, 0.3);
        }
        
        .btn-danger {
            background: linear-gradient(90deg, var(--secondary-red) 0%, #e94348 100%);
            border: none;
            padding: 0.8rem 1.8rem;
            font-weight: 500;
            border-radius: 12px;
            transition: all 0.3s ease;
        }
        
        .btn-danger:hover {
            background: linear-gradient(90deg, #d93439 0%, #e94348 100%);
            transform: translateY(-2px);
            box-shadow: 0 7px 15px rgba(239, 90, 95, 0.3);
        }
        
        .form-control, .form-select {
            border: 2px solid #eaeaea;
            border-radius: 12px;
            padding: 0.8rem 1.2rem;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: var(--accent-teal);
            box-shadow: 0 0 0 0.25rem rgba(46, 196, 182, 0.2);
        }
        
        .stat-card {
            text-align: center;
            padding: 25px 20px;
            border-radius: 16px;
            background: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        
        .stat-number {
            font-size: 2.8rem;
            font-weight: 700;
            background: linear-gradient(90deg, var(--primary-purple) 0%, var(--accent-teal) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 10px 0;
        }
        
        .stat-label {
            font-size: 1.1rem;
            color: var(--dark-gray);
            font-weight: 500;
        }
        
        .link-card {
            border-left: 4px solid var(--accent-teal);
            transition: all 0.3s ease;
        }
        
        .link-card:hover {
            border-left: 4px solid var(--secondary-red);
        }
        
        .link-url {
            font-size: 0.95rem;
            color: #6c757d;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .short-url {
            color: var(--primary-purple);
            font-weight: 600;
            transition: color 0.3s;
        }
        
        .short-url:hover {
            color: var(--accent-teal);
            text-decoration: none;
        }
        
        .clicks-badge {
            background: linear-gradient(90deg, var(--secondary-red) 0%, #e94348 100%);
            padding: 0.4rem 0.8rem;
            border-radius: 50px;
            font-weight: 500;
        }
        
        .loader {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-top: 4px solid var(--accent-teal);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 30px auto;
            display: none;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .redirect-container {
            max-width: 700px;
            margin: 80px auto;
            text-align: center;
            padding: 40px;
            border-radius: 20px;
            background: white;
            box-shadow: 0 15px 50px rgba(0,0,0,0.1);
        }
        
        .redirect-icon {
            font-size: 5rem;
            background: linear-gradient(90deg, var(--primary-purple) 0%, var(--accent-teal) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 25px;
        }
        
        .redirect-btn {
            margin-top: 30px;
            padding: 0.8rem 2.5rem;
            border-radius: 12px;
            font-weight: 500;
        }
        
        .admin-only {
            display: none;
        }
        
        .action-buttons .btn {
            margin-right: 8px;
            border-radius: 10px;
            padding: 0.5rem 0.9rem;
        }
        
        .table-responsive {
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .table th {
            background: linear-gradient(90deg, var(--primary-purple) 0%, #5d1d63 100%);
            color: white;
            font-weight: 500;
            padding: 1.1rem 1.5rem;
        }
        
        .table td {
            padding: 1.1rem 1.5rem;
            vertical-align: middle;
        }
        
        .feature-icon {
            width: 70px;
            height: 70px;
            border-radius: 20px;
            background: rgba(74, 21, 75, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 30px;
            color: var(--primary-purple);
        }
        
        .hero-section {
            background: linear-gradient(135deg, var(--gradient-start) 0%, var(--gradient-end) 100%);
            color: white;
            padding: 100px 0 80px;
            border-radius: 0 0 30px 30px;
            margin-bottom: -50px;
            position: relative;
            overflow: hidden;
        }
        
        .custom-shape {
            position: absolute;
            width: 150px;
            height: 150px;
            background: linear-gradient(135deg, var(--accent-teal) 0%, rgba(46, 196, 182, 0.3) 100%);
            border-radius: 40% 60% 70% 30% / 40% 50% 60% 50%;
            z-index: 0;
        }
        
        .shape-1 {
            top: 10%;
            left: 5%;
            animation: float 8s infinite ease-in-out;
        }
        
        .shape-2 {
            bottom: 15%;
            right: 7%;
            width: 120px;
            height: 120px;
            animation: float 10s infinite ease-in-out;
            animation-delay: 1s;
        }
        
        @keyframes float {
            0% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(10deg); }
            100% { transform: translateY(0) rotate(0deg); }
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 12px;
            color: white;
            font-weight: 500;
            z-index: 1000;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transform: translateX(200%);
            transition: transform 0.4s ease;
            display: none;
        }
        
        .notification.show {
            transform: translateX(0);
            display: block;
        }
        
        .notification.success {
            background: linear-gradient(90deg, #2EC4B6 0%, #20bfa9 100%);
        }
        
        .notification.error {
            background: linear-gradient(90deg, #EF5A5F 0%, #e94348 100%);
        }
        
        .notification.info {
            background: linear-gradient(90deg, #4A154B 0%, #5d1d63 100%);
        }
        
        .progress-bar {
            height: 5px;
            background: rgba(255,255,255,0.5);
            width: 100%;
            margin-top: 10px;
            border-radius: 3px;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background: white;
            width: 100%;
            animation: progress 3s linear forwards;
        }
        
        @keyframes progress {
            0% { width: 100%; }
            100% { width: 0%; }
        }
        
        .modal-content {
            border-radius: 20px;
            overflow: hidden;
            border: none;
            box-shadow: 0 20px 50px rgba(0,0,0,0.2);
        }
        
        .modal-header {
            background: linear-gradient(90deg, var(--primary-purple) 0%, #5d1d63 100%);
            color: white;
        }
        
        .device-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .device-desktop {
            background: rgba(74, 21, 75, 0.1);
            color: var(--primary-purple);
        }
        
        .device-mobile {
            background: rgba(46, 196, 182, 0.1);
            color: var(--accent-teal);
        }
        
        .device-tablet {
            background: rgba(239, 90, 95, 0.1);
            color: var(--secondary-red);
        }
        
        .country-flag {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            margin-right: 10px;
            object-fit: cover;
        }
        
        .stats-card {
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            background: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .nav-active {
            background: rgba(255,255,255,0.2);
            border-radius: 8px;
        }
        
        .table-loader {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
        }
        
        .qr-code-container {
            text-align: center;
            margin: 20px 0;
        }
        
        #qrcode {
            display: inline-block;
            padding: 10px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .platform-stat {
            text-align: center;
            padding: 15px;
        }
        
        .link-type-badge {
            padding: 5px 10px;
            border-radius: 8px;
            font-size: 0.8rem;
            font-weight: 500;
            display: inline-block;
        }
        
        .type-series { background-color: rgba(74, 21, 75, 0.1); color: var(--primary-purple); }
        .type-movie { background-color: rgba(46, 196, 182, 0.1); color: var(--accent-teal); }
        .type-match { background-color: rgba(239, 90, 95, 0.1); color: var(--secondary-red); }
        .type-recipe { background-color: rgba(255, 193, 7, 0.1); color: #ff9800; }
        .type-game { background-color: rgba(63, 81, 181, 0.1); color: #3f51b5; }
        .type-app { background-color: rgba(76, 175, 80, 0.1); color: #4caf50; }
        .type-channel { background-color: rgba(156, 39, 176, 0.1); color: #9c27b0; }
        .type-reels { background-color: rgba(233, 30, 99, 0.1); color: #e91e63; }
        
        .social-preview {
            border-radius: 12px;
            border: 1px solid #eaeaea;
            padding: 15px;
            margin: 20px 0;
            background: white;
            max-width: 500px;
        }
        
        .social-preview-img {
            width: 100%;
            height: 250px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .stats-card {
            border-radius: 12px;
            padding: 20px;
            background: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .stats-card-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--primary-purple);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .stats-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--accent-teal);
            text-align: center;
        }
        
        .stats-chart {
            height: 250px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .redirect-content {
            max-width: 800px;
            margin: 0 auto;
            padding: 30px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .redirect-thumbnail {
            width: 100%;
            height: 350px;
            object-fit: cover;
            border-radius: 12px;
            margin: 20px 0;
            z-index: 999999;
        }
        
        .redirect-title {
            font-size: 2rem;
            font-weight: 700;
            margin: 20px 0;
            color: var(--primary-purple);
        }
        
        .redirect-description {
            font-size: 1.1rem;
            line-height: 1.7;
            color: #555;
            margin-bottom: 30px;
        }
        
        .netflix-style {
            background: #141414;
            color: white;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
        }
        
        .netflix-style .redirect-thumbnail {
            border-radius: 0;
            height: 400px;
        }
        
        .netflix-gradient {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 150px;
            background: linear-gradient(transparent, #141414);
        }
        
        .netflix-content {
            position: relative;
            z-index: 10;
            padding: 30px;
        }
        
        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„ÙˆØµÙˆÙ„ */
        .btn:focus, .form-control:focus {
            outline: 3px solid rgba(46, 196, 182, 0.5);
            outline-offset: 2px;
        }
        
        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ØªØ£Ø®Ø± */
        img[loading] {
            transition: opacity 0.3s;
        }
        
        img[loading="lazy"] {
            opacity: 0;
        }
        
        img[loading="lazy"][data-loaded] {
            opacity: 1;
        }
        
        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„ØªØ¨Ø§ÙŠÙ† Ù„Ù„Ø£Ù„ÙˆØ§Ù† */
        .card-header, .btn-primary, .btn-danger, .clicks-badge {
            color: white !important;
        }
        
        .stat-label {
            color: #333;
            background: rgba(255,255,255,0.7);
            padding: 5px;
            border-radius: 8px;
        }
        
              /* Ø¥ØµÙ„Ø§Ø­ Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ */
.content-card {
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    transition: all 0.3s ease;
    background: #fff;
    margin: 20px 0;
    display: block !important; /* ÙØ±Ø¶ Ø§Ù„Ø¸Ù‡ÙˆØ± */
    visibility: visible !important;
}

.content-thumbnail {
    width: 100%;
    height: 300px;
    object-fit: cover;
    border-radius: 0;
    display: block !important;
    visibility: visible !important;
    background: #f8f9fa; /* Ù„ÙˆÙ† Ø®Ù„ÙÙŠØ© ÙÙŠ Ø­Ø§Ù„Ø© Ø¹Ø¯Ù… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© */
}

.content-info {
    padding: 25px;
    display: block !important;
    visibility: visible !important;
}

.content-meta {
    display: flex !important;
    align-items: center;
    gap: 15px;
    margin-bottom: 15px;
    flex-wrap: wrap;
    visibility: visible !important;
}

.content-title {
    font-size: 1.8rem;
    font-weight: 700;
    margin-bottom: 15px;
    color: var(--primary-purple);
    display: block !important;
    visibility: visible !important;
}

.content-description {
    font-size: 1.1rem;
    line-height: 1.8;
    color: #555;
    margin-bottom: 20px;
    display: block !important;
    visibility: visible !important;
}

/* Ø¥ØµÙ„Ø§Ø­ Ø¹Ø±Ø¶ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ */
.content-type, .content-episode, .content-date {
    display: inline-block !important;
    visibility: visible !important;
    padding: 8px 15px;
    border-radius: 20px;
    font-weight: 500;
    font-size: 0.9rem;
    margin: 5px 5px 5px 0;
}

.content-type {
    background: rgba(74, 21, 75, 0.1);
    color: var(--primary-purple);
}

.content-episode {
    background: rgba(239, 90, 95, 0.1);
    color: var(--secondary-red);
}

.content-date {
    background: rgba(46, 196, 182, 0.1);
    color: var(--accent-teal);
}
        
        /* Ø¥Ø®ÙØ§Ø¡ Ø²Ø± Ø§ÙƒØªØ´Ù Ø§Ù„Ù…ÙŠØ²Ø§Øª */
        .hero-buttons .btn-outline-light {
            display: none;
        }
        
        .redirect-text {
            margin: 25px 0;
            font-size: 1.2rem;
            font-weight: 500;
            color: #4A154B;
            text-align: center;
            padding: 15px;
            background: rgba(74, 21, 75, 0.05);
            border-radius: 12px;
        }
        
        .redirect-text .highlight {
            font-weight: 700;
            color: var(--accent-teal);
        }
        
        .security-text {
            font-size: 0.9rem;
            color: #6c757d;
            text-align: center;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid #eee;
        }
        
        /* Ad Containers */
        .ad-container {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 12px;
            border: 1px solid #eaeaea;
        }
        
        .ad-placeholder {
            width: 100%;
            height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(74, 21, 75, 0.1);
            border-radius: 8px;
            color: #4A154B;
            font-weight: 500;
            margin: 10px 0;
        }
        
        .ad-350x50 { height: 50px; }
        .ad-350x250 { height: 250px; }
        
        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ø¹Ø±Ø¶ Ø¹Ù„Ù‰ Ø§Ù„Ø¬ÙˆØ§Ù„ */
        @media (max-width: 768px) {
            .content-thumbnail {
                height: 250px;
            }
            
            .content-title {
                font-size: 1.5rem;
            }
            
            .hero-section {
                padding: 70px 0 50px;
            }
            
            .table-responsive {
                border-radius: 12px;
            }
            
            .redirect-container {
                margin: 40px 20px;
                padding: 30px 20px;
            }
            
            .platform-stat h3 {
                font-size: 1.8rem;
            }
            
            .platform-stats .col-md-3 {
                margin-bottom: 15px;
            }
            
            .card-header {
                padding: 1rem;
            }
            
            .table th, .table td {
                padding: 0.75rem;
                font-size: 0.9rem;
            }
            
            .table-responsive {
                overflow-x: auto;
            }
            
            .btn-lg {
                padding: 0.8rem 1.2rem;
                font-size: 1rem;
            }
            
            .netflix-style .redirect-thumbnail {
                height: 300px;
            }
            
            .redirect-text {
                font-size: 1rem;
            }
        }
        
        @media (max-width: 576px) {
            .content-thumbnail {
                height: 200px;
            }
            
            .content-title {
                font-size: 1.3rem;
            }
            
            .content-description {
                font-size: 1rem;
            }
            
            .hero-section {
                padding: 50px 0 30px;
            }
            
            .stat-number {
                font-size: 2.2rem;
            }
            
            .table th, .table td {
                padding: 0.5rem;
                font-size: 0.8rem;
            }
            
            .btn {
                padding: 0.5rem 1rem;
            }
            
            .navbar-nav .nav-item {
                margin: 5px 0;
            }
            
            .hero-buttons .btn {
                width: 100%;
                margin-bottom: 10px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .netflix-style .redirect-thumbnail {
                height: 250px;
            }
            
            .redirect-text {
                font-size: 0.9rem;
                padding: 10px;
            }
        }
        
        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ */
        .navbar-collapse {
            flex-basis: 100%;
            flex-grow: 0;
        }
        
        .navbar-nav .nav-link {
            padding: 10px 15px;
            margin: 0 5px;
        }
        
        @media (max-width: 991px) {
            .navbar-nav {
                margin-top: 15px;
            }
            
            .auth-section {
                margin-top: 15px;
                padding-top: 15px;
                border-top: 1px solid rgba(255,255,255,0.1);
            }
        }
        
        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„ØªØ±ÙƒÙŠØ² */
        .btn:focus, .form-control:focus, .form-select:focus, .nav-link:focus {
            box-shadow: 0 0 0 0.25rem rgba(46, 196, 182, 0.5);
        }
        
        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ø¬Ø¯ÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¬ÙˆØ§Ù„ */
        @media (max-width: 576px) {
            .table-responsive {
                font-size: 0.8rem;
            }
            .action-buttons .btn {
                padding: 0.3rem 0.6rem;
                font-size: 0.8rem;
            }
        }

        /* Analytics Filter */
        .analytics-filter {
            background: white;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .filter-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 10px;
        }
        
        .filter-btn {
            padding: 5px 15px;
            border-radius: 20px;
            background: #f1f1f1;
            border: none;
            transition: all 0.3s;
        }
        
        .filter-btn:hover, .filter-btn.active {
            background: var(--primary-purple);
            color: white;
        }
        
       /* Ù†Ø¸Ø§Ù… Ø§Ù„ÙÙ„ØªØ±Ø© Ø§Ù„Ù…ØªØ·ÙˆØ± */
.analytics-filter-system {
    background: #f8f9fa;
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 20px;
    border: 1px solid #eaeaea;
}

.time-quick-btn {
    font-size: 0.9rem;
    padding: 0.4rem 0.8rem;
}

.time-quick-btn.active {
    background: var(--primary-purple);
    color: white;
    border-color: var(--primary-purple);
}

.filter-info {
    background: rgba(74, 21, 75, 0.05) !important;
    border: 1px solid rgba(74, 21, 75, 0.1);
}

.stats-summary {
    background: white;
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 20px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
}

.stats-card-mini {
    text-align: center;
    padding: 15px;
    border-radius: 8px;
    background: #f8f9fa;
    margin-bottom: 10px;
}

.stats-number-mini {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--accent-teal);
}

.stats-label-mini {
    font-size: 0.9rem;
    color: #6c757d;
    margin-top: 5px;
}

.chart-container {
    background: white;
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 20px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    min-height: 300px;
}

.chart-title {
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--primary-purple);
    margin-bottom: 15px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.no-data-message {
    text-align: center;
    padding: 40px;
    color: #6c757d;
}

.loading-chart {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 200px;
}

#timeRangeSelect {
    border: 2px solid #eaeaea;
    border-radius: 8px;
}

#timeRangeSelect:focus {
    border-color: var(--accent-teal);
    box-shadow: 0 0 0 0.25rem rgba(46, 196, 182, 0.2);
}
        
        /* Modern Stats Modal */
        .stats-modal-content {
            padding: 20px;
            border-radius: 16px;
            background: white;
            box-shadow: 0 15px 50px rgba(0,0,0,0.1);
        }
        
        .stats-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .stats-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-purple);
        }
        
        .time-filter {
            display: flex;
            gap: 10px;
        }
        
        .time-btn {
            padding: 5px 12px;
            border-radius: 20px;
            background: #f1f1f1;
            border: none;
            transition: all 0.3s;
        }
        
        .time-btn:hover, .time-btn.active {
            background: var(--accent-teal);
            color: white;
        }
        
        /* Earnings Modal */
        .earnings-chart {
            height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px 0;
        }
        
        .earnings-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .earnings-card {
            background: white;
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            text-align: center;
        }
        
        .earnings-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent-teal);
            margin: 10px 0;
        }
        
        .earnings-label {
            font-size: 0.9rem;
            color: #6c757d;
        }
        
        /* Pagination */
        .pagination .page-item.active .page-link {
            background: var(--primary-purple);
            border-color: var(--primary-purple);
        }
        
        .pagination .page-link {
            color: var(--primary-purple);
        }
        
        /* Ø¥Ø¶Ø§ÙØ§Øª CSS Ù„Ù„Ø£Ø±Ø¨Ø§Ø­ */
.earnings-region-card {
    background: white;
    border-radius: 12px;
    padding: 15px;
    margin-bottom: 15px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    border: 1px solid #eaeaea;
}

.earnings-breakdown {
    background: #f8f9fa;
    border-radius: 12px;
    padding: 20px;
    margin-top: 20px;
}

.earnings-card {
    transition: transform 0.2s;
}

.earnings-card:hover {
    transform: translateY(-3px);
}

.earnings-value {
    font-size: 1.5rem !important;
    font-weight: 700 !important;
    color: var(--accent-teal) !important;
    margin: 10px 0 !important;
}

.progress {
    border-radius: 10px;
    overflow: hidden;
}

.progress-bar {
    border-radius: 10px;
    transition: width 0.6s ease;
}   

@media (max-width: 768px) {
    .content-thumbnail {
        height: 250px !important;
    }
    .content-title {
        font-size: 1.5rem !important;
    }
}
    </style>
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-4B73N1T483"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-4B73N1T483');
    </script>
</head>
<body>
    <!-- Notification System -->
    <div class="notification success" id="successNotification">
        <div>ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ù†Ø¬Ø§Ø­!</div>
        <div class="progress-bar"><div class="progress"></div></div>
    </div>
    
    <div class="notification error" id="errorNotification">
        <div>Ø§Ù„Ø±Ø¬Ø§Ø¡ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</div>
        <div class="progress-bar"><div class="progress"></div></div>
    </div>
    
    <div class="notification info" id="welcomeNotification">
        <div>Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ø¹ÙˆØ¯ØªÙƒØŒ <span id="userName"></span>!</div>
        <div class="progress-bar"><div class="progress"></div></div>
    </div>

    <!-- reCAPTCHA Badge -->
    <div class="grecaptcha-badge" data-style="bottomright"></div>

    <!-- Custom Shapes -->
    <div class="custom-shape shape-1"></div>
    <div class="custom-shape shape-2"></div>

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand logo" href="#">
                <div class="logo-icon">
                    <i class="fas fa-link"></i>
                </div>
                Turk<span>ify</span> Pro
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent" 
                    aria-controls="navbarContent" aria-expanded="false" aria-label="ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ØªÙ†Ù‚Ù„">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">                
    <!-- Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <li class="nav-item">
        <a class="nav-link nav-link-modern" href="#home" id="homeLink" aria-label="Home">
            <i class="fas fa-home nav-icon">
            </i>
            <span class="nav-text">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
        </a>
    </li>
    
    <!-- Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ† -->
    <li class="nav-item user-only" style="display: none;">
        <a class="nav-link nav-link-modern" href="#dashboard" id="dashboardLink" aria-label="Dashboard">
            <i class="fas fa-tachometer-alt nav-icon"></i>
            <span class="nav-text">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</span>
            <span class="nav-badge" id="userLinksBadge">0</span>
        </a>
    </li>
    
    <!-- Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª - Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ† -->
    <li class="nav-item user-only" style="display: none;">
        <a class="nav-link nav-link-modern" href="#analytics" id="analyticsNavLink" aria-label="Analytics">
            <i class="fas fa-chart-line nav-icon"></i>
            <span class="nav-text">Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª</span>
            <span class="nav-indicator analytics-indicator" id="analyticsIndicator"></span>
        </a>
    </li>
    
    <!-- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±ÙˆØ§Ø¨Ø· - Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ† -->
    <li class="nav-item user-only" style="display: none;">
        <a class="nav-link nav-link-modern" href="#admin" id="adminNavLink" aria-label="Link Management">
            <i class="fas fa-link nav-icon"></i>
            <span class="nav-text">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±ÙˆØ§Ø¨Ø·</span>
            <span class="nav-badge" id="newClicksBadge" style="display: none;">Ø¬Ø¯ÙŠØ¯</span>
        </a>
    </li>
    
    <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© - Ù„Ù„Ù…Ø´Ø±ÙÙŠÙ† ÙÙ‚Ø· -->
    <li class="nav-item admin-only" style="display: none;">
        <a class="nav-link nav-link-modern admin-link" href="#super-admin" id="superAdminLink" aria-label="Super Admin">
            <i class="fas fa-cog nav-icon"></i>
            <span class="nav-text">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†Ø¸Ø§Ù…</span>
            <span class="admin-crown">ğŸ‘‘</span>
        </a>
    </li>
                   
                    <li class="nav-item">
                        <a class="nav-link" href="#features" id="featuresLink" aria-label="Features">
                            <i class="fas fa-star me-1"></i> Ø§Ù„Ù…ÙŠØ²Ø§Øª
                        </a>
                    </li>
                </ul>
                
               <div class="d-flex align-items-center auth-section">
    <!-- Ø£Ø²Ø±Ø§Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
    <div id="authButtons">
        <button class="btn sign-in-btn-modern" id="signInButton" aria-label="Sign in with Google">
            <i class="fab fa-google me-2"></i>
            <span>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</span>
        </button>
    </div>
    
    <!-- Ù…Ù„Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… -->
    <div id="userProfile" class="user-profile-modern" style="display: none;">
        <div class="status-indicator status-online">
            <img src="" alt="User" id="userPhoto" class="user-avatar" aria-label="User photo">
        </div>
        <div class="user-info">
            <div class="user-name" id="userDisplayName">Ù…Ø³ØªØ®Ø¯Ù…</div>
            <div class="user-role" id="userRole">Ø¹Ø¶Ùˆ</div>
        </div>
        
        <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© -->
        <div class="dropdown">
            <button class="btn btn-sm btn-outline-light dropdown-toggle" type="button" 
                    data-bs-toggle="dropdown" aria-expanded="false">
                <i class="fas fa-ellipsis-v"></i>
            </button>
            <ul class="dropdown-menu dropdown-menu-end">
                <li>
                    <a class="dropdown-item" href="#profile" id="profileLink">
                        <i class="fas fa-user me-2"></i>Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
                    </a>
                </li>
                <li>
                    <a class="dropdown-item" href="#settings" id="settingsLink">
                        <i class="fas fa-cog me-2"></i>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
                    </a>
                </li>
                <li><hr class="dropdown-divider"></li>
                <li>
                    <button class="dropdown-item" id="signOutButton">
                        <i class="fas fa-sign-out-alt me-2"></i>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
                    </button>
                </li>
            </ul>
        </div>
    </div>
</div>
         </div>
      </div>
    </nav>
            

    <!-- Hero Section -->
    <section class="hero-section" id="home">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6">
                    <h1 class="display-4 fw-bold mb-4">Ù…Ù†ØµØ© Ù…ØªÙ‚Ø¯Ù…Ø© Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±ÙˆØ§Ø¨Ø·</h1>
                    <p class="lead mb-5">Ø£Ù†Ø´Ø¦ØŒ ØªØªØ¨Ø¹ØŒ ÙˆØ·ÙˆØ± Ø±ÙˆØ§Ø¨Ø·Ùƒ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… ØªØ­Ù„ÙŠÙ„Ø§Øª Ù‚ÙˆÙŠØ© ÙˆÙ…ÙŠØ²Ø§Øª Ù…ØªØ·ÙˆØ±Ø©</p>
                    <div class="d-flex flex-wrap gap-3 hero-buttons">
                        <a href="#admin" class="btn btn-light btn-lg px-4 py-3 rounded-pill fw-bold" role="button" aria-label="Get started">
                            <i class="fas fa-rocket me-2"></i>Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†
                        </a>
                    </div>
                </div>
                <div class="col-lg-6 text-center d-none d-lg-block">
                    <div class="position-relative">
                        <div class="card p-4 mx-auto" style="max-width: 400px; transform: rotate(3deg);">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-center mb-4">
                                    <h3 class="mb-0">ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ø±ÙˆØ§Ø¨Ø·</h3>
                                    <span class="clicks-badge">+24%</span>
                                </div>
                                <div class="mb-4" style="height: 200px; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.1); border-radius: 8px;">
                                    <i class="fas fa-chart-line fa-3x"></i>
                                </div>
                                <div class="d-flex justify-content-around">
                                    <div>
                                        <div class="fw-bold">1.2K</div>
                                        <small>Ù†Ù‚Ø±Ø§Øª</small>
                                    </div>
                                    <div>
                                        <div class="fw-bold">78%</div>
                                        <small>ØªÙØ§Ø¹Ù„</small>
                                    </div>
                                    <div>
                                        <div class="fw-bold">42</div>
                                        <small>Ø±ÙˆØ§Ø¨Ø·</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="platform-stats mt-5">
                <div class="row">
                    <div class="col-md-3 col-6">
                        <div class="platform-stat">
                            <h3 id="totalLinksStat">25K+</h3>
                            <p>Ø±ÙˆØ§Ø¨Ø· ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡Ø§</p>
                        </div>
                    </div>
                    <div class="col-md-3 col-6">
                        <div class="platform-stat">
                            <h3 id="totalClicksStat">1.2M+</h3>
                            <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‚Ø±Ø§Øª</p>
                        </div>
                    </div>
                    <div class="col-md-3 col-6">
                        <div class="platform-stat">
                            <h3 id="uptimeStat">99.9%</h3>
                            <p>ÙˆÙ‚Øª Ø§Ù„ØªØ´ØºÙŠÙ„</p>
                        </div>
                    </div>
                    <div class="col-md-3 col-6">
                        <div class="platform-stat">
                            <h3 id="todayClicksStat">1,245</h3>
                            <p>Ù†Ù‚Ø±Ø§Øª Ø§Ù„ÙŠÙˆÙ…</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <div class="container my-5 pt-5">
        <!-- Admin Panel -->
        <section id="admin">
            <div id="adminPanel" class="admin-only">
                <div class="row">
                    <div class="col-lg-8 mx-auto">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-plus-circle me-2"></i>Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø· Ù‚ØµÙŠØ± Ø¬Ø¯ÙŠØ¯
                            </div>
                            <div class="card-body">
                                <div class="mb-4">
                                    <label class="form-label fw-bold">Ø§Ø³Ù… Ø§Ù„Ø³Ù„Ø³Ù„Ø© *</label>
                                    <input type="text" class="form-control" id="seriesName" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø³Ù„Ø³Ù„Ø©" aria-label="Series name">
                                    <div class="invalid-feedback" id="nameError">Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø³Ù„Ø³Ù„Ø© ØµØ§Ù„Ø­ (Ø£Ø­Ø±ÙØŒ Ø£Ø±Ù‚Ø§Ù…ØŒ ÙˆÙ…Ø³Ø§ÙØ§Øª ÙÙ‚Ø·)</div>
                                </div>
                                
                                <div class="mb-4">
                                    <label class="form-label fw-bold">Ù†ÙˆØ¹ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ *</label>
                                    <select class="form-select" id="linkType" aria-label="Link type">
                                        <option value="series">Ù…Ø³Ù„Ø³Ù„</option>
                                        <option value="movie">ÙÙŠÙ„Ù…</option>
                                        <option value="match">Ù…Ø¨Ø§Ø±Ø§Ø©</option>
                                        <option value="recipe">ÙˆØµÙØ©</option>
                                        <option value="game">Ù„Ø¹Ø¨Ø©</option>
                                        <option value="app">ØªØ·Ø¨ÙŠÙ‚</option>
                                        <option value="channel">Ù‚Ù†Ø§Ø©</option>
                                        <option value="reels">Ø±ÙŠÙ„Ø²</option>
                                    </select>
                                </div>
                                
                                <!-- Ø­Ù‚Ù„ Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ù„Ù‚Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯ -->
                                <div class="mb-4" id="episodeCountWrapper" style="display: none;">
                                    <label class="form-label fw-bold">Ø¹Ø¯Ø¯ Ø­Ù„Ù‚Ø§Øª Ø§Ù„Ù…Ø³Ù„Ø³Ù„ *</label>
                                    <input type="number" class="form-control" id="totalEpisodes" placeholder="Ù…Ø«Ù„Ø§Ù‹ 10">
                                    <div class="invalid-feedback" id="episodeError">Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ø¯Ø¯ Ø­Ù„Ù‚Ø§Øª ØµØ­ÙŠØ­</div>
                                </div>
                                
                                <!-- Ø­Ù‚Ù„ Ø±Ù‚Ù… Ø§Ù„Ø­Ù„Ù‚Ø© Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠØ© -->
                                <div class="mb-4" id="startingEpisodeWrapper" style="display: none;">
                                    <label class="form-label fw-bold">Ø±Ù‚Ù… Ø§Ù„Ø­Ù„Ù‚Ø© Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠØ© *</label>
                                    <input type="number" class="form-control" id="startingEpisode" placeholder="Ù…Ø«Ù„Ø§Ù‹ 1" min="1" value="1">
                                    <div class="form-text">Ø±Ù‚Ù… Ø§Ù„Ø­Ù„Ù‚Ø© Ø§Ù„ØªÙŠ Ø³ÙŠØ¨Ø¯Ø£ Ù…Ù†Ù‡Ø§ Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø§Ù„ÙŠÙˆÙ…ÙŠ</div>
                                </div>
                                
                                <div class="mb-4">
                                    <label class="form-label fw-bold">Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø£ØµÙ„ÙŠ *</label>
                                    <input type="url" class="form-control" id="originalUrl" placeholder="https://example.com" aria-label="Original URL">
                                    <div class="invalid-feedback" id="urlError">Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø§Ø¨Ø· ØµØ§Ù„Ø­</div>
                                </div>
                                
                                <div class="mb-4">
                                    <label class="form-label fw-bold">Ù†Ø·Ø§Ù‚ Ù…Ø®ØµØµ (Ù…Ù…ÙŠØ²)</label>
                                    <input type="text" class="form-control" id="customDomain" placeholder="yourdomain.com" value="turkify.com" aria-label="Custom domain">
                                </div>
                                
                                <div class="mb-4">
                                    <label class="form-label fw-bold">Ø¹Ù†ÙˆØ§Ù† Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø³ÙˆØ´ÙŠØ§Ù„ Ù…ÙŠØ¯ÙŠØ§</label>
                                    <input type="text" class="form-control" id="socialTitle" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø¬Ø°Ø§Ø¨ Ù„Ù„Ù…Ø­ØªÙˆÙ‰" aria-label="Social media title">
                                </div>
                                
                                <div class="mb-4">
                                    <label class="form-label fw-bold">ÙˆØµÙ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø³ÙˆØ´ÙŠØ§Ù„ Ù…ÙŠØ¯ÙŠØ§</label>
                                    <textarea class="form-control" id="socialDescription" rows="3" placeholder="ÙˆØµÙ Ø¬Ø°Ø§Ø¨ Ù„Ù„Ù…Ø­ØªÙˆÙ‰ ÙŠØ¬Ø°Ø¨ Ø§Ù„Ø²ÙˆØ§Ø±" aria-label="Social media description"></textarea>
                                </div>
                                
                                <div class="mb-4">
                                    <label class="form-label fw-bold">ØµÙˆØ±Ø© Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø³ÙˆØ´ÙŠØ§Ù„ Ù…ÙŠØ¯ÙŠØ§ (URL)</label>
                                    <input type="url" class="form-control" id="socialImage" placeholder="https://example.com/image.jpg" aria-label="Social media image">
                                    <div class="form-text">Ø§Ø³ØªØ®Ø¯Ù… ØµÙˆØ±Ø© Ø¬Ø°Ø§Ø¨Ø© Ù„Ø¬Ø°Ø¨ Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ù†Ù‚Ø±Ø§Øª</div>
                                </div>
                                
                                <div class="d-grid">
                                    <button id="generateBtn" class="btn btn-primary btn-lg py-3 fw-bold" aria-label="Generate link">
                                        <i class="fas fa-bolt me-2"></i>Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø§Ø¨Ø·
                                    </button>
                                    <button id="updateBtn" class="btn btn-success btn-lg py-3 fw-bold mt-2" style="display: none;" aria-label="Update link">
                                        <i class="fas fa-save me-2"></i>Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª
                                    </button>
                                </div>
                                
                                <div class="mt-4">
                                    <h5>Ù…Ø¹Ø§ÙŠÙ†Ø© Ù…Ù†Ø´ÙˆØ± Ø§Ù„Ø³ÙˆØ´ÙŠØ§Ù„ Ù…ÙŠØ¯ÙŠØ§</h5>
                                    <div class="social-preview">
                                        <img src="https://via.placeholder.com/500x300/4A154B/FFFFFF?text=ØµÙˆØ±Ø©+Ø§Ù„Ù…Ø­ØªÙˆÙ‰" id="previewImage" class="social-preview-img" alt="Preview">
                                        <h5 id="previewTitle">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø­ØªÙˆÙ‰</h5>
                                        <p id="previewDescription">ÙˆØµÙ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø°ÙŠ Ø³ÙŠØ¸Ù‡Ø± Ø¹Ù„Ù‰ Ù…Ù†ØµØ§Øª Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ</p>
                                        <small id="previewDomain">turkify.com</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Link Management -->
                <div class="row mt-5">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <div>
                                    <i class="fas fa-list me-2"></i>Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù…Ø¯Ø§Ø±Ø©
                                </div>
                                <div class="d-flex">
                                    <div class="input-group me-2" style="max-width: 300px;">
                                        <input type="text" class="form-control" placeholder="Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·..." id="searchLinks" aria-label="Search links">
                                        <button class="btn btn-primary" id="searchButton" aria-label="Search">
                                            <i class="fas fa-search"></i>
                                        </button>
                                    </div>
                                    <select class="form-select" id="sortLinks" style="max-width: 150px;" aria-label="Sort links">
                                        <option value="newest">Ø§Ù„Ø£Ø­Ø¯Ø« Ø£ÙˆÙ„Ø§Ù‹</option>
                                        <option value="clicks">Ø§Ù„Ø£ÙƒØ«Ø± Ù†Ù‚Ø±Ø§Øª</option>
                                        <option value="name">Ø­Ø³Ø¨ Ø§Ù„Ø§Ø³Ù…</option>
                                    </select>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover" aria-label="Managed links">
                                        <thead>
                                            <tr>
                                                <th scope="col">Ø§Ù„Ù…Ø¹Ø±Ù</th>
                                                <th scope="col">Ø§Ø³Ù… Ø§Ù„Ø³Ù„Ø³Ù„Ø©</th>
                                                <th scope="col">Ø§Ù„Ù†ÙˆØ¹</th>
                                                <th scope="col">Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù‚ØµÙŠØ±</th>
                                                <th scope="col">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡</th>
                                                <th scope="col">Ø§Ù„Ù†Ù‚Ø±Ø§Øª</th>
                                                <th scope="col">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                                            </tr>
                                        </thead>
                                        <tbody id="linksTable">
                                            <tr>
                                                <td colspan="7" class="text-center table-loader">
                                                    <div class="spinner-border text-primary" role="status">
                                                        <span class="visually-hidden">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</span>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                
                                <nav class="mt-4" aria-label="Links pagination">
                                    <ul class="pagination justify-content-center">
                                        <li class="page-item disabled">
                                            <a class="page-link" href="#" tabindex="-1">Ø§Ù„Ø³Ø§Ø¨Ù‚</a>
                                        </li>
                                        <li class="page-item active"><a class="page-link" href="#">1</a></li>
                                        <li class="page-item"><a class="page-link" href="#">2</a></li>
                                        <li class="page-item"><a class="page-link" href="#">3</a></li>
                                        <li class="page-item">
                                            <a class="page-link" href="#">Ø§Ù„ØªØ§Ù„ÙŠ</a>
                                        </li>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Analytics Dashboard -->
        <section id="analytics">
            <div id="analyticsPanel" style="display: none;">
                <div class="row">
                    <div class="col-12 mb-4">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-chart-line me-2"></i>Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·
                            </div>
                            <div class="card-body">
                                <div class="analytics-filter">
                                    <h6>ØªØµÙÙŠØ© Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª:</h6>
                                    <div class="filter-group">
                                        <button class="filter-btn active">Ø§Ù„ÙƒÙ„</button>
                                        <button class="filter-btn">Ø§Ù„ÙŠÙˆÙ…</button>
                                        <button class="filter-btn">Ø£Ø³Ø¨ÙˆØ¹</button>
                                        <button class="filter-btn">Ø´Ù‡Ø±</button>
                                        <button class="filter-btn">3 Ø£Ø´Ù‡Ø±</button>
                                        <button class="filter-btn">6 Ø£Ø´Ù‡Ø±</button>
                                        <button class="filter-btn">Ø³Ù†Ø©</button>
                                    </div>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-3 col-6 mb-4">
                                        <div class="stat-card">
                                            <div class="stat-number" id="totalLinks">24</div>
                                            <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·</div>
                                        </div>
                                    </div>
                                    <div class="col-md-3 col-6 mb-4">
                                        <div class="stat-card">
                                            <div class="stat-number" id="totalClicks">1,842</div>
                                            <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‚Ø±Ø§Øª</div>
                                        </div>
                                    </div>
                                    <div class="col-md-3 col-6 mb-4">
                                        <div class="stat-card">
                                            <div class="stat-number" id="todayClicks">56</div>
                                            <div class="stat-label">Ù†Ù‚Ø±Ø§Øª Ø§Ù„ÙŠÙˆÙ…</div>
                                        </div>
                                    </div>
                                    <div class="col-md-3 col-6 mb-4">
                                        <div class="stat-card">
                                            <div class="stat-number" id="popularLink">78%</div>
                                            <div class="stat-label">Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªÙØ§Ø¹Ù„</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="mt-5">
                                    <h5 class="mb-4">Ø§Ù„Ù†Ù‚Ø±Ø§Øª Ù…Ø¹ Ù…Ø±ÙˆØ± Ø§Ù„ÙˆÙ‚Øª</h5>
                                    <div id="clicksChartPlaceholder" style="height: 300px; display: flex; align-items: center; justify-content: center; background: #f8f9fa; border-radius: 12px;">
                                        <i class="fas fa-chart-bar fa-3x text-muted"></i>
                                    </div>
                                </div>
                                
                                <div class="row mt-5">
                                    <div class="col-md-6 mb-4">
                                        <h5 class="mb-4">Ø£ÙØ¶Ù„ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø£Ø¯Ø§Ø¡Ù‹</h5>
                                        <div class="list-group">
                                            <a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center" aria-label="Summer Sale link">
                                                <div>
                                                    <div class="fw-bold">ØªØ®ÙÙŠØ¶Ø§Øª Ø§Ù„ØµÙŠÙ</div>
                                                    <small class="text-muted">https://turkify.com/s/389472</small>
                                                </div>
                                                <span class="clicks-badge">142 Ù†Ù‚Ø±Ø§Øª</span>
                                            </a>
                                            <a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center" aria-label="Special Offer link">
                                                <div>
                                                    <div class="fw-bold">Ø¹Ø±Ø¶ Ø®Ø§Øµ</div>
                                                    <small class="text-muted">https://turkify.com/s/734516</small>
                                                </div>
                                                <span class="clicks-badge">128 Ù†Ù‚Ø±Ø§Øª</span>
                                            </a>
                                            <a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center" aria-label="New Products link">
                                                <div>
                                                    <div class="fw-bold">Ù…Ù†ØªØ¬Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©</div>
                                                    <small class="text-muted">https://turkify.com/s/562891</small>
                                                </div>
                                                <span class="clicks-badge">89 Ù†Ù‚Ø±Ø§Øª</span>
                                            </a>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-4">
                                        <h5 class="mb-4">Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ</h5>
                                        <div class="stats-card">
                                            <div class="d-flex align-items-center mb-3">
                                                <img src="https://flagcdn.com/sa.svg" loading="lazy" class="country-flag" alt="Saudi Arabia flag">
                                                <div class="fw-bold">Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©</div>
                                                <div class="ms-auto">42%</div>
                                            </div>
                                            <div class="d-flex align-items-center mb-3">
                                                <img src="https://flagcdn.com/ae.svg" loading="lazy" class="country-flag" alt="United Arab Emirates flag">
                                                <div class="fw-bold">Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª</div>
                                                <div class="ms-auto">18%</div>
                                            </div>
                                            <div class="d-flex align-items-center mb-3">
                                                <img src="https://flagcdn.com/eg.svg" loading="lazy" class="country-flag" alt="Egypt flag">
                                                <div class="fw-bold">Ù…ØµØ±</div>
                                                <div class="ms-auto">12%</div>
                                            </div>
                                            <div class="d-flex align-items-center">
                                                <img src="https://flagcdn.com/qa.svg" loading="lazy" class="country-flag" alt="Qatar flag">
                                                <div class="fw-bold">Ù‚Ø·Ø±</div>
                                                <div class="ms-auto">8%</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="row mt-4">
                                    <div class="col-md-6 mb-4">
                                        <h5 class="mb-4">Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©</h5>
                                        <div class="stats-card">
                                            <div class="d-flex align-items-center mb-3">
                                                <div class="device-badge device-mobile"><i class="fas fa-mobile-alt me-2"></i>Ø¬ÙˆØ§Ù„</div>
                                                <div class="ms-auto">58%</div>
                                            </div>
                                            <div class="d-flex align-items-center mb-3">
                                                <div class="device-badge device-desktop"><i class="fas fa-desktop me-2"></i>ÙƒÙ…Ø¨ÙŠÙˆØªØ±</div>
                                                <div class="ms-auto">32%</div>
                                            </div>
                                            <div class="d-flex align-items-center">
                                                <div class="device-badge device-tablet"><i class="fas fa-tablet-alt me-2"></i>ØªØ§Ø¨Ù„Øª</div>
                                                <div class="ms-auto">10%</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-4">
                                        <h5 class="mb-4">Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª</h5>
                                        <div class="stats-card">
                                            <div class="d-flex align-items-center mb-3">
                                                <i class="fab fa-facebook me-3" style="color: #3b5998;"></i>
                                                <div class="fw-bold">ÙÙŠØ³Ø¨ÙˆÙƒ</div>
                                                <div class="ms-auto">38%</div>
                                            </div>
                                            <div class="d-flex align-items-center mb-3">
                                                <i class="fab fa-twitter me-3" style="color: #1da1f2;"></i>
                                                <div class="fw-bold">ØªÙˆÙŠØªØ±</div>
                                                <div class="ms-auto">22%</div>
                                            </div>
                                            <div class="d-flex align-items-center mb-3">
                                                <i class="fab fa-instagram me-3" style="color: #e1306c;"></i>
                                                <div class="fw-bold">Ø¥Ù†Ø³ØªØºØ±Ø§Ù…</div>
                                                <div class="ms-auto">18%</div>
                                            </div>
                                            <div class="d-flex align-items-center">
                                                <i class="fas fa-envelope me-3" style="color: #ea4335;"></i>
                                                <div class="fw-bold">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</div>
                                                <div class="ms-auto">12%</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Features Section -->
        <section id="features">
            <div id="featuresPanel">
                <div class="row mb-5">
                    <div class="col-12 text-center">
                        <h2 class="display-5 fw-bold mb-3">Ù…ÙŠØ²Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©</h2>
                        <p class="lead mb-5">ÙƒÙ„ Ù…Ø§ ØªØ­ØªØ§Ø¬Ù‡ Ù„Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ¥Ø¯Ø§Ø±Ø© ÙˆØªØªØ¨Ø¹ Ø±ÙˆØ§Ø¨Ø·Ùƒ</p>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-4 mb-4">
                        <div class="card h-100">
                            <div class="card-body text-center p-4">
                                <div class="feature-icon">
                                    <i class="fas fa-link"></i>
                                </div>
                                <h4 class="mb-3">ØªÙ†Ø³ÙŠÙ‚ Ø±Ø§Ø¨Ø· Ù…Ø®ØµØµ</h4>
                                <p>Ø£Ù†Ø´Ø¦ Ø±ÙˆØ§Ø¨Ø· Ø¨Ø§Ù„ØªÙ†Ø³ÙŠÙ‚: https://series-name.com/Ã©pisode-today-XXXXXX</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-4">
                        <div class="card h-100">
                            <div class="card-body text-center p-4">
                                <div class="feature-icon">
                                    <i class="fas fa-chart-line"></i>
                                </div>
                                <h4 class="mb-3">ØªØ­Ù„ÙŠÙ„Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©</h4>
                                <p>ØªØªØ¨Ø¹ Ø§Ù„Ù†Ù‚Ø±Ø§Øª ÙˆØ§Ù„Ù…ÙˆØ§Ù‚Ø¹ ÙˆØ§Ù„Ø£Ø¬Ù‡Ø²Ø© ÙˆÙ…Ù‚Ø§ÙŠÙŠØ³ Ø§Ù„ØªÙØ§Ø¹Ù„ ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„ÙØ¹Ù„ÙŠ.</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-4">
                        <div class="card h-100">
                            <div class="card-body text-center p-4">
                                <div class="feature-icon">
                                    <i class="fas fa-database"></i>
                                </div>
                                <h4 class="mb-3">ØªØ®Ø²ÙŠÙ† Ø³Ø­Ø§Ø¨ÙŠ</h4>
                                <p>Ø§Ø³ØªØ®Ø¯Ù… Firebase Firestore Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø¨Ø³Ù‡ÙˆÙ„Ø©.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-4 mb-4">
                        <div class="card h-100">
                            <div class="card-body text-center p-4">
                                <div class="feature-icon">
                                    <i class="fas fa-redo"></i>
                                </div>
                                <h4 class="mb-3">Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡ ÙÙˆØ±ÙŠØ©</h4>
                                <p>Ø£Ø¹Ø¯ ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙÙˆØ±Ù‹Ø§ Ù…Ø¹ Ø§Ù„Ù‚Ø¯Ø±Ø© Ø¹Ù„Ù‰ ØªØªØ¨Ø¹ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª.</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-4">
                        <div class="card h-100">
                            <div class="card-body text-center p-4">
                                <div class="feature-icon">
                                    <i class="fas fa-shield-alt"></i>
                                </div>
                                <h4 class="mb-3">Ø­Ù…Ø§ÙŠØ© Ù…ØªÙ‚Ø¯Ù…Ø©</h4>
                                <p>Ø§Ø³ØªØ®Ø¯Ù… reCAPTCHA v3 Ù„Ù…Ù†Ø¹ Ø§Ù„Ø¥Ø³Ø§Ø¡Ø© ÙˆØ­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ù†ØµØ©.</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-4">
                        <div class="card h-100">
                            <div class="card-body text-center p-4">
                                <div class="feature-icon">
                                    <i class="fas fa-mobile-alt"></i>
                                </div>
                                <h4 class="mb-3">ØªØµÙ…ÙŠÙ… Ù…ØªØ¬Ø§ÙˆØ¨</h4>
                                <p>ÙˆØ§Ø¬Ù‡Ø© Ù…Ø³ØªØ®Ø¯Ù… ØªØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ Ù…Ø«Ø§Ù„ÙŠ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© ÙˆØ§Ù„Ù…Ù‚Ø§Ø³Ø§Øª.</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row mt-5">
                    <div class="col-12 text-center">
                        <h2 class="display-5 fw-bold mb-3">Ù…ÙŠØ²Ø§Øª Ù…Ù…ÙŠØ²Ø© - Ù…Ø¬Ø§Ù†Ø§Ù‹ Ù„Ùƒ!</h2>
                        <p class="lead mb-5">Ù…ÙŠØ²Ø§Øª Ø§Ø­ØªØ±Ø§ÙÙŠØ© Ù…Ø¯ÙÙˆØ¹Ø© ÙÙŠ Ù…Ù†ØµØ§Øª Ø£Ø®Ø±Ù‰ØŒ Ù…ØªØ§Ø­Ø© Ù…Ø¬Ø§Ù†Ù‹Ø§ Ø¹Ù„Ù‰ Turkify</p>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-4 mb-4">
                        <div class="card h-100 border-2 border-primary">
                            <div class="card-body text-center p-4">
                                <div class="feature-icon">
                                    <i class="fas fa-globe"></i>
                                </div>
                                <h4 class="mb-3">Ù†Ø·Ø§Ù‚Ø§Øª Ù…Ø®ØµØµØ©</h4>
                                <p>Ø§Ø³ØªØ®Ø¯Ù… Ù†Ø·Ø§Ù‚Ùƒ Ø§Ù„Ø®Ø§Øµ Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø±ÙˆØ§Ø¨Ø· Ù‚ØµÙŠØ±Ø© Ù…Ù…ÙŠØ²Ø©.</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-4">
                        <div class="card h-100 border-2 border-primary">
                            <div class="card-body text-center p-4">
                                <div class="feature-icon">
                                    <i class="fas fa-lock"></i>
                                </div>
                                <h4 class="mb-3">Ø­Ù…Ø§ÙŠØ© Ø¨ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ±</h4>
                                <p>Ø£Ø¶Ù Ø·Ø¨Ù‚Ø© Ø¥Ø¶Ø§ÙÙŠØ© Ù…Ù† Ø§Ù„Ø£Ù…Ø§Ù† Ù„Ø±ÙˆØ§Ø¨Ø·Ùƒ Ø§Ù„Ø­Ø³Ø§Ø³Ø©.</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-4">
                        <div class="card h-100 border-2 border-primary">
                            <div class="card-body text-center p-4">
                                <div class="feature-icon">
                                    <i class="fas fa-hourglass-half"></i>
                                </div>
                                <h4 class="mb-3">Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·</h4>
                                <p>Ø­Ø¯Ø¯ ØªÙˆØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ù„Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù…Ø¤Ù‚ØªØ©.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Redirect Panel -->
        <div id="redirectPanel" class="redirect-container" style="display: none;">
            <div class="ad-container">
                <h6>Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ù…Ù† Ø´Ø±ÙƒØ§Ø¦Ù†Ø§</h6>
                <div class="ad-placeholder ad-350x50">
                    AdSterra Ad (350Ã—50)
                </div>
            </div>
            
            
            <!-- Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø­Ø¯Ø«Ø© -->
<div class="content-card" id="contentCard" style="display: block;">
    <!-- Ø¥Ø¹Ù„Ø§Ù† Ø¹Ù„ÙˆÙŠ -->
    <div class="ad-container" style="margin: 20px 0;">
        <div class="ad-placeholder ad-350x50">
            AdSterra Ad (350Ã—50)
        </div>
    </div>
    
    <!-- ØµÙˆØ±Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ -->
    <div class="content-image-container">
        <img id="contentThumbnail" 
             src="https://via.placeholder.com/800x300/4A154B/FFFFFF?text=Ø¬Ø§Ø±ÙŠ+Ø§Ù„ØªØ­Ù…ÙŠÙ„..." 
             class="content-thumbnail" 
             alt="ØµÙˆØ±Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰" 
             style="display: block; visibility: visible;"
             onerror="this.src='https://via.placeholder.com/800x300/4A154B/FFFFFF?text=Ù„Ø§+ØªÙˆØ¬Ø¯+ØµÙˆØ±Ø©';">
    </div>
    
    <!-- Ø¥Ø¹Ù„Ø§Ù† ÙˆØ³Ø·ÙŠ -->
    <div class="ad-container" style="margin: 20px 0;">
        <div class="ad-placeholder ad-350x250">
            AdSterra Ad (350Ã—250)
        </div>
    </div>
    
    <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø­ØªÙˆÙ‰ -->
    <div class="content-info" style="display: block; visibility: visible;">
        <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø£Ø³Ø§Ø³ÙŠØ© -->
        <div class="content-meta" style="display: flex; visibility: visible;">
            <span id="contentType" class="content-type" style="display: inline-block;">Ù…Ø³Ù„Ø³Ù„</span>
            <span id="contentEpisode" class="content-episode" style="display: none;">Ø§Ù„Ø­Ù„Ù‚Ø© 1</span>
            <span id="contentDate" class="content-date" style="display: none;">Ø§Ù„ÙŠÙˆÙ…</span>
        </div>
        
        <!-- Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø­ØªÙˆÙ‰ -->
        <h2 id="contentTitle" class="content-title" style="display: block; visibility: visible;">
            Ø§Ø³Ù… Ø§Ù„Ù…Ø³Ù„Ø³Ù„
        </h2>
        
        <!-- ÙˆØµÙ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ -->
        <p id="contentDescription" class="content-description" style="display: block; visibility: visible;">
            ÙˆØµÙ Ø§Ù„Ù…Ø³Ù„Ø³Ù„ ÙˆØ£Ø­Ø¯Ø§Ø« Ø§Ù„Ø­Ù„Ù‚Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
        </p>
        
        <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© -->
        <div class="content-stats" style="display: flex; gap: 20px; margin-top: 15px;">
            <div class="stat-item">
                <i class="fas fa-eye text-muted"></i>
                <span id="contentViews" class="ms-2">0 Ù…Ø´Ø§Ù‡Ø¯Ø©</span>
            </div>
            <div class="stat-item">
                <i class="fas fa-calendar text-muted"></i>
                <span id="contentCreated" class="ms-2">Ø§Ù„ÙŠÙˆÙ…</span>
            </div>
        </div>
    </div>
</div>
            
            <!-- Update 1: Redirect text based on content type -->
            <div class="redirect-text" id="redirectText">
                <span id="redirectMessage">ÙŠØªÙ… ØªÙˆØ¬ÙŠÙ‡Ùƒ Ø§Ù„Ø¢Ù†</span>
            </div>
            
            <div class="loader" id="redirectLoader"></div>
            <div class="security-text">
                <p><i class="fas fa-shield-alt me-2"></i>Ø§ØªØµØ§Ù„Ùƒ Ø¢Ù…Ù† ÙˆÙ…Ø´ÙÙ‘Ø±</p>
                <p><i class="fas fa-bolt me-2"></i>Ù…Ø¯Ø¹ÙˆÙ… Ù…Ù† Ù…Ù†ØµØ© Turkify Pro Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±ÙˆØ§Ø¨Ø·</p>
            </div>
            <button class="btn btn-primary redirect-btn" id="manualRedirectBtn" style="display: none;" aria-label="Continue to destination">
                <i class="fas fa-arrow-right me-2"></i>Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø¥Ù„Ù‰ Ø§Ù„ÙˆØ¬Ù‡Ø©
            </button>
        </div>
    </div>
    
    <!-- Link Generated Modal -->
    <div class="modal fade" id="linkModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-check-circle me-2"></i>ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ù†Ø¬Ø§Ø­!</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-4">
                        <p class="mb-1">Ø±Ø§Ø¨Ø·Ùƒ Ø§Ù„Ù‚ØµÙŠØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯:</p>
                        <div class="input-group">
                            <input type="text" class="form-control form-control-lg" id="generatedLink" readonly aria-label="Generated link">
                            <button class="btn btn-primary" id="copyLinkBtn" aria-label="Copy link">
                                <i class="fas fa-copy me-1"></i>Ù†Ø³Ø®
                            </button>
                        </div>
                    </div>
                    
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        Ø³ÙŠÙ‚ÙˆÙ… Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰: <span id="originalLinkDisplay" class="fw-bold"></span>
                    </div>
                    
                    <div class="d-flex justify-content-between mt-4">
                        <button class="btn btn-outline-primary" id="viewAnalyticsBtn" aria-label="View analytics">
                            <i class="fas fa-chart-bar me-1"></i>Ø¹Ø±Ø¶ Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª
                        </button>
                        <button class="btn btn-outline-success" id="shareLinkBtn" aria-label="Share link">
                            <i class="fas fa-share-alt me-1"></i>Ù…Ø´Ø§Ø±Ø© Ø§Ù„Ø±Ø§Ø¨Ø·
                        </button>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" aria-label="Close modal">Ø¥ØºÙ„Ø§Ù‚</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Confirmation Modal -->
    <div class="modal fade" id="confirmationModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-exclamation-triangle me-2 text-warning"></i>ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p id="confirmationMessage">Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø±ØºØ¨ØªÙƒ ÙÙŠ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø·ØŸ</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥Ù„ØºØ§Ø¡</button>
                    <button type="button" class="btn btn-danger" id="confirmActionBtn">ØªØ£ÙƒÙŠØ¯</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Stats Modal -->
    <div class="modal fade" id="statsModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-chart-bar me-2"></i>ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ø±Ø§Ø¨Ø·</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="stats-modal-content">
                        <div class="stats-header">
                         <h4 id="statsLinkTitle" class="stats-title">ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ø±Ø§Ø¨Ø·</h4>
    <p class="text-muted">
        Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù‚ØµÙŠØ±: <a id="statsLinkUrl" href="#" target="_blank" class="text-decoration-none">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø±Ø§Ø¨Ø·</a>
    </p>
    
    
    <div class="stats-header">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h4 id="statsLinkTitle" class="stats-title">ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ø±Ø§Ø¨Ø·</h4>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
    </div>
    
    <p class="text-muted mb-3">
        Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù‚ØµÙŠØ±: <a id="statsLinkUrl" href="#" target="_blank" class="text-decoration-none">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø±Ø§Ø¨Ø·</a>
    </p>
    
    <div class="analytics-filter-system">
        <div class="row align-items-center">
            <div class="col-md-6">
                <label for="timeRangeSelect" class="form-label fw-bold">Ø§Ø®ØªØ± Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ©:</label>
                <select id="timeRangeSelect" class="form-select">
                    <option value="today">Ø§Ù„ÙŠÙˆÙ…</option>
                    <option value="week" selected>Ø¢Ø®Ø± Ø£Ø³Ø¨ÙˆØ¹</option>
                    <option value="15days">Ø¢Ø®Ø± 15 ÙŠÙˆÙ…</option>
                    <option value="month">Ø¢Ø®Ø± Ø´Ù‡Ø±</option>
                    <option value="3months">Ø¢Ø®Ø± 3 Ø£Ø´Ù‡Ø±</option>
                    <option value="6months">Ø¢Ø®Ø± 6 Ø£Ø´Ù‡Ø±</option>
                    <option value="year">Ø¢Ø®Ø± Ø³Ù†Ø©</option>
                    <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ÙˆÙ‚Ø§Øª</option>
                </select>
            </div>
            <div class="col-md-6">
                <label class="form-label fw-bold">ØªØ­Ø¯ÙŠØ« Ø³Ø±ÙŠØ¹:</label>
                <div class="btn-group w-100" role="group">
                    <button type="button" class="btn btn-outline-primary time-quick-btn" data-range="today">Ø§Ù„ÙŠÙˆÙ…</button>
                    <button type="button" class="btn btn-outline-primary time-quick-btn active" data-range="week">Ø£Ø³Ø¨ÙˆØ¹</button>
                    <button type="button" class="btn btn-outline-primary time-quick-btn" data-range="month">Ø´Ù‡Ø±</button>
                    <button type="button" class="btn btn-outline-primary time-quick-btn" data-range="all">Ø§Ù„ÙƒÙ„</button>
                </div>
            </div>
        </div>
        
        <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ÙÙ„ØªØ± Ø§Ù„Ù†Ø´Ø· -->
        <div class="filter-info mt-3 p-2 bg-light rounded">
            <small class="text-muted">
                <i class="fas fa-filter me-1"></i>
                Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù€: <span id="activeFilterText" class="fw-bold">Ø¢Ø®Ø± Ø£Ø³Ø¨ÙˆØ¹</span>
                | Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: <span id="lastUpdateTime"></span>
            </small>
        </div>
    </div>
</div>  
</div>
                        
                        <div class="stats-grid">
                            <div class="stats-card">
                                <div class="stats-card-title"><i class="fas fa-users"></i> Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª</div>
                                <div class="stats-number" id="totalVisits">1,842</div>
                            </div>
                            <div class="stats-card">
                                <div class="stats-card-title"><i class="fas fa-mouse-pointer"></i> Ø§Ù„Ù†Ù‚Ø±Ø§Øª Ø§Ù„ÙŠÙˆÙ…</div>
                                <div class="stats-number" id="todayVisits">56</div>
                            </div>
                            <div class="stats-card">
                                <div class="stats-card-title"><i class="fas fa-map-marker-alt"></i> Ø§Ù„Ø¨Ù„Ø¯ Ø§Ù„Ø£ÙƒØ«Ø± Ø²ÙŠØ§Ø±Ø©</div>
                                <div class="stats-number" id="topCountry">Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©</div>
                            </div>
                            <div class="stats-card">
                                <div class="stats-card-title"><i class="fas fa-desktop"></i> Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ø£ÙƒØ«Ø± Ø§Ø³ØªØ®Ø¯Ø§Ù…Ø§Ù‹</div>
                                <div class="stats-number" id="topDevice">Ø§Ù„Ù‡Ø§ØªÙ</div>
                            </div>
                        </div>
                        
                        <div class="row mt-4">
                            <div class="col-md-6">
                                <div class="stats-card">
                                    <div class="stats-card-title"><i class="fas fa-chart-line"></i> Ø§Ù„Ù†Ù‚Ø±Ø§Øª Ù…Ø¹ Ù…Ø±ÙˆØ± Ø§Ù„ÙˆÙ‚Øª</div>
                                    <div class="stats-chart">
                                        <canvas id="visitsChart"></canvas>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="stats-card">
                                    <div class="stats-card-title"><i class="fas fa-globe-asia"></i> Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ</div>
                                    <div class="stats-chart">
                                        <canvas id="geoChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-4">
                            <div class="col-md-6">
                                <div class="stats-card">
                                    <div class="stats-card-title"><i class="fas fa-laptop"></i> Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©</div>
                                    <div class="stats-chart">
                                        <canvas id="devicesChart"></canvas>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="stats-card">
                                    <div class="stats-card-title"><i class="fas fa-share-alt"></i> Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª</div>
                                    <div class="stats-chart">
                                        <canvas id="sourcesChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥ØºÙ„Ø§Ù‚</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Earnings Modal -->
    <div class="modal fade" id="earningsModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-dollar-sign me-2 text-success"></i>Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ø±Ø§Ø¨Ø·</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="stats-modal-content">
                        <div class="stats-header">
                            <h4 id="earningsLinkTitle" class="stats-title">ØªØ®ÙÙŠØ¶Ø§Øª Ø§Ù„ØµÙŠÙ</h4>
                            <div class="time-filter">
                                <button class="time-btn active">Ø§Ù„ÙŠÙˆÙ…</button>
                                <button class="time-btn">Ø£Ø³Ø¨ÙˆØ¹</button>
                                <button class="time-btn">Ø´Ù‡Ø±</button>
                                <button class="time-btn">3 Ø£Ø´Ù‡Ø±</button>
                                <button class="time-btn">Ø³Ù†Ø©</button>
                            </div>
                        </div>
                        
                        <div class="earnings-stats">
    <div class="earnings-card">
        <div id="totalEarnings" class="earnings-value">$0.00</div>
        <div class="earnings-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­</div>
    </div>
    <div class="earnings-card">
        <div id="totalImpressions" class="earnings-value">0</div>
        <div class="earnings-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø§Øª</div>
    </div>
    <div class="earnings-card">
        <div id="averageRPM" class="earnings-value">$0.00</div>
        <div class="earnings-label">Ù…ØªÙˆØ³Ø· Ø§Ù„Ø±Ø¨Ø­ Ù„ÙƒÙ„ 1000 Ù…Ø´Ø§Ù‡Ø¯Ø©</div>
    </div>
    <div class="earnings-card">
        <div id="todayEarnings" class="earnings-value">$0.00</div>
        <div class="earnings-label">Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„ÙŠÙˆÙ…</div>
    </div>
</div>

<div class="earnings-breakdown mt-4">
    <h6 class="mb-3">ØªÙØµÙŠÙ„ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø­Ø³Ø¨ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©:</h6>
    <div class="row">
        <div class="col-md-6">
            <div class="earnings-region-card">
                <div class="d-flex justify-content-between align-items-center">
                    <span><i class="fas fa-flag me-2"></i>Ø§Ù„Ø¨Ù„Ø¯Ø§Ù† Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</span>
                    <div class="text-end">
                        <div id="arabVisits" class="fw-bold">0 Ø²ÙŠØ§Ø±Ø©</div>
                        <small id="arabEarnings" class="text-success">$0.00</small>
                    </div>
                </div>
                <div class="progress mt-2" style="height: 5px;">
                    <div id="arabProgress" class="progress-bar bg-success" style="width: 0%"></div>
                </div>
                <small class="text-muted">Ù…Ø¹Ø¯Ù„: $1.00 Ù„ÙƒÙ„ 1000 Ø²ÙŠØ§Ø±Ø©</small>
            </div>
        </div>
        <div class="col-md-6">
            <div class="earnings-region-card">
                <div class="d-flex justify-content-between align-items-center">
                    <span><i class="fas fa-globe me-2"></i>Ø§Ù„Ø¨Ù„Ø¯Ø§Ù† Ø§Ù„Ø£Ø¬Ù†Ø¨ÙŠØ©</span>
                    <div class="text-end">
                        <div id="foreignVisits" class="fw-bold">0 Ø²ÙŠØ§Ø±Ø©</div>
                        <small id="foreignEarnings" class="text-primary">$0.00</small>
                    </div>
                </div>
                <div class="progress mt-2" style="height: 5px;">
                    <div id="foreignProgress" class="progress-bar bg-primary" style="width: 0%"></div>
                </div>
                <small class="text-muted">Ù…Ø¹Ø¯Ù„: $3.00 Ù„ÙƒÙ„ 1000 Ø²ÙŠØ§Ø±Ø©</small>
            </div>
        </div>
    </div>
</div>
                        
                        <div class="earnings-chart">
                            <canvas id="earningsChart"></canvas>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥ØºÙ„Ø§Ù‚</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Global Loader -->
    <div class="global-loader" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255,255,255,0.7); z-index: 2000; justify-content: center; align-items: center;">
        <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;"></div>
    </div>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script src="https://www.google.com/recaptcha/api.js?render=6LesFYErAAAAAOpY8Pbc0furepnxPt0WyJorH5Qw"></script>
    
    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyC5VmidRUmMF6W3vvl44zznScS1gn2GHn0",
            authDomain: "turkify-redirect.firebaseapp.com",
            projectId: "turkify-redirect",
            storageBucket: "turkify-redirect.appspot.com",
            messagingSenderId: "986441766029",
            appId: "1:986441766029:web:dd6a13879306472e43bec4"
        };
        
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        
        // ÙØ­Øµ Firebase Ù‚Ø¨Ù„ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
function checkFirebaseConnection() {
    if (!firebase || !firebase.firestore) {
        console.error('Firebase ØºÙŠØ± Ù…ØªÙˆÙØ±');
        showNotification('error', 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
        return false;
    }
    return true;
}

// ØªØ­Ø¯ÙŠØ« Ø¯Ø§Ù„Ø© setLoading Ù„ØªÙƒÙˆÙ† Ø£ÙƒØ«Ø± Ø£Ù…Ø§Ù†Ø§Ù‹
function setLoading(show) {
    const loader = document.querySelector('.global-loader');
    if (loader) {
        loader.style.display = show ? 'flex' : 'none';
    }
}
        
        // DOM Elements
        const adminPanel = document.getElementById('adminPanel');
        const analyticsPanel = document.getElementById('analyticsPanel');
        const redirectPanel = document.getElementById('redirectPanel');
        const featuresPanel = document.getElementById('featuresPanel');
        const linksTable = document.getElementById('linksTable');
        const signInButton = document.getElementById('signInButton');
        const signOutButton = document.getElementById('signOutButton');
        const userProfile = document.getElementById('userProfile');
        const userPhoto = document.getElementById('userPhoto');
        const userName = document.getElementById('userName');
        const authButtons = document.getElementById('authButtons');
        const navLinks = document.querySelectorAll('.nav-link');
        const adminOnlyElements = document.querySelectorAll('.admin-only');
        const globalLoader = document.querySelector('.global-loader');
        const generateBtn = document.getElementById('generateBtn');
        const updateBtn = document.getElementById('updateBtn');
        const redirectText = document.getElementById('redirectText');
        const redirectMessage = document.getElementById('redirectMessage');
        const backToHomeBtn = document.getElementById('backToHomeBtn');
        
        // Current editing link ID
        let currentEditingLinkId = null;
        
        // Set loading state
        function setLoading(show) {
            globalLoader.style.display = show ? 'flex' : 'none';
        }
        
        // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª Ø¨Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©
        function formatFirestoreDateTime(timestamp) {
            const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp.seconds * 1000);
            return date.toLocaleString('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }
        
        // Initialize page based on URL
       
         function initPage() {
    const urlParams = new URLSearchParams(window.location.search);
    const linkId = urlParams.get('id');
    const isAdmin = window.location.hash === '#admin';
    const isStats = window.location.hash === '#analytics';
    const isFeatures = window.location.hash === '#features';
    
    // Highlight active navigation item
    highlightActiveNav();
    
    if (linkId) {
        // ØªØ·Ø¨ÙŠÙ‚ Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù‚Ø³Ø±ÙŠ Ù‚Ø¨Ù„ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡
        forceShowElements();
        setTimeout(() => {
            showContentCard();
            handleRedirection(linkId);
        }, 100);
    } else if (isAdmin) {
        showAdminPanel();
    } else if (isStats) {
        showAnalytics();
    } else if (isFeatures) {
        showFeatures();
    } else {
        showFeatures();
    }
}
        
        // Highlight active navigation item
        function highlightActiveNav() {
            navLinks.forEach(link => {
                link.classList.remove('nav-active');
                if (window.location.hash === link.getAttribute('href')) {
                    link.classList.add('nav-active');
                }
            });
        }
        
        // Show admin panel
        function showAdminPanel() {
            hideAllPanels();
            adminPanel.classList.remove('admin-only');
            adminPanel.style.display = 'block';
            loadLinks();
        }
        
        // Show analytics panel
        function showAnalytics() {
            hideAllPanels();
            analyticsPanel.style.display = 'block';
            loadAnalytics();
        }
        
        // Show features panel
        function showFeatures() {
            hideAllPanels();
            featuresPanel.style.display = 'block';
        }
        
        // Hide all panels
        function hideAllPanels() {
            adminPanel.style.display = 'none';
            analyticsPanel.style.display = 'none';
            redirectPanel.style.display = 'none';
            featuresPanel.style.display = 'none';
        }
        
        // Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ø¬Ù„Ø¨ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø²Ø§Ø¦Ø± Ù…Ù† ip-api
        async function getVisitorInfo() {
            try {
                // Get IP from ipify
                const ipRes = await fetch('https://api.ipify.org?format=json');
                const ipData = await ipRes.json();
                const ip = ipData.ip;

                // Get location from ip-api.com
                const response = await fetch(`https://ip-api.com/json/${ip}?fields=status,message,country,countryCode,regionName,city,isp,org,query&lang=ar`);
                const data = await response.json();
                
                if (data.status === 'success') {
                    return {
                        country: data.country || "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ",
                        region: data.regionName || "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ",
                        city: data.city || "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ",
                        ip: ip,
                        org: data.org || "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ"
                    };
                }
                return {
                    country: "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ",
                    region: "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ",
                    city: "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ",
                    ip: "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ",
                    org: "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ"
                };
            } catch (error) {
                console.error("Error getting visitor info:", error);
                return {
                    country: "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ",
                    region: "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ",
                    city: "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ",
                    ip: "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ",
                    org: "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ"
                };
            }
        }

        // Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ø§ÙƒØªØ´Ø§Ù ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¬Ù‡Ø§Ø²
        function detectDeviceType() {
            const ua = navigator.userAgent.toLowerCase();
            if (ua.includes("smart-tv") || ua.includes("hbbtv") || ua.includes("appletv")) return "ØªÙ„ÙØ§Ø² Ø°ÙƒÙŠ";
            if (/mobile|iphone|ipod|android/.test(ua)) return "Ù‡Ø§ØªÙ";
            if (/tablet|ipad/.test(ua)) return "ØªØ§Ø¨Ù„Øª";
            if (/windows|mac|linux/.test(ua)) return "ÙƒÙ…Ø¨ÙŠÙˆØªØ±";
            return "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ";
        }

        function detectOS() {
            const ua = navigator.userAgent;
            if (ua.includes("Android")) return "Android";
            if (ua.includes("iPhone") || ua.includes("iPad")) return "iOS";
            if (ua.includes("Windows")) return "Windows";
            if (ua.includes("Mac OS")) return "macOS";
            return "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ";
        }

        function detectBrowser() {
            const ua = navigator.userAgent;
            if (ua.includes("Chrome")) return "Chrome";
            if (ua.includes("Firefox")) return "Firefox";
            if (ua.includes("Safari") && !ua.includes("Chrome")) return "Safari";
            if (ua.includes("Edge")) return "Edge";
            return "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ";
        }

        function detectReferrer() {
            const ref = document.referrer;
            if (ref.includes("facebook")) return "ÙÙŠØ³Ø¨ÙˆÙƒ";
            if (ref.includes("instagram")) return "Ø¥Ù†Ø³ØªØºØ±Ø§Ù…";
            if (ref.includes("youtube")) return "ÙŠÙˆØªÙŠÙˆØ¨";
            if (ref.includes("twitter")) return "ØªÙˆÙŠØªØ±";
            if (ref.includes("tiktok")) return "ØªÙŠÙƒ ØªÙˆÙƒ";
            return "Ù…Ø¨Ø§Ø´Ø±";
        }

       // Ø¯Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø²ÙŠØ§Ø±Ø© Ø§Ù„Ù…Ø­Ø¯Ø«Ø© Ù„ØªÙˆØ§ÙÙ‚ GitHub Pages
async function recordVisit(linkId) {
    try {
        // Ø¬Ù„Ø¨ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª IP Ø¨Ø·Ø±ÙŠÙ‚Ø© Ù…ØªÙˆØ§ÙÙ‚Ø© Ù…Ø¹ GitHub Pages
        let ipInfo = {
            country: "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ",
            region: "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ", 
            city: "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ",
            ip: "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ",
            org: "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ"
        };
        
        try {
            // Ù…Ø­Ø§ÙˆÙ„Ø© Ø¬Ù„Ø¨ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹
            const response = await fetch('https://ipapi.co/json/');
            if (response.ok) {
                const data = await response.json();
                ipInfo = {
                    country: data.country_name || "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ",
                    region: data.region || "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ", 
                    city: data.city || "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ",
                    ip: data.ip || "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ",
                    org: data.org || "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ"
                };
            }
        } catch (ipError) {
            console.log('ØªØ¹Ø°Ø± Ø¬Ù„Ø¨ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª IP:', ipError.message);
        }

        const visitData = {
            timestamp: new Date(),
            linkId: linkId,
            country: ipInfo.country,
            region: ipInfo.region,
            city: ipInfo.city,
            ip: ipInfo.ip,
            org: ipInfo.org,
            device: detectDeviceType(),
            browser: detectBrowser(), 
            os: detectOS(),
            source: detectReferrer(),
            userAgent: navigator.userAgent.substring(0, 100) // ØªÙ‚ÙŠÙŠØ¯ Ø·ÙˆÙ„ userAgent
        };

        // Ø­ÙØ¸ Ø§Ù„Ø²ÙŠØ§Ø±Ø© ÙÙŠ Firebase
        await db.collection('visits').add(visitData);
        
        // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù†Ù‚Ø±Ø§Øª
        await db.collection('links').doc(linkId).update({
            clicks: firebase.firestore.FieldValue.increment(1),
            lastVisit: firebase.firestore.FieldValue.serverTimestamp()
        });

        console.log('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø²ÙŠØ§Ø±Ø© Ø¨Ù†Ø¬Ø§Ø­');

    } catch (error) {
        console.error('ÙØ´Ù„ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø²ÙŠØ§Ø±Ø©:', error);
        
        // ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„ÙØ´Ù„ØŒ Ø³Ø¬Ù„ Ø²ÙŠØ§Ø±Ø© Ø£Ø³Ø§Ø³ÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„
        try {
            await db.collection('links').doc(linkId).update({
                clicks: firebase.firestore.FieldValue.increment(1)
            });
        } catch (basicError) {
            console.error('ÙØ´Ù„ ÙÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ:', basicError);
        }
    }
}
        
        // Ø¯Ø§Ù„Ø© Ø¥Ù†Ø´Ø§Ø¡ ÙˆØµÙ ØªØ´ÙˆÙŠÙ‚ÙŠ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Deepseek API
        async function generateEpisodeDescription(linkId, seriesName, episodeNum) {
            try {
                const SECRET_KEY = "MySuperSecret123!"; // ÙŠØ¬Ø¨ Ø£Ù† ÙŠØªØ·Ø§Ø¨Ù‚ Ù…Ø¹ Netlify
                const response = await fetch('/.netlify/functions/deepseek-proxy', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'x-secret-key': SECRET_KEY
                    },
                    body: JSON.stringify({ 
                        seriesName, 
                        episodeNum,
                        linkId
                    })
                });

                if (!response.ok) throw new Error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø´Ø¨ÙƒØ©');
                
                const data = await response.json();
                return data.description;
                
            } catch (error) {
                console.error('ÙØ´Ù„ ÙÙŠ ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ÙˆØµÙ:', error);
                
                try {
                    const linkDoc = await db.collection('links').doc(linkId).get();
                    if (linkDoc.exists) {
                        const linkData = linkDoc.data();
                        
                        if (linkData.socialDescription) {
                            return linkData.socialDescription;
                        }
                        
                        return `Ù…Ø³Ù„Ø³Ù„ ${seriesName} - Ø§Ù„Ø­Ù„Ù‚Ø© ${episodeNum}: ${linkData.seriesName} ÙŠØªÙ†Ø§ÙˆÙ„ Ù‚ØµØ© Ø´ÙŠÙ‚Ø© ØªØ³ØªØ­Ù‚ Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø©`;
                    }
                } catch (firestoreError) {
                    console.error('ÙØ´Ù„ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„ÙˆØµÙ Ø§Ù„Ù…Ø®Ø²Ù†:', firestoreError);
                }
                
                return `Ø´Ø§Ù‡Ø¯ Ø§Ù„Ø­Ù„Ù‚Ø© ${episodeNum} Ù…Ù† ${seriesName} Ø¨Ø£Ø­Ø¯Ø§Ø« Ù…Ø´ÙˆÙ‚Ø© ÙˆØªØ·ÙˆØ±Ø§Øª ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹Ø©!`;
            }
        }

       // Handle redirection with proper content display
async function handleRedirection(linkId) {
    console.log('Ø¨Ø¯Ø¡ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„Ù„Ø±Ø§Ø¨Ø·:', linkId);
    
    hideAllPanels();
    redirectPanel.style.display = 'block';
    
    // Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©
    const redirectLoader = document.getElementById('redirectLoader');
    const contentCard = document.getElementById('contentCard');
    const contentThumbnail = document.getElementById('contentThumbnail');
    const contentType = document.getElementById('contentType');
    const contentEpisode = document.getElementById('contentEpisode');
    const contentDate = document.getElementById('contentDate');
    const contentTitle = document.getElementById('contentTitle');
    const contentDescription = document.getElementById('contentDescription');
    const contentViews = document.getElementById('contentViews');
    const contentCreated = document.getElementById('contentCreated');
    
    // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© ÙÙˆØ±Ø§Ù‹
    if (contentCard) {
        contentCard.style.display = 'block';
        contentCard.style.visibility = 'visible';
    }
    
    redirectLoader.style.display = 'block';
    redirectMessage.textContent = 'Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰...';
    
    try {
        // Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ø§Ø¨Ø· Ù…Ù† Firestore
        console.log('Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ø§Ø¨Ø· Ù…Ù† Firestore...');
        const linkDoc = await db.collection('links').doc(linkId).get();
        
        if (!linkDoc.exists) {
            throw new Error('Ø§Ù„Ø±Ø§Ø¨Ø· ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
        }
        
        const linkData = linkDoc.data();
        console.log('Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø¬Ù„Ø¨Ø©:', linkData);
        
        const destinationUrl = linkData.originalUrl;
        
        // ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
        if (contentTitle) {
            contentTitle.textContent = linkData.seriesName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
            contentTitle.style.display = 'block';
            contentTitle.style.visibility = 'visible';
        }
        
        if (contentType) {
            contentType.textContent = getTypeName(linkData.linkType || 'series');
            contentType.style.display = 'inline-block';
            contentType.style.visibility = 'visible';
        }
        
        // ØªØ­Ø¯ÙŠØ¯ ÙˆØ¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±Ø©
        const imageUrl = linkData.socialImage || 
                        linkData.thumbnailUrl || 
                        'https://via.placeholder.com/800x300/4A154B/FFFFFF?text=' + 
                        encodeURIComponent(linkData.seriesName || 'Ù…Ø­ØªÙˆÙ‰');
        
        if (contentThumbnail) {
            contentThumbnail.src = imageUrl;
            contentThumbnail.alt = linkData.seriesName || 'ØµÙˆØ±Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰';
            contentThumbnail.style.display = 'block';
            contentThumbnail.style.visibility = 'visible';
            
            // Ù…Ø¹Ø§Ù„Ø¬Ø© ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©
            contentThumbnail.onerror = function() {
                this.src = 'https://via.placeholder.com/800x300/4A154B/FFFFFF?text=' + 
                          encodeURIComponent('Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙˆØ±Ø©');
                console.log('ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©ØŒ Ø§Ø³ØªØ®Ø¯Ø§Ù… ØµÙˆØ±Ø© Ø¨Ø¯ÙŠÙ„Ø©');
            };
            
            console.log('ØªÙ… ØªØ¹ÙŠÙŠÙ† ØµÙˆØ±Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰:', imageUrl);
        }
        
        // Ø­Ø³Ø§Ø¨ Ø±Ù‚Ù… Ø§Ù„Ø­Ù„Ù‚Ø© Ù„Ù„Ù…Ø³Ù„Ø³Ù„Ø§Øª
        let episodeNum = 1;
        let showEpisodeInfo = false;
        
        if (linkData.linkType === 'series' && linkData.startingEpisode && linkData.startDate) {
            const createdAt = linkData.startDate.toDate();
            const now = new Date();
            
            // Ø­Ø³Ø§Ø¨ Ø§Ù„ÙØ±Ù‚ Ø¨Ø§Ù„Ø£ÙŠØ§Ù…
            const timezoneOffset = 3; // ØªÙˆÙ‚ÙŠØª Ø§Ù„Ù…Ù†Ø·Ù‚Ø©
            const nowUTC = new Date(now.getTime() + (now.getTimezoneOffset() * 60000));
            const startUTC = new Date(createdAt.getTime() + (createdAt.getTimezoneOffset() * 60000));
            
            nowUTC.setHours(nowUTC.getHours() + timezoneOffset);
            startUTC.setHours(startUTC.getHours() + timezoneOffset);
            
            const msPerDay = 24 * 60 * 60 * 1000;
            const diffDays = Math.floor((nowUTC - startUTC) / msPerDay);
            
            episodeNum = linkData.startingEpisode + diffDays;
            
            if (linkData.totalEpisodes && episodeNum > linkData.totalEpisodes) {
                episodeNum = linkData.totalEpisodes;
            }
            
            showEpisodeInfo = true;
            
            // ØªØ­Ø¯ÙŠØ« Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡
            redirectMessage.innerHTML = `Ø³ÙŠØªÙ… ØªÙˆØ¬ÙŠÙ‡Ùƒ Ù„Ù…Ø´Ø§Ù‡Ø¯Ø© Ø­Ù„Ù‚Ø© Ø§Ù„ÙŠÙˆÙ… <span class="highlight">${episodeNum}</span> Ù…Ù† Ø§Ù„Ù…Ø³Ù„Ø³Ù„:<br><span class="highlight">${linkData.seriesName}</span>`;
        } else {
            redirectMessage.innerHTML = `Ø³ÙŠØªÙ… ØªÙˆØ¬ÙŠÙ‡Ùƒ Ø¥Ù„Ù‰ <span class="highlight">${getTypeName(linkData.linkType)}</span>:<br><span class="highlight">${linkData.seriesName}</span>`;
        }
        
        // Ø¥Ø¸Ù‡Ø§Ø± Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø­Ù„Ù‚Ø©
        if (showEpisodeInfo && contentEpisode) {
            contentEpisode.textContent = `Ø§Ù„Ø­Ù„Ù‚Ø© ${episodeNum}`;
            contentEpisode.style.display = 'inline-block';
            contentEpisode.style.visibility = 'visible';
        } else if (contentEpisode) {
            contentEpisode.style.display = 'none';
        }
        
        // Ø¹Ø±Ø¶ Ø§Ù„ØªØ§Ø±ÙŠØ®
        if (contentDate) {
            const today = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            contentDate.textContent = today.toLocaleDateString('ar-EG', options);
            contentDate.style.display = 'inline-block';
            contentDate.style.visibility = 'visible';
        }
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØµÙ
        let description = '';
        if (linkData.linkType === 'series') {
            try {
                description = await generateEpisodeDescription(linkId, linkData.seriesName, episodeNum);
            } catch (error) {
                console.log('ÙØ´Ù„ ÙÙŠ ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ÙˆØµÙ:', error);
                description = linkData.socialDescription || `Ø´Ø§Ù‡Ø¯ Ø§Ù„Ø­Ù„Ù‚Ø© ${episodeNum} Ù…Ù† ${linkData.seriesName}`;
            }
        } else {
            description = linkData.socialDescription || linkData.seriesName || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØµÙ Ù…ØªØ§Ø­';
        }
        
        if (contentDescription) {
            contentDescription.textContent = description;
            contentDescription.style.display = 'block';
            contentDescription.style.visibility = 'visible';
        }
        
        // Ø¹Ø±Ø¶ Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø§Øª
        if (contentViews) {
            const views = linkData.clicks || 0;
            contentViews.textContent = `${views.toLocaleString()} Ù…Ø´Ø§Ù‡Ø¯Ø©`;
            contentViews.style.display = 'block';
            contentViews.style.visibility = 'visible';
        }
        
        // Ø¹Ø±Ø¶ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡
        if (contentCreated && linkData.createdAt) {
            const createdDate = linkData.createdAt.toDate();
            contentCreated.textContent = createdDate.toLocaleDateString('ar-EG');
            contentCreated.style.display = 'block';
            contentCreated.style.visibility = 'visible';
        }
        
        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø²ÙŠØ§Ø±Ø©
        console.log('ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø²ÙŠØ§Ø±Ø©...');
        recordVisit(linkId);
        
        // Ø¥Ø®ÙØ§Ø¡ Ù…Ø¤Ø´Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¨Ø¹Ø¯ Ø§Ù„ØªØ¹Ø¨Ø¦Ø©
        redirectLoader.style.display = 'none';
        
        console.log('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
        
        // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¨Ø¹Ø¯ 15 Ø«Ø§Ù†ÙŠØ©
        setTimeout(() => {
            console.log('Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰:', destinationUrl);
            window.location.href = destinationUrl;
        }, 15000);
        
    } catch (error) {
        console.error('Ø®Ø·Ø£ ÙÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡:', error);
        redirectLoader.style.display = 'none';
        
        // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø®Ø·Ø£ Ù…Ø¹ Ø¥Ø¨Ù‚Ø§Ø¡ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ù…Ø±Ø¦ÙŠØ©
        if (contentTitle) contentTitle.textContent = 'Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰';
        if (contentDescription) contentDescription.textContent = `Ø­Ø¯Ø« Ø®Ø·Ø£: ${error.message}`;
        if (contentType) contentType.textContent = 'Ø®Ø·Ø£';
        
        redirectMessage.innerHTML = `
            <strong>Ø®Ø·Ø£!</strong> ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ø§Ø¨Ø·.<br>
            <span class="text-danger">${error.message}</span>
        `;
    }
}
        
        // Ø¯Ø§Ù„Ø© Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© ÙˆØ¥Ø¸Ù‡Ø§Ø±Ù‡Ø§
function ensureImageVisibility(imageElement, fallbackUrl, title) {
    if (!imageElement) return;
    
    // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¹Ù†ØµØ± ÙÙˆØ±Ø§Ù‹
    imageElement.style.display = 'block';
    imageElement.style.visibility = 'visible';
    imageElement.style.opacity = '1';
    
    // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù„Ø¬ Ù„Ù†Ø¬Ø§Ø­ Ø§Ù„ØªØ­Ù…ÙŠÙ„
    imageElement.onload = function() {
        console.log('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­');
        this.style.opacity = '1';
        this.style.visibility = 'visible';
        this.style.display = 'block';
    };
    
    // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù„Ø¬ Ù„ÙØ´Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„
    imageElement.onerror = function() {
        console.log('ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©ØŒ Ø§Ø³ØªØ®Ø¯Ø§Ù… ØµÙˆØ±Ø© Ø¨Ø¯ÙŠÙ„Ø©');
        this.src = fallbackUrl || 'https://via.placeholder.com/800x300/4A154B/FFFFFF?text=' + 
                   encodeURIComponent(title || 'Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙˆØ±Ø©');
        this.style.display = 'block';
        this.style.visibility = 'visible';
        this.style.opacity = '1';
    };
    
    // ÙØ±Ø¶ Ø§Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØ© ÙˆØ§Ø­Ø¯Ø©
    setTimeout(() => {
        if (imageElement) {
            imageElement.style.display = 'block';
            imageElement.style.visibility = 'visible';
            imageElement.style.opacity = '1';
        }
    }, 1000);
}

// Ø¯Ø§Ù„Ø© Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø¬Ù…ÙŠØ¹ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©
function showContentCard() {
    const elements = [
        'contentCard',
        'contentThumbnail', 
        'contentType',
        'contentTitle',
        'contentDescription',
        'contentMeta'
    ];
    
    elements.forEach(id => {
        const element = document.getElementById(id);
        if (element) {
            element.style.display = element.tagName === 'IMG' ? 'block' : 
                                   element.classList.contains('content-meta') ? 'flex' : 'block';
            element.style.visibility = 'visible';
            element.style.opacity = '1';
        }
    });
    
    console.log('ØªÙ… Ø¥Ø¸Ù‡Ø§Ø± Ø¬Ù…ÙŠØ¹ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©');
}

// Ø¯Ø§Ù„Ø© Ù„ØªØ·Ø¨ÙŠÙ‚ Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù‚Ø³Ø±ÙŠ
function forceShowElements() {
    const forceShowCSS = `
        .content-card,
        .content-thumbnail,
        .content-info,
        .content-meta,
        .content-title,
        .content-description,
        .content-type,
        .content-episode,
        .content-date {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        
        .content-meta {
            display: flex !important;
        }
        
        .content-type,
        .content-episode, 
        .content-date {
            display: inline-block !important;
        }
    `;
    
    // Ø¥Ø¶Ø§ÙØ© CSS Ù„Ù„ØµÙØ­Ø©
    const style = document.createElement('style');
    style.textContent = forceShowCSS;
    document.head.appendChild(style);
    
    console.log('ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù‚Ø³Ø±ÙŠ');
}
        
        // Show notification
        function showNotification(type, message, duration = 3000) {
            const notification = document.getElementById(`${type}Notification`);
            const messageEl = notification.querySelector('div:first-child');
            
            messageEl.textContent = message;
            notification.style.display = 'block';
            setTimeout(() => {
                notification.classList.add('show');
            }, 10);
            
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    notification.style.display = 'none';
                }, 400);
            }, duration);
        }
        
        // Copy to clipboard with fallback and error handling
        function copyToClipboard() {
            const copyText = document.getElementById("generatedLink");
            copyText.select();
            copyText.setSelectionRange(0, 99999);
            
            try {
                if (navigator.clipboard) {
                    navigator.clipboard.writeText(copyText.value)
                        .then(() => {
                            showNotification('success', 'ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©!');
                            // Change button icon to success
                            const copyBtn = document.getElementById('copyLinkBtn');
                            copyBtn.innerHTML = '<i class="fas fa-check me-1"></i>ØªÙ… Ø§Ù„Ù†Ø³Ø®!';
                            setTimeout(() => {
                                copyBtn.innerHTML = '<i class="fas fa-copy me-1"></i>Ù†Ø³Ø®';
                            }, 2000);
                        })
                        .catch(err => {
                            console.error('Failed to copy: ', err);
                            showNotification('error', 'ÙØ´Ù„ Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·');
                        });
                } else {
                    // Fallback for older browsers
                    document.execCommand('copy');
                    showNotification('success', 'ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©!');
                    const copyBtn = document.getElementById('copyLinkBtn');
                    copyBtn.innerHTML = '<i class="fas fa-check me-1"></i>ØªÙ… Ø§Ù„Ù†Ø³Ø®!';
                    setTimeout(() => {
                                copyBtn.innerHTML = '<i class="fas fa-copy me-1"></i>Ù†Ø³Ø®';
                            }, 2000);
                }
            } catch (err) {
                console.error('Failed to copy: ', err);
                showNotification('error', 'ÙØ´Ù„ Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·');
            }
        }
        
        // URL validation
        function isValidUrl(url) {
            try {
                new URL(url);
                return true;
            } catch (e) {
                return false;
            }
        }
        
        // Series name validation
        function isValidSeriesName(name) {
            // Allow all Arabic characters and standard symbols
            const regex = /^[\p{Script=Arabic}\w\s\-_]+$/u;
            return regex.test(name);
        }
        
        // Generate new link with reCAPTCHA
        async function generateLink() {
            const seriesNameInput = document.getElementById('seriesName');
            const originalUrlInput = document.getElementById('originalUrl');
            const seriesName = seriesNameInput.value.trim();
            const originalUrl = originalUrlInput.value.trim();
            const socialTitle = document.getElementById('socialTitle').value.trim();
            const socialDescription = document.getElementById('socialDescription').value.trim();
            const socialImage = document.getElementById('socialImage').value.trim();
            const linkType = document.getElementById('linkType').value;
            const totalEpisodes = parseInt(document.getElementById('totalEpisodes').value) || 0;
            const startingEpisode = parseInt(document.getElementById('startingEpisode').value) || 1;
            
            // Reset validation states
            seriesNameInput.classList.remove('is-invalid');
            originalUrlInput.classList.remove('is-invalid');
            document.getElementById('episodeError').style.display = 'none';
            
            // Validate URL
            if (!isValidUrl(originalUrl)) {
                originalUrlInput.classList.add('is-invalid');
                showNotification('error', 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø§Ø¨Ø· ØµØ§Ù„Ø­');
                return;
            }
            
            // Validate series name
            if (!seriesName || !isValidSeriesName(seriesName)) {
                seriesNameInput.classList.add('is-invalid');
                showNotification('error', 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø³Ù„Ø³Ù„Ø© ØµØ§Ù„Ø­');
                return;
            }
            
            // Validate episode count for series
            if (linkType === 'series' && (!totalEpisodes || totalEpisodes < 1)) {
                document.getElementById('episodeError').style.display = 'block';
                showNotification('error', 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ø¯Ø¯ Ø­Ù„Ù‚Ø§Øª ØµØ­ÙŠØ­');
                return;
            }
            
            try {
                // Execute reCAPTCHA
                const token = await new Promise((resolve) => {
                    grecaptcha.ready(() => {
                        grecaptcha.execute('6LesFYErAAAAAOpY8Pbc0furepnxPt0WyJorH5Qw', {action: 'create_link'})
                            .then(resolve);
                    });
                });
                
                // Disable button during processing
                generateBtn.disabled = true;
                generateBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡...';
                
                // Generate random 6-digit ID
                const linkId = Math.floor(100000 + Math.random() * 900000).toString();
                
                // Create the new link in the required format
                const customDomain = document.getElementById('customDomain').value || 'turkify.com';
                
                // Update 8: Change parameter name for series
                const paramName = linkType === 'series' ? 'halqat-alyawm-min-musalsal' : linkType;
                const newLink = `https://${customDomain}/?${paramName}=${encodeURIComponent(seriesName)}&id=${linkId}`;
                
                // Get current user
                const user = auth.currentUser;
                
                // Create link data
                const linkData = {
                    id: linkId,
                    seriesName: seriesName,
                    linkType: linkType,
                    originalUrl: originalUrl,
                    shortUrl: newLink,
                    customDomain: customDomain,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                    userId: user ? user.uid : null,
                    clicks: 0,
                    socialTitle: socialTitle || `Turkify - ${getTypeName(linkType)} ${seriesName}`,
                    socialDescription: socialDescription || `Ø´Ø§Ù‡Ø¯ ${seriesName} Ø§Ù„Ø¢Ù† Ø¹Ù„Ù‰ Turkify!`,
                    socialImage: socialImage || 'https://via.placeholder.com/1200x630/4A154B/FFFFFF?text=Turkify+Pro',
                };
                
                // Add totalEpisodes and startingEpisode for series
                if (linkType === 'series') {
                    linkData.totalEpisodes = totalEpisodes;
                    linkData.startingEpisode = startingEpisode;
                    
                    // Set startDate to current time (for episode calculation)
                    linkData.startDate = firebase.firestore.Timestamp.now();
                }
                
                // Save to Firestore
                await db.collection('links').doc(linkId).set(linkData);
                
                // Show modal with the new link
                document.getElementById('generatedLink').value = newLink;
                document.getElementById('originalLinkDisplay').textContent = originalUrl;
                
                const modal = new bootstrap.Modal(document.getElementById('linkModal'));
                modal.show();
                
                // Show success notification
                showNotification('success', 'ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ù†Ø¬Ø§Ø­!');
                
                // Reset form
                document.getElementById('seriesName').value = '';
                document.getElementById('originalUrl').value = '';
                document.getElementById('totalEpisodes').value = '';
                document.getElementById('startingEpisode').value = '1';
                document.getElementById('episodeCountWrapper').style.display = 'none';
                document.getElementById('startingEpisodeWrapper').style.display = 'none';
                document.getElementById('socialTitle').value = '';
                document.getElementById('socialDescription').value = '';
                document.getElementById('socialImage').value = '';
                
                // Re-enable button
                generateBtn.disabled = false;
                generateBtn.innerHTML = '<i class="fas fa-bolt me-2"></i>Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø§Ø¨Ø·';
                
                // Reload links table
                loadLinks();
            } catch (error) {
                console.error('Error saving link:', error);
                showNotification('error', `ÙØ´Ù„ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø±Ø§Ø¨Ø·: ${error.message}`);
                // Re-enable button
                generateBtn.disabled = false;
                generateBtn.innerHTML = '<i class="fas fa-bolt me-2"></i>Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø§Ø¨Ø·';
            }
        }
        
        // Update existing link
        async function updateLink() {
            const seriesNameInput = document.getElementById('seriesName');
            const originalUrlInput = document.getElementById('originalUrl');
            const seriesName = seriesNameInput.value.trim();
            const originalUrl = originalUrlInput.value.trim();
            const socialTitle = document.getElementById('socialTitle').value.trim();
            const socialDescription = document.getElementById('socialDescription').value.trim();
            const socialImage = document.getElementById('socialImage').value.trim();
            const linkType = document.getElementById('linkType').value;
            const totalEpisodes = parseInt(document.getElementById('totalEpisodes').value) || 0;
            const startingEpisode = parseInt(document.getElementById('startingEpisode').value) || 1;
            
            // Reset validation states
            seriesNameInput.classList.remove('is-invalid');
            originalUrlInput.classList.remove('is-invalid');
            document.getElementById('episodeError').style.display = 'none';
            
            // Validate URL
            if (!isValidUrl(originalUrl)) {
                originalUrlInput.classList.add('is-invalid');
                showNotification('error', 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø§Ø¨Ø· ØµØ§Ù„Ø­');
                return;
            }
            
            // Validate series name
            if (!seriesName || !isValidSeriesName(seriesName)) {
                seriesNameInput.classList.add('is-invalid');
                showNotification('error', 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø³Ù„Ø³Ù„Ø© ØµØ§Ù„Ø­');
                return;
            }
            
            // Validate episode count for series
            if (linkType === 'series' && (!totalEpisodes || totalEpisodes < 1)) {
                document.getElementById('episodeError').style.display = 'block';
                showNotification('error', 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ø¯Ø¯ Ø­Ù„Ù‚Ø§Øª ØµØ­ÙŠØ­');
                return;
            }
            
            try {
                // Disable button during processing
                updateBtn.disabled = true;
                updateBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...';
                
                // Get link data
                const linkDoc = await db.collection('links').doc(currentEditingLinkId).get();
                
                if (linkDoc.exists) {
                    const linkData = linkDoc.data();
                    
                    // Update link data
                    const updatedData = {
                        seriesName: seriesName,
                        originalUrl: originalUrl,
                        socialTitle: socialTitle,
                        socialDescription: socialDescription,
                        socialImage: socialImage,
                        linkType: linkType
                    };
                    
                    // Add totalEpisodes and startingEpisode for series
                    if (linkType === 'series') {
                        updatedData.totalEpisodes = totalEpisodes;
                        updatedData.startingEpisode = startingEpisode;
                    } else {
                        updatedData.totalEpisodes = null;
                        updatedData.startingEpisode = null;
                    }
                    
                    // Save to Firestore
                    await db.collection('links').doc(currentEditingLinkId).update(updatedData);
                    
                    // Show success notification
                    showNotification('success', 'ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ù†Ø¬Ø§Ø­!');
                    
                    // Hide update button and show generate button
                    updateBtn.style.display = 'none';
                    generateBtn.style.display = 'block';
                    
                    // Reset form
                    document.getElementById('seriesName').value = '';
                    document.getElementById('originalUrl').value = '';
                    document.getElementById('totalEpisodes').value = '';
                    document.getElementById('startingEpisode').value = '1';
                    document.getElementById('episodeCountWrapper').style.display = 'none';
                    document.getElementById('startingEpisodeWrapper').style.display = 'none';
                    document.getElementById('socialTitle').value = '';
                    document.getElementById('socialDescription').value = '';
                    document.getElementById('socialImage').value = '';
                    
                    // Reset editing state
                    currentEditingLinkId = null;
                    
                    // Re-enable button
                    updateBtn.disabled = false;
                    updateBtn.innerHTML = '<i class="fas fa-save me-2"></i>Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª';
                    
                    // Reload links table
                    loadLinks();
                }
            } catch (error) {
                console.error('Error updating link:', error);
                showNotification('error', `ÙØ´Ù„ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ø§Ø¨Ø·: ${error.message}`);
                // Re-enable button
                updateBtn.disabled = false;
                updateBtn.innerHTML = '<i class="fas fa-save me-2"></i>Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª';
            }
        }
        
        // Get type name in Arabic
        function getTypeName(type) {
            const types = {
                'series': 'Ù…Ø³Ù„Ø³Ù„',
                'movie': 'ÙÙŠÙ„Ù…',
                'match': 'Ù…Ø¨Ø§Ø±Ø§Ø©',
                'recipe': 'ÙˆØµÙØ©',
                'game': 'Ù„Ø¹Ø¨Ø©',
                'app': 'ØªØ·Ø¨ÙŠÙ‚',
                'channel': 'Ù‚Ù†Ø§Ø©',
                'reels': 'Ø±ÙŠÙ„Ø²'
            };
            return types[type] || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
        }
        
        // Load links for admin panel
        async function loadLinks() {
            setLoading(true);
            // Show loading spinner
            linksTable.innerHTML = `
                <tr>
                    <td colspan="7" class="text-center table-loader">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</span>
                        </div>
                    </td>
                </tr>
            `;
            
            try {
                // Get current user
                const user = auth.currentUser;
                if (!user) {
                    linksTable.innerHTML = `
                        <tr>
                            <td colspan="7" class="text-center py-5">
                                <div class="alert alert-info">
                                    ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ
                                </div>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                // Load links from Firestore
                const querySnapshot = await db.collection('links').where('userId', '==', user.uid).get();
                
                if (querySnapshot.empty) {
                    linksTable.innerHTML = `
                        <tr>
                            <td colspan="7" class="text-center py-5">
                                Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±ÙˆØ§Ø¨Ø·. Ù‚Ù… Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø·Ùƒ Ø§Ù„Ø£ÙˆÙ„!
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                let tableContent = '';
                querySnapshot.forEach(doc => {
                    const link = doc.data();
                    
                    // Map link type to badge
                    const typeBadge = `<span class="link-type-badge type-${link.linkType || 'series'}">${getTypeName(link.linkType)}</span>`;
                    
                    tableContent += `
                        <tr>
                            <td>${link.id}</td>
                            <td>${link.seriesName}</td>
                            <td>${typeBadge}</td>
                            <td>
                                <a href="${link.shortUrl}" target="_blank" class="short-url">
                                    ${link.shortUrl}
                                </a>
                            </td>
                            <td>${link.createdAt ? formatFirestoreDateTime(link.createdAt) : 'N/A'}</td>
                            <td><span class="clicks-badge">${link.clicks}</span></td>
                            <td class="action-buttons">
                                <button class="btn btn-sm btn-outline-primary stats-btn" data-id="${link.id}" aria-label="Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª">
                                    <i class="fas fa-chart-bar"></i>
                                </button>
                                <button class="btn btn-sm btn-outline-info copy-btn" data-link="${link.shortUrl}" aria-label="Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·">
                                    <i class="fas fa-copy"></i>
                                </button>
                                <button class="btn btn-sm btn-outline-primary edit-btn" data-id="${link.id}" aria-label="ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø§Ø¨Ø·">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-sm btn-outline-danger delete-btn" data-id="${link.id}" aria-label="Ø­Ø°Ù Ø§Ù„Ø±Ø§Ø¨Ø·">
                                    <i class="fas fa-trash"></i>
                                </button>
                                <button class="btn btn-sm btn-outline-success earnings-btn" data-id="${link.id}" aria-label="Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª">
                                    <i class="fas fa-dollar-sign"></i>
                                </button>
                            </td>
                        </tr>
                    `;
                });
                
                linksTable.innerHTML = tableContent;
                
                // Add event listeners to action buttons
                document.querySelectorAll('.stats-btn').forEach(btn => {
    btn.addEventListener('click', async function() {
        const linkId = this.getAttribute('data-id');
        
        if (!linkId) {
            showNotification('error', 'Ù…Ø¹Ø±Ù Ø§Ù„Ø±Ø§Ø¨Ø· ØºÙŠØ± ØµØ§Ù„Ø­');
            return;
        }
        
        // ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø²Ø± Ù…Ø¤Ù‚ØªØ§Ù‹
        this.disabled = true;
        this.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
        
        try {
            await showLinkStats(linkId);
        } catch (error) {
            console.error('Error:', error);
            showNotification('error', 'ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª');
        } finally {
            // Ø¥Ø¹Ø§Ø¯Ø© ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø²Ø±
            this.disabled = false;
            this.innerHTML = '<i class="fas fa-chart-bar"></i>';
        }
    });
});
                
                document.querySelectorAll('.copy-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const linkUrl = this.getAttribute('data-link');
                        navigator.clipboard.writeText(linkUrl);
                        showNotification('success', 'ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©!');
                    });
                });
                
                document.querySelectorAll('.edit-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const linkId = this.getAttribute('data-id');
                        editLink(linkId);
                    });
                });
                
                document.querySelectorAll('.delete-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const linkId = this.getAttribute('data-id');
                        showConfirmation('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø±ØºØ¨ØªÙƒ ÙÙŠ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø·ØŸ', () => {
                            deleteLink(linkId);
                        });
                    });
                });
                
                document.querySelectorAll('.earnings-btn').forEach(btn => {
    btn.addEventListener('click', async function() {
        const linkId = this.getAttribute('data-id');
        
        if (!linkId) {
            showNotification('error', 'Ù…Ø¹Ø±Ù Ø§Ù„Ø±Ø§Ø¨Ø· ØºÙŠØ± ØµØ§Ù„Ø­');
            return;
        }
        
        // ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø²Ø± Ù…Ø¤Ù‚ØªØ§Ù‹
        this.disabled = true;
        const originalHTML = this.innerHTML;
        this.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
        
        try {
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ§ÙÙŠØ©
            const visitsQuery = await db.collection('visits')
                .where('linkId', '==', linkId)
                .limit(1)
                .get();
            
            if (visitsQuery.empty) {
                showNotification('info', 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø²ÙŠØ§Ø±Ø§Øª ÙƒØ§ÙÙŠØ© Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø¨Ø¹Ø¯');
                return;
            }
            
            await showEarnings(linkId);
        } catch (error) {
            console.error('Error loading earnings:', error);
            showNotification('error', 'ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø±Ø¨Ø§Ø­: ' + error.message);
        } finally {
            // Ø¥Ø¹Ø§Ø¯Ø© ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø²Ø±
            this.disabled = false;
            this.innerHTML = originalHTML;
        }
    });
});
            } catch (error) {
                console.error('Error loading links:', error);
                linksTable.innerHTML = `
                    <tr>
                        <td colspan="7" class="text-center py-5">
                            <div class="alert alert-danger">
                                ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·: ${error.message}
                            </div>
                        </td>
                    </tr>
                `;
            } finally {
                setLoading(false);
            }
        }
        
        // Show link statistics
async function showLinkStats(linkId) {
    setLoading(true);
    
    try {
        // Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
        const linkDoc = await db.collection('links').doc(linkId).get();
        
        if (!linkDoc.exists) {
            throw new Error('Ø§Ù„Ø±Ø§Ø¨Ø· ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
        }
        
        const linkData = linkDoc.data();
        
        // Ø¬Ù„Ø¨ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª Ø§Ù„ÙØ¹Ù„ÙŠØ© Ù…Ù† Firebase
        const visitsQuery = await db.collection('visits')
            .where('linkId', '==', linkId)
            .orderBy('timestamp', 'desc')
            .get();
        
        const allVisits = visitsQuery.docs.map(doc => doc.data()); 
        
        // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„ØªØ± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ (Ø£Ø³Ø¨ÙˆØ¹)
         const filteredVisits = filterVisitsByTimeRange(allVisits, 'week'); 
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
      updateStatsDisplay(filteredVisits);
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ© 
        createFilteredCharts(filteredVisits);
        
        // ØªØ­Ø¯ÙŠØ« ÙˆÙ‚Øª Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ« document.getElementById('lastUpdateTime') .textContent = new Date().toLocaleTimeString('ar-EG');
        
        // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ÙØ¹Ù„ÙŠØ©
        const visits = visitsQuery.docs.map(doc => doc.data());
        const totalVisits = visits.length;
        
        // Ø­Ø³Ø§Ø¨ Ø²ÙŠØ§Ø±Ø§Øª Ø§Ù„ÙŠÙˆÙ…
        const today = new Date();
        const startOfDay = new Date(today.getFullYear(), today.getMonth(), today.getDate());
        const todayVisits = visits.filter(visit => {
            const visitDate = visit.timestamp.toDate();
            return visitDate >= startOfDay;
        }).length;
        
        // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¨Ù„Ø¯ Ø§Ù„Ø£ÙƒØ«Ø± Ø²ÙŠØ§Ø±Ø©
        const countryCounts = {};
        visits.forEach(visit => {
            countryCounts[visit.country] = (countryCounts[visit.country] || 0) + 1;
        });
        const topCountry = Object.keys(countryCounts).reduce((a, b) => 
            countryCounts[a] > countryCounts[b] ? a : b, 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'
        );
        
        // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ø£ÙƒØ«Ø± Ø§Ø³ØªØ®Ø¯Ø§Ù…Ø§Ù‹
        const deviceCounts = {};
        visits.forEach(visit => {
            deviceCounts[visit.device] = (deviceCounts[visit.device] || 0) + 1;
        });
        const topDevice = Object.keys(deviceCounts).reduce((a, b) => 
            deviceCounts[a] > deviceCounts[b] ? a : b, 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'
        );
        
        // ØªØ¹Ø¨Ø¦Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¯Ø§Ù„
        const titleElement = document.getElementById('statsLinkTitle');
        const urlElement = document.getElementById('statsLinkUrl');
        const totalVisitsElement = document.getElementById('totalVisits');
        const todayVisitsElement = document.getElementById('todayVisits');
        const topCountryElement = document.getElementById('topCountry');
        const topDeviceElement = document.getElementById('topDevice');
        
        // ÙØ­Øµ ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ù‚Ø¨Ù„ Ø§Ù„ØªØ­Ø¯ÙŠØ«
        if (titleElement) titleElement.textContent = linkData.seriesName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
        if (urlElement) {
            urlElement.textContent = linkData.shortUrl || 'ØºÙŠØ± Ù…ØªØ§Ø­';
            urlElement.href = linkData.shortUrl || '#';
        }
        if (totalVisitsElement) totalVisitsElement.textContent = totalVisits.toLocaleString();
        if (todayVisitsElement) todayVisitsElement.textContent = todayVisits.toLocaleString();
        if (topCountryElement) topCountryElement.textContent = topCountry;
        if (topDeviceElement) topDeviceElement.textContent = topDevice;
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ© Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©
        createRealTimeCharts(visits);
        
        // Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„
        const modal = new bootstrap.Modal(document.getElementById('statsModal'));
        modal.show();
        
    } catch (error) {
        console.error('Error loading stats:', error);
        showNotification('error', 'ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª: ' + error.message);
    } finally {
        setLoading(false);
    }
}

// Ø¯ÙˆØ§Ù„ Ø§Ù„ÙÙ„ØªØ±Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ©
function filterVisitsByTimeRange(visits, timeRange) {
    const now = new Date();
    let startDate;
    
    switch(timeRange) {
        case 'today':
            startDate = new Date(now.getFullYear(), now.getMonth(), now.getDate());
            break;
        case 'week':
            startDate = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
            break;
        case '15days':
            startDate = new Date(now.getTime() - 15 * 24 * 60 * 60 * 1000);
            break;
        case 'month':
            startDate = new Date(now.getFullYear(), now.getMonth() - 1, now.getDate());
            break;
        case '3months':
            startDate = new Date(now.getFullYear(), now.getMonth() - 3, now.getDate());
            break;
        case '6months':
            startDate = new Date(now.getFullYear(), now.getMonth() - 6, now.getDate());
            break;
        case 'year':
            startDate = new Date(now.getFullYear() - 1, now.getMonth(), now.getDate());
            break;
        default:
            return visits; // Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ÙˆÙ‚Ø§Øª
    }
    
    return visits.filter(visit => {
        const visitDate = visit.timestamp.toDate();
        return visitDate >= startDate;
    });
}

function updateStatsDisplay(visits) {
    const totalVisits = visits.length;
    
    // Ø­Ø³Ø§Ø¨ Ø²ÙŠØ§Ø±Ø§Øª Ø§Ù„ÙŠÙˆÙ…
    const today = new Date();
    const startOfDay = new Date(today.getFullYear(), today.getMonth(), today.getDate());
    const todayVisits = visits.filter(visit => visit.timestamp.toDate() >= startOfDay).length;
    
    // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¨Ù„Ø¯ Ø§Ù„Ø£ÙƒØ«Ø± Ø²ÙŠØ§Ø±Ø©
    const countryCounts = {};
    visits.forEach(visit => {
        if (visit.country) {
            countryCounts[visit.country] = (countryCounts[visit.country] || 0) + 1;
        }
    });
    const topCountry = Object.keys(countryCounts).reduce((a, b) => 
        countryCounts[a] > countryCounts[b] ? a : b, 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'
    );
    
    // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ø£ÙƒØ«Ø± Ø§Ø³ØªØ®Ø¯Ø§Ù…Ø§Ù‹
    const deviceCounts = {};
    visits.forEach(visit => {
        if (visit.device) {
            deviceCounts[visit.device] = (deviceCounts[visit.device] || 0) + 1;
        }
    });
    const topDevice = Object.keys(deviceCounts).reduce((a, b) => 
        deviceCounts[a] > deviceCounts[b] ? a : b, 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'
    );
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù†Ø§ØµØ±
    const elements = {
        'totalVisits': totalVisits.toLocaleString(),
        'todayVisits': todayVisits.toLocaleString(),
        'topCountry': topCountry,
        'topDevice': topDevice
    };
    
    Object.entries(elements).forEach(([id, value]) => {
        const element = document.getElementById(id);
        if (element) element.textContent = value;
    });
}

function getFilterText(timeRange) {
    const filterTexts = {
        'today': 'Ø§Ù„ÙŠÙˆÙ…',
        'week': 'Ø¢Ø®Ø± Ø£Ø³Ø¨ÙˆØ¹',
        '15days': 'Ø¢Ø®Ø± 15 ÙŠÙˆÙ…',
        'month': 'Ø¢Ø®Ø± Ø´Ù‡Ø±',
        '3months': 'Ø¢Ø®Ø± 3 Ø£Ø´Ù‡Ø±',
        '6months': 'Ø¢Ø®Ø± 6 Ø£Ø´Ù‡Ø±',
        'year': 'Ø¢Ø®Ø± Ø³Ù†Ø©',
        'all': 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ÙˆÙ‚Ø§Øª'
    };
    return filterTexts[timeRange] || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
}
       
       // ÙØ­Øµ ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‚Ø¨Ù„ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­
function validateEarningsData(visits) {
    const validVisits = visits.filter(visit => {
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
        return visit && 
               visit.timestamp && 
               visit.country && 
               typeof visit.country === 'string' &&
               visit.linkId;
    });
    
    if (validVisits.length !== visits.length) {
        console.warn(`ØªÙ… ØªØ¬Ø§Ù‡Ù„ ${visits.length - validVisits.length} Ø²ÙŠØ§Ø±Ø© Ù„Ø¹Ø¯Ù… Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª`);
    }
    
    return validVisits;
}

// Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù…ÙÙŠØ¯Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
function generateEarningsReport(totalEarnings, arabVisits, foreignVisits) {
    const totalVisits = arabVisits + foreignVisits;
    
    let report = `ğŸ“Š ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø±Ø¨Ø§Ø­:\n`;
    report += `ğŸ’° Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­: $${totalEarnings.toFixed(2)}\n`;
    report += `ğŸ‘¥ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª: ${totalVisits.toLocaleString()}\n`;
    
    if (totalVisits > 0) {
        report += `ğŸŒ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©: ${arabVisits} (${((arabVisits/totalVisits)*100).toFixed(1)}%)\n`;
        report += `ğŸŒ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø£Ø¬Ù†Ø¨ÙŠØ©: ${foreignVisits} (${((foreignVisits/totalVisits)*100).toFixed(1)}%)\n`;
        
        // Ù†ØµØ§Ø¦Ø­ Ù„Ù„ØªØ­Ø³ÙŠÙ†
        if (foreignVisits < arabVisits) {
            report += `\nğŸ’¡ Ù†ØµÙŠØ­Ø©: Ø­Ø§ÙˆÙ„ Ø§Ù„ØªØ±ÙˆÙŠØ¬ ÙÙŠ Ø§Ù„Ø¨Ù„Ø¯Ø§Ù† Ø§Ù„Ø£Ø¬Ù†Ø¨ÙŠØ© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£Ø±Ø¨Ø§Ø­ Ø£Ø¹Ù„Ù‰!`;
        }
    }
    
    return report;
} 
        // Show real earnings for a link
async function showEarnings(linkId) {
    setLoading(true);
    window.currentEarningsLinkId = linkId;
    
    try {
        // Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ø§Ø¨Ø·
        const linkDoc = await db.collection('links').doc(linkId).get();
        if (!linkDoc.exists) {
            throw new Error('Ø§Ù„Ø±Ø§Ø¨Ø· ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
        }
        
        const linkData = linkDoc.data();
        
        // Ø¬Ù„Ø¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª Ù„Ù„Ø±Ø§Ø¨Ø·
        const visitsQuery = await db.collection('visits')
            .where('linkId', '==', linkId)
            .orderBy('timestamp', 'desc')
            .get();
        
        const visits = visitsQuery.docs.map(doc => doc.data());
        
        // ØªØµÙ†ÙŠÙ Ø§Ù„Ø¨Ù„Ø¯Ø§Ù† Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ÙˆØ§Ù„Ø£Ø¬Ù†Ø¨ÙŠØ©
        const arabicCountries = [
            'Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©', 'Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª', 'Ù…ØµØ±', 'Ø§Ù„Ø¹Ø±Ø§Ù‚', 'Ø§Ù„Ø£Ø±Ø¯Ù†', 'Ù„Ø¨Ù†Ø§Ù†', 
            'Ø³ÙˆØ±ÙŠØ§', 'Ø§Ù„ÙƒÙˆÙŠØª', 'Ù‚Ø·Ø±', 'Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†', 'Ø¹Ù…Ø§Ù†', 'Ø§Ù„ÙŠÙ…Ù†',
            'Ø§Ù„Ù…ØºØ±Ø¨', 'Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±', 'ØªÙˆÙ†Ø³', 'Ù„ÙŠØ¨ÙŠØ§', 'Ø§Ù„Ø³ÙˆØ¯Ø§Ù†', 'Ø§Ù„ØµÙˆÙ…Ø§Ù„',
            'Ù…ÙˆØ±ÙŠØªØ§Ù†ÙŠØ§', 'Ø¬ÙŠØ¨ÙˆØªÙŠ', 'Ø¬Ø²Ø± Ø§Ù„Ù‚Ù…Ø±', 'ÙÙ„Ø³Ø·ÙŠÙ†',
            'Saudi Arabia', 'United Arab Emirates', 'Egypt', 'Iraq', 
            'Jordan', 'Lebanon', 'Syria', 'Kuwait', 'Qatar', 'Bahrain', 
            'Oman', 'Yemen', 'Morocco', 'Algeria', 'Tunisia', 'Libya', 
            'Sudan', 'Somalia', 'Mauritania', 'Djibouti', 'Comoros', 'Palestine'
        ];
        
        // ÙØµÙ„ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©
        let arabVisits = 0;
        let foreignVisits = 0;
        let todayArabVisits = 0;
        let todayForeignVisits = 0;
        
        const today = new Date();
        const startOfDay = new Date(today.getFullYear(), today.getMonth(), today.getDate());
        
        visits.forEach(visit => {
            const isArabic = arabicCountries.includes(visit.country);
            const visitDate = visit.timestamp.toDate();
            const isToday = visitDate >= startOfDay;
            
            if (isArabic) {
                arabVisits++;
                if (isToday) todayArabVisits++;
            } else {
                foreignVisits++;
                if (isToday) todayForeignVisits++;
            }
        });
        
        // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­
        // $1 Ù„ÙƒÙ„ 1000 Ø²ÙŠØ§Ø±Ø© Ø¹Ø±Ø¨ÙŠØ©
        // $3 Ù„ÙƒÙ„ 1000 Ø²ÙŠØ§Ø±Ø© Ø£Ø¬Ù†Ø¨ÙŠØ©
        const arabEarnings = (arabVisits / 1000) * 1.00;
        const foreignEarnings = (foreignVisits / 1000) * 3.00;
        const totalEarnings = arabEarnings + foreignEarnings;
        
        const todayArabEarnings = (todayArabVisits / 1000) * 1.00;
        const todayForeignEarnings = (todayForeignVisits / 1000) * 3.00;
        const todayTotalEarnings = todayArabEarnings + todayForeignEarnings;
        
        const totalVisits = arabVisits + foreignVisits;
        const averageRPM = totalVisits > 0 ? (totalEarnings / totalVisits) * 1000 : 0;
        const validVisits = validateEarningsData(visits);
        
        // ØªØ­Ø¯ÙŠØ« modal Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
        document.getElementById('earningsLinkTitle').textContent = linkData.seriesName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ modal
        document.getElementById('totalEarnings').textContent = `$${totalEarnings.toFixed(2)}`;
        document.getElementById('totalImpressions').textContent = totalVisits.toLocaleString();
        document.getElementById('averageRPM').textContent = `$${averageRPM.toFixed(2)}`;
        document.getElementById('todayEarnings').textContent = `$${todayTotalEarnings.toFixed(2)}`;
        
        // ØªØ­Ø¯ÙŠØ« ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚
        document.getElementById('arabVisits').textContent = `${arabVisits.toLocaleString()} Ø²ÙŠØ§Ø±Ø©`;
        document.getElementById('arabEarnings').textContent = `$${arabEarnings.toFixed(2)}`;
        document.getElementById('foreignVisits').textContent = `${foreignVisits.toLocaleString()} Ø²ÙŠØ§Ø±Ø©`;
        document.getElementById('foreignEarnings').textContent = `$${foreignEarnings.toFixed(2)}`;
        
        // ØªØ­Ø¯ÙŠØ« Ø£Ø´Ø±Ø·Ø© Ø§Ù„ØªÙ‚Ø¯Ù…
        const arabPercentage = totalVisits > 0 ? (arabVisits / totalVisits) * 100 : 0;
        const foreignPercentage = totalVisits > 0 ? (foreignVisits / totalVisits) * 100 : 0;
        
        document.getElementById('arabProgress').style.width = `${arabPercentage}%`;
        document.getElementById('foreignProgress').style.width = `${foreignPercentage}%`;
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ù„Ù„Ø£Ø±Ø¨Ø§Ø­
        await createEarningsChart(visits, arabicCountries);
        
        // Ø¹Ø±Ø¶ modal
        const modal = new bootstrap.Modal(document.getElementById('earningsModal'));
        modal.show();
        
    } catch (error) {
        console.error('Error loading earnings:', error);
        showNotification('error', 'ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø±Ø¨Ø§Ø­: ' + error.message);
    } finally {
        setLoading(false);
    }
}

// ÙÙ„ØªØ±Ø© Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø­Ø³Ø¨ Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ©
function filterEarningsByTime(visits, timePeriod, arabicCountries) {
    const now = new Date();
    let startDate;
    
    switch(timePeriod) {
        case 'Ø§Ù„ÙŠÙˆÙ…':
            startDate = new Date(now.getFullYear(), now.getMonth(), now.getDate());
            break;
        case 'Ø£Ø³Ø¨ÙˆØ¹':
            startDate = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
            break;
        case 'Ø´Ù‡Ø±':
            startDate = new Date(now.getFullYear(), now.getMonth() - 1, now.getDate());
            break;
        case '3 Ø£Ø´Ù‡Ø±':
            startDate = new Date(now.getFullYear(), now.getMonth() - 3, now.getDate());
            break;
        case 'Ø³Ù†Ø©':
            startDate = new Date(now.getFullYear() - 1, now.getMonth(), now.getDate());
            break;
        default:
            startDate = new Date(0); // Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ÙˆÙ‚Ø§Øª
    }
    
    const filteredVisits = visits.filter(visit => {
        const visitDate = visit.timestamp.toDate();
        return visitDate >= startDate;
    });
    
    // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ù…ÙÙ„ØªØ±Ø©
    let arabVisits = 0;
    let foreignVisits = 0;
    
    filteredVisits.forEach(visit => {
        if (arabicCountries.includes(visit.country)) {
            arabVisits++;
        } else {
            foreignVisits++;
        }
    });
    
    const arabEarnings = (arabVisits / 1000) * 1.00;
    const foreignEarnings = (foreignVisits / 1000) * 3.00;
    const totalEarnings = arabEarnings + foreignEarnings;
    
    return {
        arabVisits,
        foreignVisits,
        arabEarnings,
        foreignEarnings,
        totalEarnings,
        totalVisits: arabVisits + foreignVisits
    };
}

// Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù„Ø¬Ø§Øª Ø£Ø²Ø±Ø§Ø± Ø§Ù„ÙÙ„ØªØ±Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ© Ù„Ù„Ø£Ø±Ø¨Ø§Ø­
document.addEventListener('DOMContentLoaded', function() {
    // Ù…Ø¹Ø§Ù„Ø¬ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ÙÙ„ØªØ±Ø© ÙÙŠ modal Ø§Ù„Ø£Ø±Ø¨Ø§Ø­
    const earningsModal = document.getElementById('earningsModal');
    if (earningsModal) {
        earningsModal.addEventListener('click', function(e) {
            if (e.target.classList.contains('time-btn')) {
                // Ø¥Ø²Ø§Ù„Ø© active Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
                earningsModal.querySelectorAll('.time-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                // Ø¥Ø¶Ø§ÙØ© active Ù„Ù„Ø²Ø± Ø§Ù„Ù…Ø­Ø¯Ø¯
                e.target.classList.add('active');
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø§Ù„ÙÙ„ØªØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯
                const timePeriod = e.target.textContent;
                updateEarningsWithFilter(timePeriod);
            }
        });
    }
});

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ù…Ø¹ Ø§Ù„ÙÙ„ØªØ±
async function updateEarningsWithFilter(timePeriod) {
    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ linkId Ø§Ù„Ø­Ø§Ù„ÙŠ (ÙŠØ¬Ø¨ ØªØ®Ø²ÙŠÙ†Ù‡ Ø¹Ù†Ø¯ ÙØªØ­ modal)
    const currentLinkId = window.currentEarningsLinkId;
    if (!currentLinkId) return;
    
    try {
        setLoading(true);
        
        // Ø¬Ù„Ø¨ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª
        const visitsQuery = await db.collection('visits')
            .where('linkId', '==', currentLinkId)
            .orderBy('timestamp', 'desc')
            .get();
        
        const visits = visitsQuery.docs.map(doc => doc.data());
        
        const arabicCountries = [
            'Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©', 'Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª', 'Ù…ØµØ±', 'Ø§Ù„Ø¹Ø±Ø§Ù‚', 'Ø§Ù„Ø£Ø±Ø¯Ù†', 'Ù„Ø¨Ù†Ø§Ù†', 
            'Ø³ÙˆØ±ÙŠØ§', 'Ø§Ù„ÙƒÙˆÙŠØª', 'Ù‚Ø·Ø±', 'Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†', 'Ø¹Ù…Ø§Ù†', 'Ø§Ù„ÙŠÙ…Ù†',
            'Ø§Ù„Ù…ØºØ±Ø¨', 'Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±', 'ØªÙˆÙ†Ø³', 'Ù„ÙŠØ¨ÙŠØ§', 'Ø§Ù„Ø³ÙˆØ¯Ø§Ù†', 'Ø§Ù„ØµÙˆÙ…Ø§Ù„',
            'Ù…ÙˆØ±ÙŠØªØ§Ù†ÙŠØ§', 'Ø¬ÙŠØ¨ÙˆØªÙŠ', 'Ø¬Ø²Ø± Ø§Ù„Ù‚Ù…Ø±', 'ÙÙ„Ø³Ø·ÙŠÙ†',
            'Saudi Arabia', 'United Arab Emirates', 'Egypt', 'Iraq', 
            'Jordan', 'Lebanon', 'Syria', 'Kuwait', 'Qatar', 'Bahrain', 
            'Oman', 'Yemen', 'Morocco', 'Algeria', 'Tunisia', 'Libya', 
            'Sudan', 'Somalia', 'Mauritania', 'Djibouti', 'Comoros', 'Palestine'
        ];
        
        // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„ØªØ±
        const filteredData = filterEarningsByTime(visits, timePeriod, arabicCountries);
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚ÙŠÙ… ÙÙŠ modal
        document.getElementById('totalEarnings').textContent = `$${filteredData.totalEarnings.toFixed(2)}`;
        document.getElementById('totalImpressions').textContent = filteredData.totalVisits.toLocaleString();
        document.getElementById('arabVisits').textContent = `${filteredData.arabVisits.toLocaleString()} Ø²ÙŠØ§Ø±Ø©`;
        document.getElementById('arabEarnings').textContent = `$${filteredData.arabEarnings.toFixed(2)}`;
        document.getElementById('foreignVisits').textContent = `${filteredData.foreignVisits.toLocaleString()} Ø²ÙŠØ§Ø±Ø©`;
        document.getElementById('foreignEarnings').textContent = `$${filteredData.foreignEarnings.toFixed(2)}`;
        
        // ØªØ­Ø¯ÙŠØ« Ø£Ø´Ø±Ø·Ø© Ø§Ù„ØªÙ‚Ø¯Ù…
        const arabPercentage = filteredData.totalVisits > 0 ? (filteredData.arabVisits / filteredData.totalVisits) * 100 : 0;
        const foreignPercentage = filteredData.totalVisits > 0 ? (filteredData.foreignVisits / filteredData.totalVisits) * 100 : 0;
        
        document.getElementById('arabProgress').style.width = `${arabPercentage}%`;
        document.getElementById('foreignProgress').style.width = `${foreignPercentage}%`;
        
        // ØªØ­Ø¯ÙŠØ« Ù…ØªÙˆØ³Ø· Ø§Ù„Ø±Ø¨Ø­
        const averageRPM = filteredData.totalVisits > 0 ? (filteredData.totalEarnings / filteredData.totalVisits) * 1000 : 0;
        document.getElementById('averageRPM').textContent = `$${averageRPM.toFixed(2)}`;
        
    } catch (error) {
        console.error('Error updating filtered earnings:', error);
        showNotification('error', 'ÙØ´Ù„ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙÙ„ØªØ±Ø©');
    } finally {
        setLoading(false);
    }
}

// Create real earnings chart
async function createEarningsChart(visits, arabicCountries) {
    // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø³Ø§Ø¨Ù‚
    Chart.getChart('earningsChart')?.destroy();
    
    const ctx = document.getElementById('earningsChart');
    if (!ctx) return;
    
    // ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø­Ø³Ø¨ Ø§Ù„ÙŠÙˆÙ… (Ø¢Ø®Ø± 30 ÙŠÙˆÙ…)
    const last30Days = [];
    const earningsByDay = {};
    
    for (let i = 29; i >= 0; i--) {
        const date = new Date();
        date.setDate(date.getDate() - i);
        const dateStr = date.toISOString().split('T')[0]; // YYYY-MM-DD format
        const displayDate = date.toLocaleDateString('ar-EG', { month: 'short', day: 'numeric' });
        last30Days.push(displayDate);
        earningsByDay[dateStr] = { arab: 0, foreign: 0, total: 0 };
    }
    
    // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ù„ÙƒÙ„ ÙŠÙˆÙ…
    visits.forEach(visit => {
        const visitDate = visit.timestamp.toDate();
        const dateStr = visitDate.toISOString().split('T')[0];
        
        if (earningsByDay[dateStr]) {
            if (arabicCountries.includes(visit.country)) {
                earningsByDay[dateStr].arab += (1.00 / 1000); // $1 per 1000 visits
            } else {
                earningsByDay[dateStr].foreign += (3.00 / 1000); // $3 per 1000 visits
            }
            earningsByDay[dateStr].total = earningsByDay[dateStr].arab + earningsByDay[dateStr].foreign;
        }
    });
    
    // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
    const arabData = Object.values(earningsByDay).map(day => day.arab);
    const foreignData = Object.values(earningsByDay).map(day => day.foreign);
    const totalData = Object.values(earningsByDay).map(day => day.total);
    
    new Chart(ctx, {
        type: 'line',
        data: {
            labels: last30Days,
            datasets: [
                {
                    label: 'Ø£Ø±Ø¨Ø§Ø­ Ø¹Ø±Ø¨ÙŠØ© ($1/1000)',
                    data: arabData,
                    borderColor: '#2EC4B6',
                    backgroundColor: 'rgba(46, 196, 182, 0.1)',
                    borderWidth: 2,
                    tension: 0.3,
                    fill: false
                },
                {
                    label: 'Ø£Ø±Ø¨Ø§Ø­ Ø£Ø¬Ù†Ø¨ÙŠØ© ($3/1000)',
                    data: foreignData,
                    borderColor: '#4A154B',
                    backgroundColor: 'rgba(74, 21, 75, 0.1)',
                    borderWidth: 2,
                    tension: 0.3,
                    fill: false
                },
                {
                    label: 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­',
                    data: totalData,
                    borderColor: '#EF5A5F',
                    backgroundColor: 'rgba(239, 90, 95, 0.1)',
                    borderWidth: 3,
                    tension: 0.3,
                    fill: true
                }
            ]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    display: true,
                    position: 'top'
                },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            return `${context.dataset.label}: $${context.parsed.y.toFixed(4)}`;
                        }
                    }
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                        callback: function(value) {
                            return '$' + value.toFixed(3);
                        }
                    }
                },
                x: {
                    ticks: {
                        maxTicksLimit: 10
                    }
                }
            }
        }
    });
}
        
        // Create charts for stats
function createRealTimeCharts(visits) {
    // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
    Chart.getChart('visitsChart')?.destroy();
    Chart.getChart('geoChart')?.destroy();
    Chart.getChart('devicesChart')?.destroy();
    Chart.getChart('sourcesChart')?.destroy();
    
    // Ø±Ø³Ù… Ø¨ÙŠØ§Ù†ÙŠ Ù„Ù„Ø²ÙŠØ§Ø±Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ® (Ø¢Ø®Ø± 7 Ø£ÙŠØ§Ù…)
    const last7Days = [];
    const visitsByDay = {};
    
    for (let i = 6; i >= 0; i--) {
        const date = new Date();
        date.setDate(date.getDate() - i);
        const dateStr = date.toLocaleDateString('ar-EG');
        last7Days.push(dateStr);
        visitsByDay[dateStr] = 0;
    }
    
    visits.forEach(visit => {
        const visitDate = visit.timestamp.toDate().toLocaleDateString('ar-EG');
        if (visitsByDay.hasOwnProperty(visitDate)) {
            visitsByDay[visitDate]++;
        }
    });
    
    // Ø±Ø³Ù… Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª Ù…Ø¹ Ø§Ù„ÙˆÙ‚Øª
    const visitsCtx = document.getElementById('visitsChart');
    if (visitsCtx) {
        new Chart(visitsCtx, {
            type: 'line',
            data: {
                labels: last7Days,
                datasets: [{
                    label: 'Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª',
                    data: last7Days.map(date => visitsByDay[date]),
                    borderColor: '#4A154B',
                    backgroundColor: 'rgba(74, 21, 75, 0.1)',
                    borderWidth: 2,
                    tension: 0.3,
                    fill: true
                }]
            },
            options: {
                responsive: true,
                plugins: { legend: { display: false } },
                scales: {
                    y: { beginAtZero: true, ticks: { stepSize: 1 } }
                }
            }
        });
    }
    
    // Ø±Ø³Ù… Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ
    const countryCounts = {};
    visits.forEach(visit => {
        countryCounts[visit.country] = (countryCounts[visit.country] || 0) + 1;
    });
    
    const topCountries = Object.entries(countryCounts)
        .sort(([,a], [,b]) => b - a)
        .slice(0, 5);
    
    const geoCtx = document.getElementById('geoChart');
    if (geoCtx && topCountries.length > 0) {
        new Chart(geoCtx, {
            type: 'doughnut',
            data: {
                labels: topCountries.map(([country]) => country),
                datasets: [{
                    data: topCountries.map(([,count]) => count),
                    backgroundColor: ['#4A154B', '#EF5A5F', '#2EC4B6', '#FF9F1C', '#6C757D']
                }]
            },
            options: {
                responsive: true,
                plugins: { legend: { position: 'bottom' } }
            }
        });
    }
    
    // Ø±Ø³Ù… Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©
    const deviceCounts = {};
    visits.forEach(visit => {
        deviceCounts[visit.device] = (deviceCounts[visit.device] || 0) + 1;
    });
    
    const devicesCtx = document.getElementById('devicesChart');
    if (devicesCtx && Object.keys(deviceCounts).length > 0) {
        new Chart(devicesCtx, {
            type: 'pie',
            data: {
                labels: Object.keys(deviceCounts),
                datasets: [{
                    data: Object.values(deviceCounts),
                    backgroundColor: ['#4A154B', '#2EC4B6', '#EF5A5F', '#FF9F1C']
                }]
            },
            options: {
                responsive: true,
                plugins: { legend: { position: 'bottom' } }
            }
        });
    }
    
    // Ø±Ø³Ù… Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª
    const sourceCounts = {};
    visits.forEach(visit => {
        sourceCounts[visit.source] = (sourceCounts[visit.source] || 0) + 1;
    });
    
    const sourcesCtx = document.getElementById('sourcesChart');
    if (sourcesCtx && Object.keys(sourceCounts).length > 0) {
        new Chart(sourcesCtx, {
            type: 'bar',
            data: {
                labels: Object.keys(sourceCounts),
                datasets: [{
                    label: 'Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª',
                    data: Object.values(sourceCounts),
                    backgroundColor: '#4A154B'
                }]
            },
            options: {
                responsive: true,
                plugins: { legend: { display: false } },
                scales: { y: { beginAtZero: true, ticks: { stepSize: 1 } } }
            }
        });
    }
}

function createFilteredCharts(visits) {
    // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
    Chart.getChart('visitsChart')?.destroy();
    Chart.getChart('geoChart')?.destroy();
    Chart.getChart('devicesChart')?.destroy();
    Chart.getChart('sourcesChart')?.destroy();
    
    if (visits.length === 0) {
        ['visitsChart', 'geoChart', 'devicesChart', 'sourcesChart'].forEach(id => {
            const ctx = document.getElementById(id);
            if (ctx) {
                ctx.innerHTML = '<div class="no-data-message"><i class="fas fa-chart-bar fa-2x mb-3"></i><br>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ÙØªØ±Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©</div>';
            }
        });
        return;
    }
    
    // 1. Ø±Ø³Ù… Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª Ù…Ø¹ Ø§Ù„ÙˆÙ‚Øª
    createVisitsTimeChart(visits);
    
    // 2. Ø±Ø³Ù… Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ
    createGeoChart(visits);
    
    // 3. Ø±Ø³Ù… Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©
    createDevicesChart(visits);
    
    // 4. Ø±Ø³Ù… Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª
    createSourcesChart(visits);
}

function createVisitsTimeChart(visits) {
    const ctx = document.getElementById('visitsChart');
    if (!ctx) return;
    
    // ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ÙŠÙˆÙ…
    const visitsByDay = {};
    visits.forEach(visit => {
        const date = visit.timestamp.toDate().toDateString();
        visitsByDay[date] = (visitsByDay[date] || 0) + 1;
    });
    
    const sortedDates = Object.keys(visitsByDay).sort();
    const labels = sortedDates.map(date => new Date(date).toLocaleDateString('ar-EG', {month: 'short', day: 'numeric'}));
    const data = sortedDates.map(date => visitsByDay[date]);
    
    new Chart(ctx, {
        type: 'line',
        data: {
            labels: labels,
            datasets: [{
                label: 'Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª',
                data: data,
                borderColor: '#4A154B',
                backgroundColor: 'rgba(74, 21, 75, 0.1)',
                borderWidth: 2,
                tension: 0.3,
                fill: true
            }]
        },
        options: {
            responsive: true,
            plugins: { legend: { display: false } },
            scales: { y: { beginAtZero: true, ticks: { stepSize: 1 } } }
        }
    });
}

function createGeoChart(visits) {
    const ctx = document.getElementById('geoChart');
    if (!ctx) return;
    
    const countryCounts = {};
    visits.forEach(visit => {
        if (visit.country) {
            countryCounts[visit.country] = (countryCounts[visit.country] || 0) + 1;
        }
    });
    
    const topCountries = Object.entries(countryCounts)
        .sort(([,a], [,b]) => b - a)
        .slice(0, 5);
    
    if (topCountries.length === 0) return;
    
    new Chart(ctx, {
        type: 'doughnut',
        data: {
            labels: topCountries.map(([country]) => country),
            datasets: [{
                data: topCountries.map(([,count]) => count),
                backgroundColor: ['#4A154B', '#EF5A5F', '#2EC4B6', '#FF9F1C', '#6C757D']
            }]
        },
        options: {
            responsive: true,
            plugins: { legend: { position: 'bottom' } }
        }
    });
}

function createDevicesChart(visits) {
    const ctx = document.getElementById('devicesChart');
    if (!ctx) return;
    
    const deviceCounts = {};
    visits.forEach(visit => {
        if (visit.device) {
            deviceCounts[visit.device] = (deviceCounts[visit.device] || 0) + 1;
        }
    });
    
    if (Object.keys(deviceCounts).length === 0) return;
    
    new Chart(ctx, {
        type: 'pie',
        data: {
            labels: Object.keys(deviceCounts),
            datasets: [{
                data: Object.values(deviceCounts),
                backgroundColor: ['#4A154B', '#2EC4B6', '#EF5A5F', '#FF9F1C']
            }]
        },
        options: {
            responsive: true,
            plugins: { legend: { position: 'bottom' } }
        }
    });
}

function createSourcesChart(visits) {
    const ctx = document.getElementById('sourcesChart');
    if (!ctx) return;
    
    const sourceCounts = {};
    visits.forEach(visit => {
        if (visit.source) {
            sourceCounts[visit.source] = (sourceCounts[visit.source] || 0) + 1;
        }
    });
    
    if (Object.keys(sourceCounts).length === 0) return;
    
    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: Object.keys(sourceCounts),
            datasets: [{
                label: 'Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª',
                data: Object.values(sourceCounts),
                backgroundColor: '#4A154B'
            }]
        },
        options: {
            responsive: true,
            plugins: { legend: { display: false } },
            scales: { y: { beginAtZero: true, ticks: { stepSize: 1 } } }
        }
    });
} 
        
        // Edit link function
        async function editLink(linkId) {
            setLoading(true);
            try {
                const linkDoc = await db.collection('links').doc(linkId).get();
                
                if (linkDoc.exists) {
                    const linkData = linkDoc.data();
                    
                    // ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¨Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ø§Ø¨Ø·
                    document.getElementById('seriesName').value = linkData.seriesName;
                    document.getElementById('originalUrl').value = linkData.originalUrl;
                    document.getElementById('customDomain').value = linkData.customDomain;
                    document.getElementById('linkType').value = linkData.linkType || 'series';
                    document.getElementById('socialTitle').value = linkData.socialTitle || '';
                    document.getElementById('socialDescription').value = linkData.socialDescription || '';
                    document.getElementById('socialImage').value = linkData.socialImage || '';
                    
                    // Ø¥Ø¸Ù‡Ø§Ø± Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø³Ù„Ø³Ù„
                    if (linkData.linkType === 'series') {
                        document.getElementById('episodeCountWrapper').style.display = 'block';
                        document.getElementById('startingEpisodeWrapper').style.display = 'block';
                        document.getElementById('totalEpisodes').value = linkData.totalEpisodes || '';
                        document.getElementById('startingEpisode').value = linkData.startingEpisode || 1;
                    } else {
                        document.getElementById('episodeCountWrapper').style.display = 'none';
                        document.getElementById('startingEpisodeWrapper').style.display = 'none';
                    }
                    
                    // Set current editing link ID
                    currentEditingLinkId = linkId;
                    
                    // Show update button and hide generate button
                    updateBtn.style.display = 'block';
                    generateBtn.style.display = 'none';
                    
                    // Ù†Ù‚Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡
                    window.location.hash = 'admin';
                    window.scrollTo(0, 0);
                    
                    // Update preview
                    updateSocialPreview();
                }
            } catch (error) {
                showNotification('error', `ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø±Ø§Ø¨Ø·: ${error.message}`);
            } finally {
                setLoading(false);
            }
        }
        
        // Delete link function
        async function deleteLink(linkId) {
            setLoading(true);
            try {
                await db.collection('links').doc(linkId).delete();
                showNotification('success', 'ØªÙ… Ø­Ø°Ù Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ù†Ø¬Ø§Ø­!');
                loadLinks();
            } catch (error) {
                console.error('Error deleting link:', error);
                showNotification('error', `ÙØ´Ù„ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ø±Ø§Ø¨Ø·: ${error.message}`);
            } finally {
                setLoading(false);
            }
        }
        
        // Ø¯Ø§Ù„Ø© Ù„Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©
        async function loadAnalytics() {
            try {
                const statsDoc = await db.collection('stats').doc('global').get();
                const stats = statsDoc.data() || {};
                
                document.getElementById('totalLinksStat').textContent = 
                    (stats.totalLinks || 25000).toLocaleString() + '+';
                
                document.getElementById('totalClicksStat').textContent = 
                    (stats.totalClicks || 1200000).toLocaleString() + '+';
                
                document.getElementById('todayClicksStat').textContent = 
                    (stats.todayClicks || 1245).toLocaleString();
                
                document.getElementById('uptimeStat').textContent = 
                    (stats.uptime || 99.9).toFixed(1) + '%';
            } catch (error) {
                console.error('Error loading live stats:', error);
            }
        }

        // Firebase Authentication
        function initAuth() {
            auth.onAuthStateChanged(async (user) => {
                if (user) {
                    // User is signed in
                    userProfile.style.display = 'flex';
                    authButtons.style.display = 'none';
                    
                    // Set user info
                    userPhoto.src = user.photoURL || 'https://via.placeholder.com/40';
                    userName.textContent = user.displayName || 'Ù…Ø³ØªØ®Ø¯Ù…';
                    
                    // Show welcome notification
                    showNotification('success', `Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ø¹ÙˆØ¯ØªÙƒØŒ ${user.displayName || 'Ù…Ø³ØªØ®Ø¯Ù…'}!`, 4000);
                    
                    // Set first user as admin
                    await setFirstUserAsAdmin(user);
                    
                    // Show admin panel if on admin page
                    if (window.location.hash === '#admin') {
                        showAdminPanel();
                    }
                    
                    // Load live statistics
                    loadLiveStats();
                } else {
                    // User is signed out
                    userProfile.style.display = 'none';
                    authButtons.style.display = 'block';
                    
                    // Hide admin panel
                    if (window.location.hash === '#admin') {
                        hideAllPanels();
                        showFeatures();
                        initModernNavigation();
                    }
                }
            });
            
            // Sign in with Google
            signInButton.addEventListener('click', async () => {
                try {
                    const provider = new firebase.auth.GoogleAuthProvider();
                    const result = await auth.signInWithPopup(provider);
                    showNotification('success', `ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„Ùƒ Ø¨Ù†Ø¬Ø§Ø­ØŒ Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ${result.user.displayName || 'Ù…Ø³ØªØ®Ø¯Ù…'}!`);
                } catch (error) {
                    showNotification('error', `ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„: ${error.message}`);
                }
            });
            
            // Sign out
            signOutButton.addEventListener('click', () => {
                auth.signOut();
                showNotification('info', 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬Ùƒ Ø¨Ù†Ø¬Ø§Ø­');
            });
        }
        
        // Set first user as admin
        async function setFirstUserAsAdmin(user) {
            const usersRef = db.collection('users');
            
            try {
                const usersSnapshot = await usersRef.get();
                
                if (usersSnapshot.empty) {
                    // This is the first user, set as admin
                    await usersRef.doc(user.uid).set({
                        uid: user.uid,
                        email: user.email,
                        displayName: user.displayName,
                        photoURL: user.photoURL,
                        isAdmin: true,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    showNotification('success', 'ØªÙ… ØªØ¹ÙŠÙŠÙ†Ùƒ ÙƒÙ…Ø³Ø¤ÙˆÙ„ Ù„Ù„Ù…Ù†ØµØ©!');
                    // Show admin-only elements
                    adminOnlyElements.forEach(el => {
                        el.style.display = 'block';
                    });
                } else {
                    // Check if user is admin
                    const userDoc = await usersRef.doc(user.uid).get();
                    if (userDoc.exists && userDoc.data().isAdmin) {
                        // Show admin-only elements
                        adminOnlyElements.forEach(el => {
                            el.style.display = 'block';
                        });
                    } else {
                        // Hide admin-only elements for non-admin users
                        adminOnlyElements.forEach(el => {
                            el.style.display = 'none';
                        });
                    }
                }
            } catch (error) {
                console.error('Error setting admin:', error);
            }
        }
        
        // Load live statistics
        async function loadLiveStats() {
            try {
                const statsDoc = await db.collection('stats').doc('global').get();
                const stats = statsDoc.data() || {};
                
                document.getElementById('totalLinksStat').textContent = 
                    (stats.totalLinks || 25000).toLocaleString() + '+';
                
                document.getElementById('totalClicksStat').textContent = 
                    (stats.totalClicks || 1200000).toLocaleString() + '+';
                
                document.getElementById('todayClicksStat').textContent = 
                    (stats.todayClicks || 1245).toLocaleString();
                
                document.getElementById('uptimeStat').textContent = 
                    (stats.uptime || 99.9).toFixed(1) + '%';
            } catch (error) {
                console.error('Error loading live stats:', error);
            }
        }
        
        // Update social media preview
        function updateSocialPreview() {
            const title = document.getElementById('socialTitle').value || 'Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø­ØªÙˆÙ‰';
            const description = document.getElementById('socialDescription').value || 'ÙˆØµÙ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø°ÙŠ Ø³ÙŠØ¸Ù‡Ø± Ø¹Ù„Ù‰ Ù…Ù†ØµØ§Øª Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ';
            const image = document.getElementById('socialImage').value || 'https://via.placeholder.com/500x300/4A154B/FFFFFF?text=ØµÙˆØ±Ø©+Ø§Ù„Ù…Ø­ØªÙˆÙ‰';
            const domain = document.getElementById('customDomain').value || 'turkify.com';
            
            document.getElementById('previewTitle').textContent = title;
            document.getElementById('previewDescription').textContent = description;
            document.getElementById('previewImage').src = image;
            document.getElementById('previewDomain').textContent = domain;
        }
        
        // Show confirmation modal
        function showConfirmation(message, callback) {
            const modal = new bootstrap.Modal(document.getElementById('confirmationModal'));
            document.getElementById('confirmationMessage').textContent = message;
            document.getElementById('confirmActionBtn').onclick = function() {
                callback();
                modal.hide();
            };
            modal.show();
        }
        
        // Navigation event listeners
        document.getElementById('adminLink').addEventListener('click', function(e) {
            e.preventDefault();
            window.location.hash = 'admin';
            highlightActiveNav();
            if (auth.currentUser) {
                showAdminPanel();
            } else {
                showFeatures();
            }
            window.scrollTo(0, 0);
        });
        
        document.getElementById('statsLink').addEventListener('click', function(e) {
            e.preventDefault();
            window.location.hash = 'analytics';
            highlightActiveNav();
            showAnalytics();
            window.scrollTo(0, 0);
        });
        
        document.getElementById('featuresLink').addEventListener('click', function(e) {
            e.preventDefault();
            window.location.hash = 'features';
            highlightActiveNav();
            showFeatures();
            window.scrollTo(0, 0);
        });
        
        document.getElementById('homeLink').addEventListener('click', function(e) {
            e.preventDefault();
            window.location.hash = '';
            highlightActiveNav();
            showFeatures();
            window.scrollTo(0, 0);
        });
        
        // Handle hash changes
        window.addEventListener('hashchange', function() {
            initPage();
        });
        
        // Share link function
        document.getElementById('shareLinkBtn').addEventListener('click', function() {
            const link = document.getElementById('generatedLink').value;
            
            if (navigator.share) {
                navigator.share({
                    title: 'Ø±Ø§Ø¨Ø· Ù‚ØµÙŠØ± Ù…Ù† Turkify Pro',
                    text: 'ØªØ­Ù‚Ù‚ Ù…Ù† Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù‚ØµÙŠØ± Ø§Ù„Ø°ÙŠ Ø£Ù†Ø´Ø£ØªÙ‡ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Turkify Pro',
                    url: link
                }).then(() => {
                    showNotification('success', 'ØªÙ… Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ù†Ø¬Ø§Ø­!');
                }).catch(error => {
                    console.error('Error sharing:', error);
                    copyToClipboard();
                    showNotification('info', 'ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©');
                });
            } else {
                copyToClipboard();
                showNotification('success', 'ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©');
            }
        });
        
        // View analytics function
        document.getElementById('viewAnalyticsBtn').addEventListener('click', function() {
            const modal = bootstrap.Modal.getInstance(document.getElementById('linkModal'));
            modal.hide();
            window.location.hash = 'analytics';
            highlightActiveNav();
            showAnalytics();
            window.scrollTo(0, 0);
        });
        
        // Copy link button
        document.getElementById('copyLinkBtn').addEventListener('click', copyToClipboard);
        
        // Social media preview updates
        document.getElementById('socialTitle').addEventListener('input', updateSocialPreview);
        document.getElementById('socialDescription').addEventListener('input', updateSocialPreview);
        document.getElementById('socialImage').addEventListener('input', updateSocialPreview);
        
        // Toggle episode count field based on content type
        document.getElementById('linkType').addEventListener('change', function() {
            const selectedType = this.value;
            const episodeWrapper = document.getElementById('episodeCountWrapper');
            const startingEpisodeWrapper = document.getElementById('startingEpisodeWrapper');
            if (selectedType === 'series') {
                episodeWrapper.style.display = 'block';
                startingEpisodeWrapper.style.display = 'block';
            } else {
                episodeWrapper.style.display = 'none';
                startingEpisodeWrapper.style.display = 'none';
            }
        });
        
        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            initPage();
            initAuth();
            updateSocialPreview();
            
            // Set up button event listeners
            generateBtn.addEventListener('click', generateLink);
            updateBtn.addEventListener('click', updateLink);
        });
        
        // Ù…Ø±Ø§Ù‚Ø¨ Ù„Ø¶Ù…Ø§Ù† Ø¸Ù‡ÙˆØ± Ø§Ù„Ù…Ø­ØªÙˆÙ‰
document.addEventListener('DOMContentLoaded', function() {
    // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù‚Ø³Ø±ÙŠ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    forceShowElements();
    
    // Ù…Ø±Ø§Ù‚Ø¨Ø© ØªØºÙŠÙŠØ±Ø§Øª DOM
    const observer = new MutationObserver(function(mutations) {
        mutations.forEach(function(mutation) {
            if (mutation.type === 'childList' || mutation.type === 'attributes') {
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø­ØªÙˆÙ‰ ÙˆØ¥Ø¸Ù‡Ø§Ø±Ù‡Ø§
                const contentElements = [
                    'contentCard',
                    'contentThumbnail',
                    'contentTitle', 
                    'contentDescription',
                    'contentType'
                ];
                
                contentElements.forEach(id => {
                    const element = document.getElementById(id);
                    if (element && element.style.display === 'none') {
                        element.style.display = element.tagName === 'IMG' ? 'block' : 
                                               element.classList.contains('content-meta') ? 'flex' : 'block';
                        element.style.visibility = 'visible';
                        element.style.opacity = '1';
                    }
                });
            }
        });
    });
    
    // Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©
    observer.observe(document.body, {
        childList: true,
        subtree: true,
        attributes: true,
        attributeFilter: ['style', 'class']
    });
    
    console.log('ØªÙ… ØªÙØ¹ÙŠÙ„ Ù…Ø±Ø§Ù‚Ø¨ Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­ØªÙˆÙ‰');
});

// Ø¯Ø§Ù„Ø© Ù„Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø¯ÙˆØ±ÙŠ Ù…Ù† Ø¸Ù‡ÙˆØ± Ø§Ù„Ø¹Ù†Ø§ØµØ±
function periodicVisibilityCheck() {
    const urlParams = new URLSearchParams(window.location.search);
    const linkId = urlParams.get('id');
    
    if (linkId) {
        const checkInterval = setInterval(() => {
            showContentCard();
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙˆØ±Ø©
            const thumbnail = document.getElementById('contentThumbnail');
            if (thumbnail && !thumbnail.src.includes('placeholder')) {
                ensureImageVisibility(thumbnail);
            }
            
            // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØ­Ù‚Ù‚ Ø¨Ø¹Ø¯ 10 Ø«ÙˆØ§Ù†
            setTimeout(() => {
                clearInterval(checkInterval);
            }, 10000);
        }, 1000);
    }
}

// ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø¯ÙˆØ±ÙŠ
periodicVisibilityCheck();
        
        // Ù…Ø¹Ø§Ù„Ø¬Ø§Øª Ø£Ø­Ø¯Ø§Ø« Ø§Ù„ÙÙ„ØªØ±Ø©
document.addEventListener('DOMContentLoaded', function() {
    // Ù…Ø¹Ø§Ù„Ø¬ dropdown Ø§Ù„ÙÙ„ØªØ±Ø©
    document.addEventListener('change', function(e) {
        if (e.target && e.target.id === 'timeRangeSelect') {
            const selectedRange = e.target.value;
            applyTimeFilter(selectedRange);
            updateQuickButtons(selectedRange);
            updateFilterText(selectedRange);
        }
    });
    
    // Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø³Ø±ÙŠØ¹Ø©
    document.addEventListener('click', function(e) {
        if (e.target && e.target.classList.contains('time-quick-btn')) {
            e.preventDefault();
            const range = e.target.dataset.range;
            
            // ØªØ­Ø¯ÙŠØ« dropdown
            const select = document.getElementById('timeRangeSelect');
            if (select) select.value = range;
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„ØªØ±
            applyTimeFilter(range);
            updateQuickButtons(range);
            updateFilterText(range);
        }
    });
});

async function applyTimeFilter(timeRange) {
    if (!window.currentStatsLinkId) return;
    
    try {
        setLoading(true);
        
        // Ø¬Ù„Ø¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª
        const visitsQuery = await db.collection('visits')
            .where('linkId', '==', window.currentStatsLinkId)
            .orderBy('timestamp', 'desc')
            .get();
        
        const allVisits = visitsQuery.docs.map(doc => doc.data());
        
        // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„ØªØ±
        const filteredVisits = filterVisitsByTimeRange(allVisits, timeRange);
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        updateStatsDisplay(filteredVisits);
        
        // Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ©
        createFilteredCharts(filteredVisits);
        
        // ØªØ­Ø¯ÙŠØ« ÙˆÙ‚Øª Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«
        document.getElementById('lastUpdateTime').textContent = new Date().toLocaleTimeString('ar-EG');
        
    } catch (error) {
        console.error('Error applying filter:', error);
        showNotification('error', 'ÙØ´Ù„ ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„ØªØ±');
    } finally {
        setLoading(false);
    }
}

function updateQuickButtons(activeRange) {
    document.querySelectorAll('.time-quick-btn').forEach(btn => {
        btn.classList.remove('active');
        if (btn.dataset.range === activeRange) {
            btn.classList.add('active');
        }
    });
}

function updateFilterText(timeRange) {
    const filterText = document.getElementById('activeFilterText');
    if (filterText) {
        filterText.textContent = getFilterText(timeRange);
    }
} 

// Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ù…ØªØ·ÙˆØ± Ù…Ø¹ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
function initModernNavigation() {
    // ØªØ­Ø¯ÙŠØ« Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„ Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
    auth.onAuthStateChanged(async (user) => {
        updateNavbarVisibility(user);
        if (user) {
            await updateUserStats(user);
            setUserRole(user);
        }
    });
    
    // Ù…Ø¹Ø§Ù„Ø¬Ø§Øª Ø£Ø­Ø¯Ø§Ø« Ø§Ù„ØªÙ†Ù‚Ù„
    setupNavigationHandlers();
}

function updateNavbarVisibility(user) {
    const userOnlyElements = document.querySelectorAll('.user-only');
    const adminOnlyElements = document.querySelectorAll('.admin-only');
    
    if (user) {
        userOnlyElements.forEach(el => el.style.display = 'block');
        updateUserProfile(user);
    } else {
        userOnlyElements.forEach(el => el.style.display = 'none');
        adminOnlyElements.forEach(el => el.style.display = 'none');
    }
}

async function setUserRole(user) {
    try {
        const userDoc = await db.collection('users').doc(user.uid).get();
        const isAdmin = userDoc.exists && userDoc.data().isAdmin;
        
        const roleElement = document.getElementById('userRole');
        const adminElements = document.querySelectorAll('.admin-only');
        
        if (isAdmin) {
            roleElement.textContent = 'Ù…Ø´Ø±Ù';
            adminElements.forEach(el => el.style.display = 'block');
        } else {
            roleElement.textContent = 'Ø¹Ø¶Ùˆ';
            adminElements.forEach(el => el.style.display = 'none');
        }
    } catch (error) {
        console.error('Error checking admin status:', error);
    }
}

function updateUserProfile(user) {
    document.getElementById('userPhoto').src = user.photoURL || 'https://via.placeholder.com/35';
    document.getElementById('userDisplayName').textContent = user.displayName || 'Ù…Ø³ØªØ®Ø¯Ù…';
    document.getElementById('userProfile').style.display = 'flex';
    document.getElementById('authButtons').style.display = 'none';
}

async function updateUserStats(user) {
    try {
        // Ø¹Ø¯Ø¯ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·
        const linksQuery = await db.collection('links').where('userId', '==', user.uid).get();
        const linkCount = linksQuery.size;
        document.getElementById('userLinksBadge').textContent = linkCount;
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù†Ù‚Ø±Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
        const hasNewClicks = await checkNewClicks(user.uid);
        const newClicksBadge = document.getElementById('newClicksBadge');
        if (hasNewClicks) {
            newClicksBadge.style.display = 'inline-block';
        }
        
    } catch (error) {
        console.error('Error updating user stats:', error);
    }
}

async function checkNewClicks(userId) {
    try {
        const oneDayAgo = new Date(Date.now() - 24 * 60 * 60 * 1000);
        const recentVisits = await db.collection('visits')
            .where('timestamp', '>=', oneDayAgo)
            .limit(1)
            .get();
        
        return !recentVisits.empty;
    } catch (error) {
        return false;
    }
}

function setupNavigationHandlers() {
    // Ù…Ø¹Ø§Ù„Ø¬ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
    document.getElementById('dashboardLink')?.addEventListener('click', function(e) {
        e.preventDefault();
        navigateToSection('dashboard');
    });
    
    // Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª
    document.getElementById('analyticsNavLink')?.addEventListener('click', function(e) {
        e.preventDefault();
        navigateToSection('analytics');
    });
    
    // Ù…Ø¹Ø§Ù„Ø¬ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±ÙˆØ§Ø¨Ø·
    document.getElementById('adminNavLink')?.addEventListener('click', function(e) {
        e.preventDefault();
        navigateToSection('admin');
    });
    
    // Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
    document.getElementById('superAdminLink')?.addEventListener('click', function(e) {
        e.preventDefault();
        navigateToSection('super-admin');
    });
}

function navigateToSection(section) {
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‡Ø§Ø´
    window.location.hash = section;
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù†Ø´Ø·Ø©
    updateActiveNavLink(section);
    
    // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ù…Ù†Ø§Ø³Ø¨
    switch(section) {
        case 'dashboard':
            showDashboard();
            break;
        case 'analytics':
            showAnalytics();
            break;
        case 'admin':
            showAdminPanel();
            break;
        case 'super-admin':
            showSuperAdminPanel();
            break;
        default:
            showFeatures();
    }
    
    window.scrollTo(0, 0);
}

function updateActiveNavLink(activeSection) {
    document.querySelectorAll('.nav-link-modern').forEach(link => {
        link.classList.remove('nav-active');
    });
    
    const activeLink = document.querySelector(`[href="#${activeSection}"]`);
    if (activeLink) {
        activeLink.classList.add('nav-active');
    }
}

function showDashboard() {
    hideAllPanels();
    // Ø¥Ù†Ø´Ø§Ø¡ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø´Ø®ØµÙŠØ©
    createUserDashboard();
}

function createUserDashboard() {
    const container = document.querySelector('.container.my-5.pt-5');
    container.innerHTML = `
        <div class="dashboard-container">
            <div class="row">
                <div class="col-12 mb-4">
                    <h2 class="dashboard-title">
                        <i class="fas fa-tachometer-alt me-2"></i>
                        Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø´Ø®ØµÙŠØ©
                    </h2>
                </div>
            </div>
            
            <div class="row">
                <div class="col-md-3 mb-4">
                    <div class="stat-card">
                        <div class="stat-number" id="dashTotalLinks">0</div>
                        <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·</div>
                    </div>
                </div>
                <div class="col-md-3 mb-4">
                    <div class="stat-card">
                        <div class="stat-number" id="dashTotalClicks">0</div>
                        <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‚Ø±Ø§Øª</div>
                    </div>
                </div>
                <div class="col-md-3 mb-4">
                    <div class="stat-card">
                        <div class="stat-number" id="dashTodayClicks">0</div>
                        <div class="stat-label">Ù†Ù‚Ø±Ø§Øª Ø§Ù„ÙŠÙˆÙ…</div>
                    </div>
                </div>
                <div class="col-md-3 mb-4">
                    <div class="stat-card">
                        <div class="stat-number" id="dashActiveLinks">0</div>
                        <div class="stat-label">Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù†Ø´Ø·Ø©</div>
                    </div>
                </div>
            </div>
            
            <div class="row">
                <div class="col-md-8">
                    <div class="card">
                        <div class="card-header">Ø£ÙØ¶Ù„ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø£Ø¯Ø§Ø¡Ù‹</div>
                        <div class="card-body" id="topLinksChart"></div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-header">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø©</div>
                        <div class="card-body">
                            <button class="btn btn-primary w-100 mb-2" onclick="navigateToSection('admin')">
                                <i class="fas fa-plus me-2"></i>Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø· Ø¬Ø¯ÙŠØ¯
                            </button>
                            <button class="btn btn-outline-primary w-100 mb-2" onclick="navigateToSection('analytics')">
                                <i class="fas fa-chart-bar me-2"></i>Ø¹Ø±Ø¶ Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `;
    
    loadDashboardData();
}

async function loadDashboardData() {
    const user = auth.currentUser;
    if (!user) return;
    
    try {
        const linksQuery = await db.collection('links').where('userId', '==', user.uid).get();
        const links = linksQuery.docs.map(doc => ({ id: doc.id, ...doc.data() }));
        
        let totalClicks = 0;
        let activeLinks = 0;
        
        links.forEach(link => {
            totalClicks += link.clicks || 0;
            if ((link.clicks || 0) > 0) activeLinks++;
        });
        
        document.getElementById('dashTotalLinks').textContent = links.length;
        document.getElementById('dashTotalClicks').textContent = totalClicks.toLocaleString();
        document.getElementById('dashActiveLinks').textContent = activeLinks;
        
        // Ø­Ø³Ø§Ø¨ Ù†Ù‚Ø±Ø§Øª Ø§Ù„ÙŠÙˆÙ…
        const todayClicks = await getTodayClicks(user.uid);
        document.getElementById('dashTodayClicks').textContent = todayClicks;
        
    } catch (error) {
        console.error('Error loading dashboard data:', error);
    }
}

async function getTodayClicks(userId) {
    try {
        const today = new Date();
        const startOfDay = new Date(today.getFullYear(), today.getMonth(), today.getDate());
        
        const userLinks = await db.collection('links').where('userId', '==', userId).get();
        const linkIds = userLinks.docs.map(doc => doc.id);
        
        if (linkIds.length === 0) return 0;
        
        const todayVisits = await db.collection('visits')
            .where('linkId', 'in', linkIds.slice(0, 10))
            .where('timestamp', '>=', startOfDay)
            .get();
        
        return todayVisits.size;
    } catch (error) {
        return 0;
    }
}

function showSuperAdminPanel() {
    hideAllPanels();
    // Ø¥Ù†Ø´Ø§Ø¡ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
    const container = document.querySelector('.container.my-5.pt-5');
    container.innerHTML = `
        <div class="super-admin-panel">
            <h2><i class="fas fa-crown me-2"></i>Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</h2>
            <div class="alert alert-warning">
                <i class="fas fa-exclamation-triangle me-2"></i>
                Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… Ù…Ø®ØµØµ Ù„Ù„Ù…Ø´Ø±ÙÙŠÙ† ÙÙ‚Ø·
            </div>
        </div>
    `;
}

// ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
document.addEventListener('DOMContentLoaded', function() {
    initModernNavigation();
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ†Ù‚Ù„ Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ù‡Ø§Ø´
    window.addEventListener('hashchange', function() {
        const section = window.location.hash.substring(1);
        if (section) {
            updateActiveNavLink(section);
        }
    });
});
    </script>
</body>
</html>
