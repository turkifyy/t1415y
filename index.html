<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="ŸÖŸÜÿµÿ© ŸÖÿ™ŸÇÿØŸÖÿ© ŸÑÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ±Ÿàÿßÿ®ÿ∑ ŸÖÿπ ÿ™ÿ≠ŸÑŸäŸÑÿßÿ™ ŸàŸÜÿ∑ÿßŸÇÿßÿ™ ŸÖÿÆÿµÿµÿ© ŸàŸÖŸäÿ≤ÿßÿ™ ŸÖÿ™ÿ∑Ÿàÿ±ÿ©">
    <meta name="keywords" content="ÿ™ŸÇÿµŸäÿ± ÿßŸÑÿ±Ÿàÿßÿ®ÿ∑, ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ±Ÿàÿßÿ®ÿ∑, ÿ™ÿ≠ŸÑŸäŸÑÿßÿ™, ÿ™ÿ≥ŸàŸäŸÇ ÿ±ŸÇŸÖŸä">
    <title>Turkify Pro - ŸÖŸÜÿµÿ© ŸÖÿ™ŸÇÿØŸÖÿ© ŸÑÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ±Ÿàÿßÿ®ÿ∑</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-purple: #4A154B;
            --secondary-red: #EF5A5F;
            --accent-teal: #2EC4B6;
            --light-gray: #f8f9fa;
            --dark-gray: #343a40;
            --gradient-start: #6a11cb;
            --gradient-end: #2575fc;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Tajawal', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, var(--light-gray) 0%, #eef2f5 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            color: #333;
            line-height: 1.8;
        }
        
        .navbar {
            background: linear-gradient(90deg, var(--primary-purple) 0%, #5d1d63 100%);
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            padding: 0.8rem 0;
        }
        
        .logo {
            font-weight: 700;
            color: white;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo span {
            color: var(--secondary-red);
        }
        
        .logo-icon {
            background: var(--secondary-red);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .navbar-toggler {
            border: none;
            outline: none;
            box-shadow: none;
        }
        
        .nav-link {
            padding: 0.5rem 1rem;
            transition: all 0.3s;
            display: flex;
            align-items: center;
        }
        
        .nav-link:hover {
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
        }
        
        .navbar-collapse {
            justify-content: flex-end;
        }
        
        .card {
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            border: none;
            margin-bottom: 30px;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            overflow: hidden;
            background: white;
        }
        
        .card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }
        
        .card-header {
            background: linear-gradient(90deg, var(--primary-purple) 0%, #5d1d63 100%);
            color: white;
            font-weight: 600;
            border-radius: 16px 16px 0 0 !important;
            padding: 1.2rem 1.5rem;
            font-size: 1.1rem;
        }
        
        .btn-primary {
            background: linear-gradient(90deg, var(--primary-purple) 0%, #5d1d63 100%);
            border: none;
            padding: 0.8rem 1.8rem;
            font-weight: 500;
            border-radius: 12px;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            background: linear-gradient(90deg, #3a1043 0%, #4a154b 100%);
            transform: translateY(-2px);
            box-shadow: 0 7px 15px rgba(74, 21, 75, 0.3);
        }
        
        .btn-danger {
            background: linear-gradient(90deg, var(--secondary-red) 0%, #e94348 100%);
            border: none;
            padding: 0.8rem 1.8rem;
            font-weight: 500;
            border-radius: 12px;
            transition: all 0.3s ease;
        }
        
        .btn-danger:hover {
            background: linear-gradient(90deg, #d93439 0%, #e94348 100%);
            transform: translateY(-2px);
            box-shadow: 0 7px 15px rgba(239, 90, 95, 0.3);
        }
        
        .form-control, .form-select {
            border: 2px solid #eaeaea;
            border-radius: 12px;
            padding: 0.8rem 1.2rem;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: var(--accent-teal);
            box-shadow: 0 0 0 0.25rem rgba(46, 196, 182, 0.2);
        }
        
        .stat-card {
            text-align: center;
            padding: 25px 20px;
            border-radius: 16px;
            background: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        
        .stat-number {
            font-size: 2.8rem;
            font-weight: 700;
            background: linear-gradient(90deg, var(--primary-purple) 0%, var(--accent-teal) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 10px 0;
        }
        
        .stat-label {
            font-size: 1.1rem;
            color: var(--dark-gray);
            font-weight: 500;
        }
        
        .link-card {
            border-left: 4px solid var(--accent-teal);
            transition: all 0.3s ease;
        }
        
        .link-card:hover {
            border-left: 4px solid var(--secondary-red);
        }
        
        .link-url {
            font-size: 0.95rem;
            color: #6c757d;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .short-url {
            color: var(--primary-purple);
            font-weight: 600;
            transition: color 0.3s;
        }
        
        .short-url:hover {
            color: var(--accent-teal);
            text-decoration: none;
        }
        
        .clicks-badge {
            background: linear-gradient(90deg, var(--secondary-red) 0%, #e94348 100%);
            padding: 0.4rem 0.8rem;
            border-radius: 50px;
            font-weight: 500;
        }
        
        .loader {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-top: 4px solid var(--accent-teal);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 30px auto;
            display: none;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .redirect-container {
            max-width: 700px;
            margin: 80px auto;
            text-align: center;
            padding: 40px;
            border-radius: 20px;
            background: white;
            box-shadow: 0 15px 50px rgba(0,0,0,0.1);
        }
        
        .redirect-icon {
            font-size: 5rem;
            background: linear-gradient(90deg, var(--primary-purple) 0%, var(--accent-teal) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 25px;
        }
        
        .redirect-btn {
            margin-top: 30px;
            padding: 0.8rem 2.5rem;
            border-radius: 12px;
            font-weight: 500;
        }
        
        .admin-only {
            display: none;
        }
        
        .action-buttons .btn {
            margin-right: 8px;
            border-radius: 10px;
            padding: 0.5rem 0.9rem;
        }
        
        .table-responsive {
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .table th {
            background: linear-gradient(90deg, var(--primary-purple) 0%, #5d1d63 100%);
            color: white;
            font-weight: 500;
            padding: 1.1rem 1.5rem;
        }
        
        .table td {
            padding: 1.1rem 1.5rem;
            vertical-align: middle;
        }
        
        .feature-icon {
            width: 70px;
            height: 70px;
            border-radius: 20px;
            background: rgba(74, 21, 75, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 30px;
            color: var(--primary-purple);
        }
        
        .hero-section {
            background: linear-gradient(135deg, var(--gradient-start) 0%, var(--gradient-end) 100%);
            color: white;
            padding: 100px 0 80px;
            border-radius: 0 0 30px 30px;
            margin-bottom: -50px;
            position: relative;
            overflow: hidden;
        }
        
        .custom-shape {
            position: absolute;
            width: 150px;
            height: 150px;
            background: linear-gradient(135deg, var(--accent-teal) 0%, rgba(46, 196, 182, 0.3) 100%);
            border-radius: 40% 60% 70% 30% / 40% 50% 60% 50%;
            z-index: 0;
        }
        
        .shape-1 {
            top: 10%;
            left: 5%;
            animation: float 8s infinite ease-in-out;
        }
        
        .shape-2 {
            bottom: 15%;
            right: 7%;
            width: 120px;
            height: 120px;
            animation: float 10s infinite ease-in-out;
            animation-delay: 1s;
        }
        
        @keyframes float {
            0% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(10deg); }
            100% { transform: translateY(0) rotate(0deg); }
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 12px;
            color: white;
            font-weight: 500;
            z-index: 1000;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transform: translateX(200%);
            transition: transform 0.4s ease;
            display: none;
        }
        
        .notification.show {
            transform: translateX(0);
            display: block;
        }
        
        .notification.success {
            background: linear-gradient(90deg, #2EC4B6 0%, #20bfa9 100%);
        }
        
        .notification.error {
            background: linear-gradient(90deg, #EF5A5F 0%, #e94348 100%);
        }
        
        .notification.info {
            background: linear-gradient(90deg, #4A154B 0%, #5d1d63 100%);
        }
        
        .progress-bar {
            height: 5px;
            background: rgba(255,255,255,0.5);
            width: 100%;
            margin-top: 10px;
            border-radius: 3px;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background: white;
            width: 100%;
            animation: progress 3s linear forwards;
        }
        
        @keyframes progress {
            0% { width: 100%; }
            100% { width: 0%; }
        }
        
        .modal-content {
            border-radius: 20px;
            overflow: hidden;
            border: none;
            box-shadow: 0 20px 50px rgba(0,0,0,0.2);
        }
        
        .modal-header {
            background: linear-gradient(90deg, var(--primary-purple) 0%, #5d1d63 100%);
            color: white;
        }
        
        .device-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .device-desktop {
            background: rgba(74, 21, 75, 0.1);
            color: var(--primary-purple);
        }
        
        .device-mobile {
            background: rgba(46, 196, 182, 0.1);
            color: var(--accent-teal);
        }
        
        .device-tablet {
            background: rgba(239, 90, 95, 0.1);
            color: var(--secondary-red);
        }
        
        .country-flag {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            margin-right: 10px;
            object-fit: cover;
        }
        
        .stats-card {
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            background: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .nav-active {
            background: rgba(255,255,255,0.2);
            border-radius: 8px;
        }
        
        .table-loader {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
        }
        
        .qr-code-container {
            text-align: center;
            margin: 20px 0;
        }
        
        #qrcode {
            display: inline-block;
            padding: 10px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .platform-stat {
            text-align: center;
            padding: 15px;
        }
        
        .link-type-badge {
            padding: 5px 10px;
            border-radius: 8px;
            font-size: 0.8rem;
            font-weight: 500;
            display: inline-block;
        }
        
        .type-series { background-color: rgba(74, 21, 75, 0.1); color: var(--primary-purple); }
        .type-movie { background-color: rgba(46, 196, 182, 0.1); color: var(--accent-teal); }
        .type-match { background-color: rgba(239, 90, 95, 0.1); color: var(--secondary-red); }
        .type-recipe { background-color: rgba(255, 193, 7, 0.1); color: #ff9800; }
        .type-game { background-color: rgba(63, 81, 181, 0.1); color: #3f51b5; }
        .type-app { background-color: rgba(76, 175, 80, 0.1); color: #4caf50; }
        .type-channel { background-color: rgba(156, 39, 176, 0.1); color: #9c27b0; }
        .type-reels { background-color: rgba(233, 30, 99, 0.1); color: #e91e63; }
        
        .social-preview {
            border-radius: 12px;
            border: 1px solid #eaeaea;
            padding: 15px;
            margin: 20px 0;
            background: white;
            max-width: 500px;
        }
        
        .social-preview-img {
            width: 100%;
            height: 250px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .stats-card {
            border-radius: 12px;
            padding: 20px;
            background: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .stats-card-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--primary-purple);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .stats-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--accent-teal);
            text-align: center;
        }
        
        .stats-chart {
            height: 250px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .redirect-content {
            max-width: 800px;
            margin: 0 auto;
            padding: 30px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .redirect-thumbnail {
            width: 100%;
            height: 350px;
            object-fit: cover;
            border-radius: 12px;
            margin: 20px 0;
            z-index: 999999;
        }
        
        .redirect-title {
            font-size: 2rem;
            font-weight: 700;
            margin: 20px 0;
            color: var(--primary-purple);
        }
        
        .redirect-description {
            font-size: 1.1rem;
            line-height: 1.7;
            color: #555;
            margin-bottom: 30px;
        }
        
        .netflix-style {
            background: #141414;
            color: white;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
        }
        
        .netflix-style .redirect-thumbnail {
            border-radius: 0;
            height: 400px;
        }
        
        .netflix-gradient {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 150px;
            background: linear-gradient(transparent, #141414);
        }
        
        .netflix-content {
            position: relative;
            z-index: 10;
            padding: 30px;
        }
        
        /* ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ÿ•ŸÖŸÉÿßŸÜŸäÿ© ÿßŸÑŸàÿµŸàŸÑ */
        .btn:focus, .form-control:focus {
            outline: 3px solid rgba(46, 196, 182, 0.5);
            outline-offset: 2px;
        }
        
        /* ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑŸÖÿ™ÿ£ÿÆÿ± */
        img[loading] {
            transition: opacity 0.3s;
        }
        
        img[loading="lazy"] {
            opacity: 0;
        }
        
        img[loading="lazy"][data-loaded] {
            opacity: 1;
        }
        
        /* ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ÿßŸÑÿ™ÿ®ÿßŸäŸÜ ŸÑŸÑÿ£ŸÑŸàÿßŸÜ */
        .card-header, .btn-primary, .btn-danger, .clicks-badge {
            color: white !important;
        }
        
        .stat-label {
            color: #333;
            background: rgba(255,255,255,0.7);
            padding: 5px;
            border-radius: 8px;
        }
        
              /* ÿ•ÿµŸÑÿßÿ≠ ÿ®ÿ∑ÿßŸÇÿ© ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ */
.content-card {
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    transition: all 0.3s ease;
    background: #fff;
    margin: 20px 0;
    display: block !important; /* ŸÅÿ±ÿ∂ ÿßŸÑÿ∏ŸáŸàÿ± */
    visibility: visible !important;
}

.content-thumbnail {
    width: 100%;
    height: 300px;
    object-fit: cover;
    border-radius: 0;
    display: block !important;
    visibility: visible !important;
    background: #f8f9fa; /* ŸÑŸàŸÜ ÿÆŸÑŸÅŸäÿ© ŸÅŸä ÿ≠ÿßŸÑÿ© ÿπÿØŸÖ ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿµŸàÿ±ÿ© */
}

.content-info {
    padding: 25px;
    display: block !important;
    visibility: visible !important;
}

.content-meta {
    display: flex !important;
    align-items: center;
    gap: 15px;
    margin-bottom: 15px;
    flex-wrap: wrap;
    visibility: visible !important;
}

.content-title {
    font-size: 1.8rem;
    font-weight: 700;
    margin-bottom: 15px;
    color: var(--primary-purple);
    display: block !important;
    visibility: visible !important;
}

.content-description {
    font-size: 1.1rem;
    line-height: 1.8;
    color: #555;
    margin-bottom: 20px;
    display: block !important;
    visibility: visible !important;
}

/* ÿ•ÿµŸÑÿßÿ≠ ÿπÿ±ÿ∂ ÿ£ŸÜŸàÿßÿπ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ */
.content-type, .content-episode, .content-date {
    display: inline-block !important;
    visibility: visible !important;
    padding: 8px 15px;
    border-radius: 20px;
    font-weight: 500;
    font-size: 0.9rem;
    margin: 5px 5px 5px 0;
}

.content-type {
    background: rgba(74, 21, 75, 0.1);
    color: var(--primary-purple);
}

.content-episode {
    background: rgba(239, 90, 95, 0.1);
    color: var(--secondary-red);
}

.content-date {
    background: rgba(46, 196, 182, 0.1);
    color: var(--accent-teal);
}
        
        /* ÿ•ÿÆŸÅÿßÿ° ÿ≤ÿ± ÿßŸÉÿ™ÿ¥ŸÅ ÿßŸÑŸÖŸäÿ≤ÿßÿ™ */
        .hero-buttons .btn-outline-light {
            display: none;
        }
        
        .redirect-text {
            margin: 25px 0;
            font-size: 1.2rem;
            font-weight: 500;
            color: #4A154B;
            text-align: center;
            padding: 15px;
            background: rgba(74, 21, 75, 0.05);
            border-radius: 12px;
        }
        
        .redirect-text .highlight {
            font-weight: 700;
            color: var(--accent-teal);
        }
        
        .security-text {
            font-size: 0.9rem;
            color: #6c757d;
            text-align: center;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid #eee;
        }
        
        /* Ad Containers */
        .ad-container {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 12px;
            border: 1px solid #eaeaea;
        }
        
        .ad-placeholder {
            width: 100%;
            height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(74, 21, 75, 0.1);
            border-radius: 8px;
            color: #4A154B;
            font-weight: 500;
            margin: 10px 0;
        }
        
        .ad-350x50 { height: 50px; }
        .ad-350x250 { height: 250px; }
        
        /* ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ŸÑŸÑÿπÿ±ÿ∂ ÿπŸÑŸâ ÿßŸÑÿ¨ŸàÿßŸÑ */
        @media (max-width: 768px) {
            .content-thumbnail {
                height: 250px;
            }
            
            .content-title {
                font-size: 1.5rem;
            }
            
            .hero-section {
                padding: 70px 0 50px;
            }
            
            .table-responsive {
                border-radius: 12px;
            }
            
            .redirect-container {
                margin: 40px 20px;
                padding: 30px 20px;
            }
            
            .platform-stat h3 {
                font-size: 1.8rem;
            }
            
            .platform-stats .col-md-3 {
                margin-bottom: 15px;
            }
            
            .card-header {
                padding: 1rem;
            }
            
            .table th, .table td {
                padding: 0.75rem;
                font-size: 0.9rem;
            }
            
            .table-responsive {
                overflow-x: auto;
            }
            
            .btn-lg {
                padding: 0.8rem 1.2rem;
                font-size: 1rem;
            }
            
            .netflix-style .redirect-thumbnail {
                height: 300px;
            }
            
            .redirect-text {
                font-size: 1rem;
            }
        }
        
        @media (max-width: 576px) {
            .content-thumbnail {
                height: 200px;
            }
            
            .content-title {
                font-size: 1.3rem;
            }
            
            .content-description {
                font-size: 1rem;
            }
            
            .hero-section {
                padding: 50px 0 30px;
            }
            
            .stat-number {
                font-size: 2.2rem;
            }
            
            .table th, .table td {
                padding: 0.5rem;
                font-size: 0.8rem;
            }
            
            .btn {
                padding: 0.5rem 1rem;
            }
            
            .navbar-nav .nav-item {
                margin: 5px 0;
            }
            
            .hero-buttons .btn {
                width: 100%;
                margin-bottom: 10px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .netflix-style .redirect-thumbnail {
                height: 250px;
            }
            
            .redirect-text {
                font-size: 0.9rem;
                padding: 10px;
            }
        }
        
        /* ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ŸÑÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿ™ŸÜŸÇŸÑ */
        .navbar-collapse {
            flex-basis: 100%;
            flex-grow: 0;
        }
        
        .navbar-nav .nav-link {
            padding: 10px 15px;
            margin: 0 5px;
        }
        
        @media (max-width: 991px) {
            .navbar-nav {
                margin-top: 15px;
            }
            
            .auth-section {
                margin-top: 15px;
                padding-top: 15px;
                border-top: 1px solid rgba(255,255,255,0.1);
            }
        }
        
        /* ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ŸÑŸÑÿ™ÿ±ŸÉŸäÿ≤ */
        .btn:focus, .form-control:focus, .form-select:focus, .nav-link:focus {
            box-shadow: 0 0 0 0.25rem rgba(46, 196, 182, 0.5);
        }
        
        /* ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ŸÑŸÑÿ¨ÿØŸàŸÑ ÿπŸÑŸâ ÿßŸÑÿ¨ŸàÿßŸÑ */
        @media (max-width: 576px) {
            .table-responsive {
                font-size: 0.8rem;
            }
            .action-buttons .btn {
                padding: 0.3rem 0.6rem;
                font-size: 0.8rem;
            }
        }

        /* Analytics Filter */
        .analytics-filter {
            background: white;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .filter-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 10px;
        }
        
        .filter-btn {
            padding: 5px 15px;
            border-radius: 20px;
            background: #f1f1f1;
            border: none;
            transition: all 0.3s;
        }
        
        .filter-btn:hover, .filter-btn.active {
            background: var(--primary-purple);
            color: white;
        }
        
        /* Modern Stats Modal */
        .stats-modal-content {
            padding: 20px;
            border-radius: 16px;
            background: white;
            box-shadow: 0 15px 50px rgba(0,0,0,0.1);
        }
        
        .stats-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .stats-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-purple);
        }
        
        .time-filter {
            display: flex;
            gap: 10px;
        }
        
        .time-btn {
            padding: 5px 12px;
            border-radius: 20px;
            background: #f1f1f1;
            border: none;
            transition: all 0.3s;
        }
        
        .time-btn:hover, .time-btn.active {
            background: var(--accent-teal);
            color: white;
        }
        
        /* Earnings Modal */
        .earnings-chart {
            height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px 0;
        }
        
        .earnings-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .earnings-card {
            background: white;
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            text-align: center;
        }
        
        .earnings-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent-teal);
            margin: 10px 0;
        }
        
        .earnings-label {
            font-size: 0.9rem;
            color: #6c757d;
        }
        
        /* Pagination */
        .pagination .page-item.active .page-link {
            background: var(--primary-purple);
            border-color: var(--primary-purple);
        }
        
        .pagination .page-link {
            color: var(--primary-purple);
        }
        
        /* ÿ•ÿ∂ÿßŸÅÿßÿ™ CSS ŸÑŸÑÿ£ÿ±ÿ®ÿßÿ≠ */
.earnings-region-card {
    background: white;
    border-radius: 12px;
    padding: 15px;
    margin-bottom: 15px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    border: 1px solid #eaeaea;
}

.earnings-breakdown {
    background: #f8f9fa;
    border-radius: 12px;
    padding: 20px;
    margin-top: 20px;
}

.earnings-card {
    transition: transform 0.2s;
}

.earnings-card:hover {
    transform: translateY(-3px);
}

.earnings-value {
    font-size: 1.5rem !important;
    font-weight: 700 !important;
    color: var(--accent-teal) !important;
    margin: 10px 0 !important;
}

.progress {
    border-radius: 10px;
    overflow: hidden;
}

.progress-bar {
    border-radius: 10px;
    transition: width 0.6s ease;
}   

@media (max-width: 768px) {
    .content-thumbnail {
        height: 250px !important;
    }
    .content-title {
        font-size: 1.5rem !important;
    }
}

/* ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™ ÿßŸÑÿ∞ŸÉŸäÿ© */
.algorithm-control-card, .algorithm-status-card {
    border-radius: 16px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    border: none;
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
}

.algorithm-metric {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 0;
    border-bottom: 1px solid rgba(0,0,0,0.1);
}

.algorithm-metric:last-child {
    border-bottom: none;
}

.algorithms-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
    gap: 25px;
    margin-top: 20px;
}

.algorithm-card {
    background: white;
    border-radius: 16px;
    padding: 25px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    border: none;
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    position: relative;
    overflow: hidden;
}

.algorithm-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 15px 40px rgba(0,0,0,0.15);
}

.algorithm-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, var(--primary-purple), var(--accent-teal));
}

.algorithm-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 15px;
}

.algorithm-title {
    font-size: 1.2rem;
    font-weight: 700;
    color: var(--primary-purple);
    margin: 0;
    display: flex;
    align-items: center;
    gap: 10px;
}

.algorithm-category {
    font-size: 0.8rem;
    padding: 4px 12px;
    border-radius: 20px;
    font-weight: 500;
}

.category-analytics {
    background: rgba(74, 21, 75, 0.1);
    color: var(--primary-purple);
}

.category-prediction {
    background: rgba(46, 196, 182, 0.1);
    color: var(--accent-teal);
}

.category-security {
    background: rgba(239, 90, 95, 0.1);
    color: var(--secondary-red);
}

.category-optimization {
    background: rgba(255, 159, 28, 0.1);
    color: #ff9f1c;
}

.algorithm-description {
    color: #6c757d;
    font-size: 0.95rem;
    line-height: 1.6;
    margin-bottom: 20px;
}

.algorithm-stats {
    display: flex;
    justify-content: space-between;
    margin-bottom: 20px;
}

.algorithm-stat {
    text-align: center;
    flex: 1;
}

.algorithm-stat-value {
    font-size: 1.1rem;
    font-weight: 700;
    color: var(--accent-teal);
    display: block;
}

.algorithm-stat-label {
    font-size: 0.8rem;
    color: #6c757d;
}

.algorithm-controls {
    display: flex;
    gap: 10px;
    align-items: center;
}

.algorithm-switch {
    margin-left: auto;
}

.algorithm-status {
    display: inline-block;
    width: 12px;
    height: 12px;
    border-radius: 50%;
    margin-right: 8px;
}

.status-idle {
    background: #6c757d;
}

.status-running {
    background: #28a745;
    animation: pulse 1s infinite;
}

.status-complete {
    background: var(--accent-teal);
}

.status-error {
    background: var(--secondary-red);
}

.algorithm-results {
    max-height: 400px;
    overflow-y: auto;
    padding: 15px;
    background: #f8f9fa;
    border-radius: 12px;
}

.algorithm-result-item {
    background: white;
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 10px;
    border-left: 4px solid var(--accent-teal);
}

.algorithm-result-item:last-child {
    margin-bottom: 0;
}

.algorithm-result-title {
    font-weight: 600;
    color: var(--primary-purple);
    margin-bottom: 5px;
}

.algorithm-result-value {
    font-size: 1.1rem;
    color: var(--accent-teal);
    font-weight: 700;
}

.algorithm-result-description {
    font-size: 0.9rem;
    color: #6c757d;
    margin-top: 5px;
}

.algorithm-progress {
    height: 6px;
    background: #e9ecef;
    border-radius: 3px;
    overflow: hidden;
    margin: 10px 0;
}

.algorithm-progress-bar {
    height: 100%;
    background: linear-gradient(90deg, var(--primary-purple), var(--accent-teal));
    border-radius: 3px;
    transition: width 0.3s ease;
}

/* ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ŸÑŸÑÿ¨ŸàÿßŸÑ */
@media (max-width: 768px) {
    .algorithms-grid {
        grid-template-columns: 1fr;
    }
    
    .algorithm-card {
        padding: 20px;
    }
    
    .algorithm-stats {
        flex-direction: column;
        gap: 10px;
    }
    
    .algorithm-controls {
        flex-direction: column;
        align-items: stretch;
    }
}

/* Bulk Import System Styles */
.bulk-import-card {
    border: none;
    box-shadow: 0 15px 35px rgba(0,0,0,0.1);
    border-radius: 20px;
    overflow: hidden;
    background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
}

.bulk-import-card .card-header {
    background: linear-gradient(135deg, var(--primary-purple) 0%, #6f42c1 100%);
    color: white;
    padding: 20px;
    border-bottom: none;
    font-size: 1.2rem;
    font-weight: 600;
}

.bulk-step {
    padding: 30px 0;
    border-bottom: 1px solid #eee;
    transition: all 0.3s ease;
}

.bulk-step:last-child {
    border-bottom: none;
}

.step-title {
    display: flex;
    align-items: center;
    gap: 15px;
    margin-bottom: 25px;
    font-weight: 600;
    color: var(--primary-purple);
}

.step-number {
    background: var(--accent-teal);
    color: white;
    width: 35px;
    height: 35px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 1.1rem;
}

.content-type-preview {
    background: #f8f9fa;
    border-radius: 15px;
    padding: 30px;
    text-align: center;
    border: 2px dashed #dee2e6;
    transition: all 0.3s ease;
    min-height: 150px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

.content-type-preview.active {
    border-color: var(--accent-teal);
    background: rgba(46, 196, 182, 0.1);
}

.upload-area {
    border: 3px dashed #dee2e6;
    border-radius: 15px;
    padding: 40px;
    text-align: center;
    background: #f8f9fa;
    transition: all 0.3s ease;
    cursor: pointer;
    min-height: 200px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.upload-area:hover {
    border-color: var(--accent-teal);
    background: rgba(46, 196, 182, 0.1);
}

.upload-area.dragover {
    border-color: var(--primary-purple);
    background: rgba(74, 21, 75, 0.1);
    transform: scale(1.02);
}

.upload-content h5 {
    color: var(--primary-purple);
    margin-bottom: 10px;
}

.file-info {
    background: #e8f5e8;
    border: 1px solid #d4edda;
    border-radius: 10px;
    padding: 15px;
    animation: slideIn 0.3s ease;
}

@keyframes slideIn {
    from { opacity: 0; transform: translateY(-10px); }
    to { opacity: 1; transform: translateY(0); }
}

.template-download {
    background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
    border-radius: 15px;
    padding: 20px;
    text-align: center;
    border: 1px solid #ffeaa7;
}

.data-preview-container {
    background: white;
    border-radius: 15px;
    padding: 20px;
    border: 1px solid #dee2e6;
}

.preview-stats {
    display: flex;
    justify-content: space-around;
    margin-bottom: 20px;
    padding: 15px;
    background: #f8f9fa;
    border-radius: 10px;
}

.stat-item {
    text-align: center;
}

.stat-label {
    font-size: 0.9rem;
    color: #6c757d;
    display: block;
}

.stat-value {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--primary-purple);
}

.preview-table {
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}

.preview-table thead th {
    background: var(--primary-purple);
    color: white;
    border: none;
    font-weight: 500;
    padding: 12px;
}

.preview-table tbody tr:nth-child(even) {
    background: #f8f9fa;
}

.preview-table tbody td {
    padding: 10px 12px;
    border: none;
    max-width: 200px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.validation-errors {
    background: #f8d7da;
    border: 1px solid #f5c6cb;
    border-radius: 10px;
    padding: 15px;
}

.validation-errors ul {
    margin: 0;
    max-height: 200px;
    overflow-y: auto;
}

.validation-errors li {
    color: #721c24;
    padding: 5px 0;
    border-bottom: 1px solid rgba(114, 28, 36, 0.1);
}

.bulk-actions {
    display: flex;
    gap: 15px;
    justify-content: center;
    padding-top: 20px;
    border-top: 1px solid #dee2e6;
}

.bulk-actions .btn {
    min-width: 120px;
    padding: 12px 25px;
    font-weight: 500;
    border-radius: 10px;
}

/* Processing Modal Styles */
.progress-overview {
    background: #f8f9fa;
    border-radius: 15px;
    padding: 20px;
}

.progress-stat {
    padding: 10px;
}

.progress-number {
    font-size: 2rem;
    font-weight: 700;
    line-height: 1;
}

.progress-label {
    font-size: 0.9rem;
    color: #6c757d;
    margin-top: 5px;
}

.current-processing {
    background: #fff;
    border-radius: 10px;
    padding: 15px;
    border: 1px solid #dee2e6;
}

.current-item {
    background: #f8f9fa;
    border-radius: 8px;
    padding: 12px;
}

.processing-spinner {
    flex-shrink: 0;
}

.processing-log {
    background: #fff;
    border-radius: 10px;
    padding: 15px;
    border: 1px solid #dee2e6;
}

.log-container {
    max-height: 200px;
    overflow-y: auto;
    background: #f8f9fa;
    border-radius: 8px;
    padding: 10px;
}

.log-entry {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 5px 0;
    border-bottom: 1px solid #eee;
    font-size: 0.9rem;
}

.log-entry:last-child {
    border-bottom: none;
}

.log-entry.success {
    color: #28a745;
}

.log-entry.error {
    color: #dc3545;
}

.log-entry.info {
    color: #17a2b8;
}

.log-timestamp {
    color: #6c757d;
    font-size: 0.8rem;
    flex-shrink: 0;
}

/* Content Type Icons */
.content-icon {
    font-size: 3rem;
    margin-bottom: 10px;
}

.content-icon.series { color: #6f42c1; }
.content-icon.movie { color: #fd7e14; }
.content-icon.match { color: #28a745; }
.content-icon.recipe { color: #ffc107; }
.content-icon.game { color: #dc3545; }
.content-icon.app { color: #20c997; }
.content-icon.channel { color: #6610f2; }
.content-icon.reels { color: #e83e8c; }

/* Responsive Design */
@media (max-width: 768px) {
    .bulk-step {
        padding: 20px 0;
    }
    
    .upload-area {
        padding: 30px 20px;
        min-height: 150px;
    }
    
    .preview-stats {
        flex-direction: column;
        gap: 10px;
    }
    
    .bulk-actions {
        flex-direction: column;
        align-items: center;
    }
    
    .bulk-actions .btn {
        width: 100%;
        max-width: 300px;
    }
    
    .progress-overview .row {
        text-align: center;
    }
    
    .progress-overview .col-3 {
        margin-bottom: 15px;
    }
}

/* Animation for steps */
.bulk-step.active {
    background: rgba(46, 196, 182, 0.05);
    border-left: 4px solid var(--accent-teal);
    padding-left: 26px;
}

.bulk-step.completed .step-number {
    background: #28a745;
}

.bulk-step.completed .step-number::after {
    content: "‚úì";
}

/* File type indicators */
.file-type-csv::before {
    content: "üìä";
    margin-right: 8px;
}

.file-type-xlsx::before {
    content: "üìó";
    margin-right: 8px;
}

.file-type-xls::before {
    content: "üìò";
    margin-right: 8px;
}
        
    </style>
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-4B73N1T483"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-4B73N1T483');
    </script>
</head>
<body>
    <!-- Notification System -->
    <div class="notification success" id="successNotification">
        <div>ÿ™ŸÖ ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑÿ±ÿßÿ®ÿ∑ ÿ®ŸÜÿ¨ÿßÿ≠!</div>
        <div class="progress-bar"><div class="progress"></div></div>
    </div>
    
    <div class="notification error" id="errorNotification">
        <div>ÿßŸÑÿ±ÿ¨ÿßÿ° ŸÖŸÑÿ° ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ŸÇŸàŸÑ ÿßŸÑŸÖÿ∑ŸÑŸàÿ®ÿ©</div>
        <div class="progress-bar"><div class="progress"></div></div>
    </div>
    
    <div class="notification info" id="welcomeNotification">
        <div>ÿ£ŸáŸÑÿßŸã ÿ®ÿπŸàÿØÿ™ŸÉÿå <span id="userName"></span>!</div>
        <div class="progress-bar"><div class="progress"></div></div>
    </div>

    <!-- reCAPTCHA Badge -->
    <div class="grecaptcha-badge" data-style="bottomright"></div>

    <!-- Custom Shapes -->
    <div class="custom-shape shape-1"></div>
    <div class="custom-shape shape-2"></div>

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand logo" href="#">
                <div class="logo-icon">
                    <i class="fas fa-link"></i>
                </div>
                Turk<span>ify</span> Pro
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent" 
                    aria-controls="navbarContent" aria-expanded="false" aria-label="ÿ™ÿ®ÿØŸäŸÑ ÿßŸÑÿ™ŸÜŸÇŸÑ">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link" href="#home" id="homeLink" aria-label="Home">
                            <i class="fas fa-home me-1"></i> ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©
                        </a>
                    </li>
                    <li class="nav-item admin-only">
                        <a class="nav-link" href="#admin" id="adminLink" aria-label="Admin Panel">
                            <i class="fas fa-cog me-1"></i> ŸÑŸàÿ≠ÿ© ÿßŸÑÿ™ÿ≠ŸÉŸÖ
                        </a>
                    </li>
                    <li class="nav-item admin-only">
                        <a class="nav-link" href="#analytics" id="statsLink" aria-label="Analytics">
                            <i class="fas fa-chart-bar me-1"></i> ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑÿßÿ™
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#features" id="featuresLink" aria-label="Features">
                            <i class="fas fa-star me-1"></i> ÿßŸÑŸÖŸäÿ≤ÿßÿ™
                        </a>
                    </li>
                </ul>
                
                <div class="d-flex align-items-center auth-section">
                    <div id="authButtons">
                        <button class="btn btn-outline-light" id="signInButton" aria-label="Sign in with Google">
                            <i class="fab fa-google me-2"></i>ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ
                        </button>
                    </div>
                    <div id="userProfile" style="display: none; margin-right: 15px;" aria-label="User profile">
                        <img src="" alt="User" id="userPhoto" class="rounded-circle me-2" 
                             style="width: 40px; height: 40px; object-fit: cover;" aria-label="User photo">
                        <button class="btn btn-outline-light" id="signOutButton" aria-label="Sign out">
                            <i class="fas fa-sign-out-alt me-1"></i>ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿÆÿ±Ÿàÿ¨
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-section" id="home">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6">
                    <h1 class="display-4 fw-bold mb-4">ŸÖŸÜÿµÿ© ŸÖÿ™ŸÇÿØŸÖÿ© ŸÑÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ±Ÿàÿßÿ®ÿ∑</h1>
                    <p class="lead mb-5">ÿ£ŸÜÿ¥ÿ¶ÿå ÿ™ÿ™ÿ®ÿπÿå Ÿàÿ∑Ÿàÿ± ÿ±Ÿàÿßÿ®ÿ∑ŸÉ ÿ®ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿ™ÿ≠ŸÑŸäŸÑÿßÿ™ ŸÇŸàŸäÿ© ŸàŸÖŸäÿ≤ÿßÿ™ ŸÖÿ™ÿ∑Ÿàÿ±ÿ©</p>
                    <div class="d-flex flex-wrap gap-3 hero-buttons">
                        <a href="#admin" class="btn btn-light btn-lg px-4 py-3 rounded-pill fw-bold" role="button" aria-label="Get started">
                            <i class="fas fa-rocket me-2"></i>ÿßÿ®ÿØÿ£ ÿßŸÑÿ¢ŸÜ
                        </a>
                    </div>
                </div>
                <div class="col-lg-6 text-center d-none d-lg-block">
                    <div class="position-relative">
                        <div class="card p-4 mx-auto" style="max-width: 400px; transform: rotate(3deg);">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-center mb-4">
                                    <h3 class="mb-0">ÿ™ÿ≠ŸÑŸäŸÑÿßÿ™ ÿßŸÑÿ±Ÿàÿßÿ®ÿ∑</h3>
                                    <span class="clicks-badge">+24%</span>
                                </div>
                                <div class="mb-4" style="height: 200px; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.1); border-radius: 8px;">
                                    <i class="fas fa-chart-line fa-3x"></i>
                                </div>
                                <div class="d-flex justify-content-around">
                                    <div>
                                        <div class="fw-bold">1.2K</div>
                                        <small>ŸÜŸÇÿ±ÿßÿ™</small>
                                    </div>
                                    <div>
                                        <div class="fw-bold">78%</div>
                                        <small>ÿ™ŸÅÿßÿπŸÑ</small>
                                    </div>
                                    <div>
                                        <div class="fw-bold">42</div>
                                        <small>ÿ±Ÿàÿßÿ®ÿ∑</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="platform-stats mt-5">
                <div class="row">
                    <div class="col-md-3 col-6">
                        <div class="platform-stat">
                            <h3 id="totalLinksStat">25K+</h3>
                            <p>ÿ±Ÿàÿßÿ®ÿ∑ ÿ™ŸÖ ÿ•ŸÜÿ¥ÿßÿ§Ÿáÿß</p>
                        </div>
                    </div>
                    <div class="col-md-3 col-6">
                        <div class="platform-stat">
                            <h3 id="totalClicksStat">1.2M+</h3>
                            <p>ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÜŸÇÿ±ÿßÿ™</p>
                        </div>
                    </div>
                    <div class="col-md-3 col-6">
                        <div class="platform-stat">
                            <h3 id="uptimeStat">99.9%</h3>
                            <p>ŸàŸÇÿ™ ÿßŸÑÿ™ÿ¥ÿ∫ŸäŸÑ</p>
                        </div>
                    </div>
                    <div class="col-md-3 col-6">
                        <div class="platform-stat">
                            <h3 id="todayClicksStat">1,245</h3>
                            <p>ŸÜŸÇÿ±ÿßÿ™ ÿßŸÑŸäŸàŸÖ</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <div class="container my-5 pt-5">
        <!-- Admin Panel -->
        <section id="admin">
            <div id="adminPanel" class="admin-only">
                <div class="row">
                    <div class="col-lg-8 mx-auto">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-plus-circle me-2"></i>ÿ•ŸÜÿ¥ÿßÿ° ÿ±ÿßÿ®ÿ∑ ŸÇÿµŸäÿ± ÿ¨ÿØŸäÿØ
                            </div>
                            <div class="card-body">
                                <div class="mb-4">
                                    <label class="form-label fw-bold">ÿßÿ≥ŸÖ ÿßŸÑÿ≥ŸÑÿ≥ŸÑÿ© *</label>
                                    <input type="text" class="form-control" id="seriesName" placeholder="ÿ£ÿØÿÆŸÑ ÿßÿ≥ŸÖ ÿßŸÑÿ≥ŸÑÿ≥ŸÑÿ©" aria-label="Series name">
                                    <div class="invalid-feedback" id="nameError">ÿßŸÑÿ±ÿ¨ÿßÿ° ÿ•ÿØÿÆÿßŸÑ ÿßÿ≥ŸÖ ÿ≥ŸÑÿ≥ŸÑÿ© ÿµÿßŸÑÿ≠ (ÿ£ÿ≠ÿ±ŸÅÿå ÿ£ÿ±ŸÇÿßŸÖÿå ŸàŸÖÿ≥ÿßŸÅÿßÿ™ ŸÅŸÇÿ∑)</div>
                                </div>
                                
                                <div class="mb-4">
                                    <label class="form-label fw-bold">ŸÜŸàÿπ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ *</label>
                                    <select class="form-select" id="linkType" aria-label="Link type">
                                        <option value="series">ŸÖÿ≥ŸÑÿ≥ŸÑ</option>
                                        <option value="movie">ŸÅŸäŸÑŸÖ</option>
                                        <option value="match">ŸÖÿ®ÿßÿ±ÿßÿ©</option>
                                        <option value="recipe">ŸàÿµŸÅÿ©</option>
                                        <option value="game">ŸÑÿπÿ®ÿ©</option>
                                        <option value="app">ÿ™ÿ∑ÿ®ŸäŸÇ</option>
                                        <option value="channel">ŸÇŸÜÿßÿ©</option>
                                        <option value="reels">ÿ±ŸäŸÑÿ≤</option>
                                    </select>
                                </div>
                                
                                <!-- ÿ≠ŸÇŸÑ ÿπÿØÿØ ÿßŸÑÿ≠ŸÑŸÇÿßÿ™ ÿßŸÑÿ¨ÿØŸäÿØ -->
                                <div class="mb-4" id="episodeCountWrapper" style="display: none;">
                                    <label class="form-label fw-bold">ÿπÿØÿØ ÿ≠ŸÑŸÇÿßÿ™ ÿßŸÑŸÖÿ≥ŸÑÿ≥ŸÑ *</label>
                                    <input type="number" class="form-control" id="totalEpisodes" placeholder="ŸÖÿ´ŸÑÿßŸã 10">
                                    <div class="invalid-feedback" id="episodeError">ÿßŸÑÿ±ÿ¨ÿßÿ° ÿ•ÿØÿÆÿßŸÑ ÿπÿØÿØ ÿ≠ŸÑŸÇÿßÿ™ ÿµÿ≠Ÿäÿ≠</div>
                                </div>
                                
                                <!-- ÿ≠ŸÇŸÑ ÿ±ŸÇŸÖ ÿßŸÑÿ≠ŸÑŸÇÿ© ÿßŸÑÿßÿ®ÿ™ÿØÿßÿ¶Ÿäÿ© -->
                                <div class="mb-4" id="startingEpisodeWrapper" style="display: none;">
                                    <label class="form-label fw-bold">ÿ±ŸÇŸÖ ÿßŸÑÿ≠ŸÑŸÇÿ© ÿßŸÑÿßÿ®ÿ™ÿØÿßÿ¶Ÿäÿ© *</label>
                                    <input type="number" class="form-control" id="startingEpisode" placeholder="ŸÖÿ´ŸÑÿßŸã 1" min="1" value="1">
                                    <div class="form-text">ÿ±ŸÇŸÖ ÿßŸÑÿ≠ŸÑŸÇÿ© ÿßŸÑÿ™Ÿä ÿ≥Ÿäÿ®ÿØÿ£ ŸÖŸÜŸáÿß ÿßŸÑÿπÿØ ÿßŸÑÿ™ŸÑŸÇÿßÿ¶Ÿä ÿßŸÑŸäŸàŸÖŸä</div>
                                </div>
                                
                                <div class="mb-4">
                                    <label class="form-label fw-bold">ÿßŸÑÿ±ÿßÿ®ÿ∑ ÿßŸÑÿ£ÿµŸÑŸä *</label>
                                    <input type="url" class="form-control" id="originalUrl" placeholder="https://example.com" aria-label="Original URL">
                                    <div class="invalid-feedback" id="urlError">ÿßŸÑÿ±ÿ¨ÿßÿ° ÿ•ÿØÿÆÿßŸÑ ÿ±ÿßÿ®ÿ∑ ÿµÿßŸÑÿ≠</div>
                                </div>
                                
                                <div class="mb-4">
                                    <label class="form-label fw-bold">ŸÜÿ∑ÿßŸÇ ŸÖÿÆÿµÿµ (ŸÖŸÖŸäÿ≤)</label>
                                    <input type="text" class="form-control" id="customDomain" placeholder="yourdomain.com" value="turkify.com" aria-label="Custom domain">
                                </div>
                                
                                <div class="mb-4">
                                    <label class="form-label fw-bold">ÿπŸÜŸàÿßŸÜ ŸÖÿπÿßŸäŸÜÿ© ÿßŸÑÿ≥Ÿàÿ¥ŸäÿßŸÑ ŸÖŸäÿØŸäÿß</label>
                                    <input type="text" class="form-control" id="socialTitle" placeholder="ÿπŸÜŸàÿßŸÜ ÿ¨ÿ∞ÿßÿ® ŸÑŸÑŸÖÿ≠ÿ™ŸàŸâ" aria-label="Social media title">
                                </div>
                                
                                <div class="mb-4">
                                    <label class="form-label fw-bold">ŸàÿµŸÅ ŸÖÿπÿßŸäŸÜÿ© ÿßŸÑÿ≥Ÿàÿ¥ŸäÿßŸÑ ŸÖŸäÿØŸäÿß</label>
                                    <textarea class="form-control" id="socialDescription" rows="3" placeholder="ŸàÿµŸÅ ÿ¨ÿ∞ÿßÿ® ŸÑŸÑŸÖÿ≠ÿ™ŸàŸâ Ÿäÿ¨ÿ∞ÿ® ÿßŸÑÿ≤Ÿàÿßÿ±" aria-label="Social media description"></textarea>
                                </div>
                                
                                <div class="mb-4">
                                    <label class="form-label fw-bold">ÿµŸàÿ±ÿ© ŸÖÿπÿßŸäŸÜÿ© ÿßŸÑÿ≥Ÿàÿ¥ŸäÿßŸÑ ŸÖŸäÿØŸäÿß (URL)</label>
                                    <input type="url" class="form-control" id="socialImage" placeholder="https://example.com/image.jpg" aria-label="Social media image">
                                    <div class="form-text">ÿßÿ≥ÿ™ÿÆÿØŸÖ ÿµŸàÿ±ÿ© ÿ¨ÿ∞ÿßÿ®ÿ© ŸÑÿ¨ÿ∞ÿ® ÿßŸÑŸÖÿ≤ŸäÿØ ŸÖŸÜ ÿßŸÑŸÜŸÇÿ±ÿßÿ™</div>
                                </div>
                                
                                <div class="d-grid">
                                    <button id="generateBtn" class="btn btn-primary btn-lg py-3 fw-bold" aria-label="Generate link">
                                        <i class="fas fa-bolt me-2"></i>ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑÿ±ÿßÿ®ÿ∑
                                    </button>
                                    <button id="updateBtn" class="btn btn-success btn-lg py-3 fw-bold mt-2" style="display: none;" aria-label="Update link">
                                        <i class="fas fa-save me-2"></i>ÿ≠ŸÅÿ∏ ÿßŸÑÿ™ÿ∫ŸäŸäÿ±ÿßÿ™
                                    </button>
                                </div>
                                
                                <div class="mt-4">
                                    <h5>ŸÖÿπÿßŸäŸÜÿ© ŸÖŸÜÿ¥Ÿàÿ± ÿßŸÑÿ≥Ÿàÿ¥ŸäÿßŸÑ ŸÖŸäÿØŸäÿß</h5>
                                    <div class="social-preview">
                                        <img src="https://via.placeholder.com/500x300/4A154B/FFFFFF?text=ÿµŸàÿ±ÿ©+ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ" id="previewImage" class="social-preview-img" alt="Preview">
                                        <h5 id="previewTitle">ÿπŸÜŸàÿßŸÜ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ</h5>
                                        <p id="previewDescription">ŸàÿµŸÅ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑÿ∞Ÿä ÿ≥Ÿäÿ∏Ÿáÿ± ÿπŸÑŸâ ŸÖŸÜÿµÿßÿ™ ÿßŸÑÿ™ŸàÿßÿµŸÑ ÿßŸÑÿßÿ¨ÿ™ŸÖÿßÿπŸä</p>
                                        <small id="previewDomain">turkify.com</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                 <!-- Bulk Link Import Section -->
<div class="row mt-5">
    <div class="col-12">
        <div class="card bulk-import-card">
            <div class="card-header">
                <i class="fas fa-upload me-2"></i>ÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ ÿßŸÑÿ±Ÿàÿßÿ®ÿ∑ ÿßŸÑŸÖÿ¨ŸÖÿπÿ© (Bulk Import)
                <span class="badge bg-info ms-2">ŸÖÿ™ŸÇÿØŸÖ</span>
            </div>
            <div class="card-body">
                <!-- Step 1: Content Type Selection -->
                <div class="bulk-step" id="step1">
                    <h5 class="step-title">
                        <span class="step-number">1</span>
                        ÿßÿÆÿ™ÿ± ŸÜŸàÿπ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ
                    </h5>
                    <div class="row">
                        <div class="col-md-6">
                            <label class="form-label fw-bold">ŸÜŸàÿπ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ŸÑŸÑŸÖŸÑŸÅ:</label>
                            <select class="form-select form-select-lg" id="bulkContentType">
                                <option value="">-- ÿßÿÆÿ™ÿ± ŸÜŸàÿπ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ --</option>
                                <option value="series">ŸÖÿ≥ŸÑÿ≥ŸÑÿßÿ™</option>
                                <option value="movie">ÿ£ŸÅŸÑÿßŸÖ</option>
                                <option value="match">ŸÖÿ®ÿßÿ±Ÿäÿßÿ™</option>
                                <option value="recipe">ŸàÿµŸÅÿßÿ™</option>
                                <option value="game">ÿ£ŸÑÿπÿßÿ®</option>
                                <option value="app">ÿ™ÿ∑ÿ®ŸäŸÇÿßÿ™</option>
                                <option value="channel">ŸÇŸÜŸàÿßÿ™</option>
                                <option value="reels">ÿ±ŸäŸÑÿ≤</option>
                            </select>
                            <div class="form-text">ÿ¨ŸÖŸäÿπ ÿßŸÑÿ±Ÿàÿßÿ®ÿ∑ ŸÅŸä ÿßŸÑŸÖŸÑŸÅ ÿ≥ÿ™ŸÉŸàŸÜ ŸÖŸÜ Ÿáÿ∞ÿß ÿßŸÑŸÜŸàÿπ</div>
                        </div>
                        <div class="col-md-6">
                            <div class="content-type-preview" id="contentTypePreview">
                                <i class="fas fa-film fa-3x text-muted"></i>
                                <p class="text-muted mt-2">ÿßÿÆÿ™ÿ± ŸÜŸàÿπ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ŸÑÿ±ÿ§Ÿäÿ© ÿßŸÑŸÖÿπÿßŸäŸÜÿ©</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 2: File Upload -->
                <div class="bulk-step" id="step2" style="display: none;">
                    <h5 class="step-title">
                        <span class="step-number">2</span>
                        ÿ±ŸÅÿπ ÿßŸÑŸÖŸÑŸÅ
                    </h5>
                    <div class="row">
                        <div class="col-md-8">
                            <div class="upload-area" id="uploadArea">
                                <div class="upload-content">
                                    <i class="fas fa-cloud-upload-alt fa-3x text-primary mb-3"></i>
                                    <h5>ÿßÿ≥ÿ≠ÿ® Ÿàÿ£ŸÅŸÑÿ™ ÿßŸÑŸÖŸÑŸÅ ŸáŸÜÿß</h5>
                                    <p class="text-muted">ÿ£Ÿà ÿßŸÜŸÇÿ± ŸÑÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑŸÖŸÑŸÅ</p>
                                    <p class="small text-muted">ŸäÿØÿπŸÖ: CSV, XLSX, XLS (ÿ≠ÿØ ÿ£ŸÇÿµŸâ: 50MB)</p>
                                </div>
                                <input type="file" id="bulkFileInput" accept=".csv,.xlsx,.xls" hidden>
                            </div>
                            
                            <!-- File Info -->
                            <div id="fileInfo" class="file-info mt-3" style="display: none;">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-file-excel text-success fa-2x me-3"></i>
                                    <div>
                                        <strong id="fileName">filename.csv</strong>
                                        <div class="small text-muted">
                                            <span id="fileSize">0 KB</span> ‚Ä¢ 
                                            <span id="rowCount">0 ÿµŸÅ</span>
                                        </div>
                                    </div>
                                    <button class="btn btn-sm btn-outline-danger ms-auto" id="removeFile">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="template-download">
                                <h6><i class="fas fa-download me-2"></i>ÿ™ÿ≠ŸÖŸäŸÑ ŸÇÿßŸÑÿ®</h6>
                                <p class="small text-muted">ÿ≠ŸÖŸëŸÑ ŸÇÿßŸÑÿ® CSV ÿ¨ÿßŸáÿ≤ ŸÑÿ™ÿπÿ®ÿ¶ÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™</p>
                                <button class="btn btn-outline-primary btn-sm w-100" id="downloadTemplate">
                                    <i class="fas fa-download me-2"></i>ÿ™ÿ≠ŸÖŸäŸÑ ŸÇÿßŸÑÿ® CSV
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 3: Data Preview -->
                <div class="bulk-step" id="step3" style="display: none;">
                    <h5 class="step-title">
                        <span class="step-number">3</span>
                        ŸÖÿπÿßŸäŸÜÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
                    </h5>
                    <div class="data-preview-container">
                        <div class="preview-stats">
                            <div class="stat-item">
                                <span class="stat-label">ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿµŸÅŸàŸÅ:</span>
                                <span class="stat-value" id="totalRows">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">ÿµŸÅŸàŸÅ ÿµÿ≠Ÿäÿ≠ÿ©:</span>
                                <span class="stat-value text-success" id="validRows">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">ÿ£ÿÆÿ∑ÿßÿ°:</span>
                                <span class="stat-value text-danger" id="errorRows">0</span>
                            </div>
                        </div>
                        
                        <div class="table-responsive mt-3">
                            <table class="table table-sm preview-table">
                                <thead id="previewTableHeader"></thead>
                                <tbody id="previewTableBody"></tbody>
                            </table>
                        </div>
                        
                        <!-- Validation Errors -->
                        <div id="validationErrors" class="validation-errors mt-3" style="display: none;">
                            <h6 class="text-danger"><i class="fas fa-exclamation-triangle me-2"></i>ÿ£ÿÆÿ∑ÿßÿ° ÿßŸÑÿ™ÿ≠ŸÇŸÇ:</h6>
                            <ul id="errorsList" class="list-unstyled"></ul>
                        </div>
                    </div>
                </div>

                <!-- Step 4: Processing Options -->
                <div class="bulk-step" id="step4" style="display: none;">
                    <h5 class="step-title">
                        <span class="step-number">4</span>
                        ÿÆŸäÿßÿ±ÿßÿ™ ÿßŸÑŸÖÿπÿßŸÑÿ¨ÿ©
                    </h5>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="skipErrors" checked>
                                <label class="form-check-label" for="skipErrors">
                                    ÿ™ÿÆÿ∑Ÿä ÿßŸÑÿµŸÅŸàŸÅ ÿßŸÑÿ™Ÿä ÿ™ÿ≠ÿ™ŸàŸä ÿπŸÑŸâ ÿ£ÿÆÿ∑ÿßÿ°
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="generateReports" checked>
                                <label class="form-check-label" for="generateReports">
                                    ÿ•ŸÜÿ¥ÿßÿ° ÿ™ŸÇÿ±Ÿäÿ± ŸÖŸÅÿµŸÑ
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="notifyCompletion" checked>
                                <label class="form-check-label" for="notifyCompletion">
                                    ÿ•ÿ¥ÿπÿßÿ± ÿπŸÜÿØ ÿßŸÑÿßŸÜÿ™Ÿáÿßÿ°
                                </label>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">ŸÜÿ∑ÿßŸÇ ŸÖÿÆÿµÿµ (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä):</label>
                            <input type="text" class="form-control" id="bulkCustomDomain" 
                                   placeholder="turkii.netlify.app" value="turkii.netlify.app">
                            <div class="form-text">ÿ≥ŸäŸèÿ≥ÿ™ÿÆÿØŸÖ ŸÑÿ¨ŸÖŸäÿπ ÿßŸÑÿ±Ÿàÿßÿ®ÿ∑</div>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="bulk-actions mt-4">
                    <button class="btn btn-outline-secondary" id="prevStep" style="display: none;">
                        <i class="fas fa-arrow-left me-2"></i>ÿßŸÑÿ≥ÿßÿ®ŸÇ
                    </button>
                    <button class="btn btn-primary" id="nextStep" disabled>
                        ÿßŸÑÿ™ÿßŸÑŸä<i class="fas fa-arrow-right ms-2"></i>
                    </button>
                    <button class="btn btn-success btn-lg" id="startBulkImport" style="display: none;">
                        <i class="fas fa-rocket me-2"></i>ÿ®ÿØÿ° ÿßŸÑÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ ÿßŸÑŸÖÿ¨ŸÖÿπ
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Bulk Processing Modal -->
<div class="modal fade" id="bulkProcessingModal" tabindex="-1" data-bs-backdrop="static">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="fas fa-cogs me-2"></i>ŸÖÿπÿßŸÑÿ¨ÿ© ÿßŸÑÿ±Ÿàÿßÿ®ÿ∑ ÿßŸÑŸÖÿ¨ŸÖÿπÿ©
                </h5>
            </div>
            <div class="modal-body">
                <!-- Progress Overview -->
                <div class="progress-overview mb-4">
                    <div class="row text-center">
                        <div class="col-3">
                            <div class="progress-stat">
                                <div class="progress-number text-primary" id="processedCount">0</div>
                                <div class="progress-label">ÿ™ŸÖ ÿßŸÑŸÖÿπÿßŸÑÿ¨ÿ©</div>
                            </div>
                        </div>
                        <div class="col-3">
                            <div class="progress-stat">
                                <div class="progress-number text-success" id="successCount">0</div>
                                <div class="progress-label">ŸÜÿ¨ÿ≠</div>
                            </div>
                        </div>
                        <div class="col-3">
                            <div class="progress-stat">
                                <div class="progress-number text-danger" id="failedCount">0</div>
                                <div class="progress-label">ŸÅÿ¥ŸÑ</div>
                            </div>
                        </div>
                        <div class="col-3">
                            <div class="progress-stat">
                                <div class="progress-number text-info" id="remainingCount">0</div>
                                <div class="progress-label">ŸÖÿ™ÿ®ŸÇŸä</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Progress Bar -->
                <div class="progress mb-3" style="height: 20px;">
                    <div class="progress-bar progress-bar-striped progress-bar-animated" 
                         id="bulkProgressBar" style="width: 0%"></div>
                </div>
                <div class="text-center mb-3">
                    <small class="text-muted" id="progressText">ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ÿ≠ÿ∂Ÿäÿ±...</small>
                </div>

                <!-- Current Processing -->
                <div class="current-processing">
                    <h6><i class="fas fa-clock me-2"></i>ÿßŸÑÿπŸÜÿµÿ± ÿßŸÑÿ≠ÿßŸÑŸä:</h6>
                    <div class="current-item" id="currentItem">
                        <div class="d-flex align-items-center">
                            <div class="processing-spinner me-3">
                                <div class="spinner-border spinner-border-sm text-primary"></div>
                            </div>
                            <div>
                                <strong id="currentItemName">ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ÿ≠ÿ∂Ÿäÿ±...</strong>
                                <div class="small text-muted" id="currentItemUrl">--</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Processing Log -->
                <div class="processing-log mt-4">
                    <h6><i class="fas fa-list me-2"></i>ÿ≥ÿ¨ŸÑ ÿßŸÑŸÖÿπÿßŸÑÿ¨ÿ©:</h6>
                    <div id="processingLog" class="log-container">
                        <!-- Log entries will be added here -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline-danger" id="cancelProcessing">
                    <i class="fas fa-stop me-2"></i>ÿ•ŸäŸÇÿßŸÅ
                </button>
                <button type="button" class="btn btn-success" id="downloadReport" style="display: none;">
                    <i class="fas fa-download me-2"></i>ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ™ŸÇÿ±Ÿäÿ±
                </button>
                <button type="button" class="btn btn-primary" data-bs-dismiss="modal" id="closeProcessing" style="display: none;">
                    ÿ•ÿ∫ŸÑÿßŸÇ
                </button>
            </div>
        </div>
    </div>
</div>
                
                <!-- Link Management -->
                <div class="row mt-5">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <div>
                                    <i class="fas fa-list me-2"></i>ÿßŸÑÿ±Ÿàÿßÿ®ÿ∑ ÿßŸÑŸÖÿØÿßÿ±ÿ©
                                </div>
                                <div class="d-flex">
                                    <div class="input-group me-2" style="max-width: 300px;">
                                        <input type="text" class="form-control" placeholder="ÿ®ÿ≠ÿ´ ŸÅŸä ÿßŸÑÿ±Ÿàÿßÿ®ÿ∑..." id="searchLinks" aria-label="Search links">
                                        <button class="btn btn-primary" id="searchButton" aria-label="Search">
                                            <i class="fas fa-search"></i>
                                        </button>
                                    </div>
                                    <select class="form-select" id="sortLinks" style="max-width: 150px;" aria-label="Sort links">
                                        <option value="newest">ÿßŸÑÿ£ÿ≠ÿØÿ´ ÿ£ŸàŸÑÿßŸã</option>
                                        <option value="clicks">ÿßŸÑÿ£ŸÉÿ´ÿ± ŸÜŸÇÿ±ÿßÿ™</option>
                                        <option value="name">ÿ≠ÿ≥ÿ® ÿßŸÑÿßÿ≥ŸÖ</option>
                                    </select>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover" aria-label="Managed links">
                                        <thead>
                                            <tr>
                                                <th scope="col">ÿßŸÑŸÖÿπÿ±ŸÅ</th>
                                                <th scope="col">ÿßÿ≥ŸÖ ÿßŸÑÿ≥ŸÑÿ≥ŸÑÿ©</th>
                                                <th scope="col">ÿßŸÑŸÜŸàÿπ</th>
                                                <th scope="col">ÿßŸÑÿ±ÿßÿ®ÿ∑ ÿßŸÑŸÇÿµŸäÿ±</th>
                                                <th scope="col">ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿ•ŸÜÿ¥ÿßÿ°</th>
                                                <th scope="col">ÿßŸÑŸÜŸÇÿ±ÿßÿ™</th>
                                                <th scope="col">ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°ÿßÿ™</th>
                                            </tr>
                                        </thead>
                                        <tbody id="linksTable">
                                            <tr>
                                                <td colspan="7" class="text-center table-loader">
                                                    <div class="spinner-border text-primary" role="status">
                                                        <span class="visually-hidden">ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ...</span>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                
                                <nav class="mt-4" aria-label="Links pagination">
                                    <ul class="pagination justify-content-center">
                                        <li class="page-item disabled">
                                            <a class="page-link" href="#" tabindex="-1">ÿßŸÑÿ≥ÿßÿ®ŸÇ</a>
                                        </li>
                                        <li class="page-item active"><a class="page-link" href="#">1</a></li>
                                        <li class="page-item"><a class="page-link" href="#">2</a></li>
                                        <li class="page-item"><a class="page-link" href="#">3</a></li>
                                        <li class="page-item">
                                            <a class="page-link" href="#">ÿßŸÑÿ™ÿßŸÑŸä</a>
                                        </li>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Analytics Dashboard -->
        <section id="analytics">
            <div id="analyticsPanel" style="display: none;">
                <div class="row">
                    <div class="col-12 mb-4">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-chart-line me-2"></i>ŸÜÿ∏ÿ±ÿ© ÿπÿßŸÖÿ© ÿπŸÑŸâ ÿ£ÿØÿßÿ° ÿßŸÑÿ±Ÿàÿßÿ®ÿ∑
                            </div>
                            <div class="card-body">
                                <div class="analytics-filter">
                                    <h6>ÿ™ÿµŸÅŸäÿ© ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑÿßÿ™:</h6>
                                    <div class="filter-group">
                                        <button class="filter-btn active">ÿßŸÑŸÉŸÑ</button>
                                        <button class="filter-btn">ÿßŸÑŸäŸàŸÖ</button>
                                        <button class="filter-btn">ÿ£ÿ≥ÿ®Ÿàÿπ</button>
                                        <button class="filter-btn">ÿ¥Ÿáÿ±</button>
                                        <button class="filter-btn">3 ÿ£ÿ¥Ÿáÿ±</button>
                                        <button class="filter-btn">6 ÿ£ÿ¥Ÿáÿ±</button>
                                        <button class="filter-btn">ÿ≥ŸÜÿ©</button>
                                    </div>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-3 col-6 mb-4">
                                        <div class="stat-card">
                                            <div class="stat-number" id="totalLinks">24</div>
                                            <div class="stat-label">ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿ±Ÿàÿßÿ®ÿ∑</div>
                                        </div>
                                    </div>
                                    <div class="col-md-3 col-6 mb-4">
                                        <div class="stat-card">
                                            <div class="stat-number" id="totalClicks">1,842</div>
                                            <div class="stat-label">ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÜŸÇÿ±ÿßÿ™</div>
                                        </div>
                                    </div>
                                    <div class="col-md-3 col-6 mb-4">
                                        <div class="stat-card">
                                            <div class="stat-number" id="todayClicks">56</div>
                                            <div class="stat-label">ŸÜŸÇÿ±ÿßÿ™ ÿßŸÑŸäŸàŸÖ</div>
                                        </div>
                                    </div>
                                    <div class="col-md-3 col-6 mb-4">
                                        <div class="stat-card">
                                            <div class="stat-number" id="popularLink">78%</div>
                                            <div class="stat-label">ŸÖÿπÿØŸÑ ÿßŸÑÿ™ŸÅÿßÿπŸÑ</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="mt-5">
                                    <h5 class="mb-4">ÿßŸÑŸÜŸÇÿ±ÿßÿ™ ŸÖÿπ ŸÖÿ±Ÿàÿ± ÿßŸÑŸàŸÇÿ™</h5>
                                    <div id="clicksChartPlaceholder" style="height: 300px; display: flex; align-items: center; justify-content: center; background: #f8f9fa; border-radius: 12px;">
                                        <i class="fas fa-chart-bar fa-3x text-muted"></i>
                                    </div>
                                </div>
                                
                                <div class="row mt-5">
                                    <div class="col-md-6 mb-4">
                                        <h5 class="mb-4">ÿ£ŸÅÿ∂ŸÑ ÿßŸÑÿ±Ÿàÿßÿ®ÿ∑ ÿ£ÿØÿßÿ°Ÿã</h5>
                                        <div class="list-group">
                                            <a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center" aria-label="Summer Sale link">
                                                <div>
                                                    <div class="fw-bold">ÿ™ÿÆŸÅŸäÿ∂ÿßÿ™ ÿßŸÑÿµŸäŸÅ</div>
                                                    <small class="text-muted">https://turkify.com/s/389472</small>
                                                </div>
                                                <span class="clicks-badge">142 ŸÜŸÇÿ±ÿßÿ™</span>
                                            </a>
                                            <a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center" aria-label="Special Offer link">
                                                <div>
                                                    <div class="fw-bold">ÿπÿ±ÿ∂ ÿÆÿßÿµ</div>
                                                    <small class="text-muted">https://turkify.com/s/734516</small>
                                                </div>
                                                <span class="clicks-badge">128 ŸÜŸÇÿ±ÿßÿ™</span>
                                            </a>
                                            <a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center" aria-label="New Products link">
                                                <div>
                                                    <div class="fw-bold">ŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿ¨ÿØŸäÿØÿ©</div>
                                                    <small class="text-muted">https://turkify.com/s/562891</small>
                                                </div>
                                                <span class="clicks-badge">89 ŸÜŸÇÿ±ÿßÿ™</span>
                                            </a>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-4">
                                        <h5 class="mb-4">ÿßŸÑÿ™Ÿàÿ≤Ÿäÿπ ÿßŸÑÿ¨ÿ∫ÿ±ÿßŸÅŸä</h5>
                                        <div class="stats-card">
                                            <div class="d-flex align-items-center mb-3">
                                                <img src="https://flagcdn.com/sa.svg" loading="lazy" class="country-flag" alt="Saudi Arabia flag">
                                                <div class="fw-bold">ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©</div>
                                                <div class="ms-auto">42%</div>
                                            </div>
                                            <div class="d-flex align-items-center mb-3">
                                                <img src="https://flagcdn.com/ae.svg" loading="lazy" class="country-flag" alt="United Arab Emirates flag">
                                                <div class="fw-bold">ÿßŸÑÿ•ŸÖÿßÿ±ÿßÿ™</div>
                                                <div class="ms-auto">18%</div>
                                            </div>
                                            <div class="d-flex align-items-center mb-3">
                                                <img src="https://flagcdn.com/eg.svg" loading="lazy" class="country-flag" alt="Egypt flag">
                                                <div class="fw-bold">ŸÖÿµÿ±</div>
                                                <div class="ms-auto">12%</div>
                                            </div>
                                            <div class="d-flex align-items-center">
                                                <img src="https://flagcdn.com/qa.svg" loading="lazy" class="country-flag" alt="Qatar flag">
                                                <div class="fw-bold">ŸÇÿ∑ÿ±</div>
                                                <div class="ms-auto">8%</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="row mt-4">
                                    <div class="col-md-6 mb-4">
                                        <h5 class="mb-4">ÿ£ŸÜŸàÿßÿπ ÿßŸÑÿ£ÿ¨Ÿáÿ≤ÿ©</h5>
                                        <div class="stats-card">
                                            <div class="d-flex align-items-center mb-3">
                                                <div class="device-badge device-mobile"><i class="fas fa-mobile-alt me-2"></i>ÿ¨ŸàÿßŸÑ</div>
                                                <div class="ms-auto">58%</div>
                                            </div>
                                            <div class="d-flex align-items-center mb-3">
                                                <div class="device-badge device-desktop"><i class="fas fa-desktop me-2"></i>ŸÉŸÖÿ®ŸäŸàÿ™ÿ±</div>
                                                <div class="ms-auto">32%</div>
                                            </div>
                                            <div class="d-flex align-items-center">
                                                <div class="device-badge device-tablet"><i class="fas fa-tablet-alt me-2"></i>ÿ™ÿßÿ®ŸÑÿ™</div>
                                                <div class="ms-auto">10%</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-4">
                                        <h5 class="mb-4">ŸÖÿµÿßÿØÿ± ÿßŸÑÿ≤Ÿäÿßÿ±ÿßÿ™</h5>
                                        <div class="stats-card">
                                            <div class="d-flex align-items-center mb-3">
                                                <i class="fab fa-facebook me-3" style="color: #3b5998;"></i>
                                                <div class="fw-bold">ŸÅŸäÿ≥ÿ®ŸàŸÉ</div>
                                                <div class="ms-auto">38%</div>
                                            </div>
                                            <div class="d-flex align-items-center mb-3">
                                                <i class="fab fa-twitter me-3" style="color: #1da1f2;"></i>
                                                <div class="fw-bold">ÿ™ŸàŸäÿ™ÿ±</div>
                                                <div class="ms-auto">22%</div>
                                            </div>
                                            <div class="d-flex align-items-center mb-3">
                                                <i class="fab fa-instagram me-3" style="color: #e1306c;"></i>
                                                <div class="fw-bold">ÿ•ŸÜÿ≥ÿ™ÿ∫ÿ±ÿßŸÖ</div>
                                                <div class="ms-auto">18%</div>
                                            </div>
                                            <div class="d-flex align-items-center">
                                                <i class="fas fa-envelope me-3" style="color: #ea4335;"></i>
                                                <div class="fw-bold">ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä</div>
                                                <div class="ms-auto">12%</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Features Section -->
        <section id="features">
            <div id="featuresPanel">
                <div class="row mb-5">
                    <div class="col-12 text-center">
                        <h2 class="display-5 fw-bold mb-3">ŸÖŸäÿ≤ÿßÿ™ ŸÖÿ™ŸÇÿØŸÖÿ©</h2>
                        <p class="lead mb-5">ŸÉŸÑ ŸÖÿß ÿ™ÿ≠ÿ™ÿßÿ¨Ÿá ŸÑÿ•ŸÜÿ¥ÿßÿ° Ÿàÿ•ÿØÿßÿ±ÿ© Ÿàÿ™ÿ™ÿ®ÿπ ÿ±Ÿàÿßÿ®ÿ∑ŸÉ</p>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-4 mb-4">
                        <div class="card h-100">
                            <div class="card-body text-center p-4">
                                <div class="feature-icon">
                                    <i class="fas fa-link"></i>
                                </div>
                                <h4 class="mb-3">ÿ™ŸÜÿ≥ŸäŸÇ ÿ±ÿßÿ®ÿ∑ ŸÖÿÆÿµÿµ</h4>
                                <p>ÿ£ŸÜÿ¥ÿ¶ ÿ±Ÿàÿßÿ®ÿ∑ ÿ®ÿßŸÑÿ™ŸÜÿ≥ŸäŸÇ: https://series-name.com/√©pisode-today-XXXXXX</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-4">
                        <div class="card h-100">
                            <div class="card-body text-center p-4">
                                <div class="feature-icon">
                                    <i class="fas fa-chart-line"></i>
                                </div>
                                <h4 class="mb-3">ÿ™ÿ≠ŸÑŸäŸÑÿßÿ™ ŸÖÿ™ŸÇÿØŸÖÿ©</h4>
                                <p>ÿ™ÿ™ÿ®ÿπ ÿßŸÑŸÜŸÇÿ±ÿßÿ™ ŸàÿßŸÑŸÖŸàÿßŸÇÿπ ŸàÿßŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ŸàŸÖŸÇÿßŸäŸäÿ≥ ÿßŸÑÿ™ŸÅÿßÿπŸÑ ŸÅŸä ÿßŸÑŸàŸÇÿ™ ÿßŸÑŸÅÿπŸÑŸä.</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-4">
                        <div class="card h-100">
                            <div class="card-body text-center p-4">
                                <div class="feature-icon">
                                    <i class="fas fa-database"></i>
                                </div>
                                <h4 class="mb-3">ÿ™ÿÆÿ≤ŸäŸÜ ÿ≥ÿ≠ÿßÿ®Ÿä</h4>
                                <p>ÿßÿ≥ÿ™ÿÆÿØŸÖ Firebase Firestore ŸÑÿ™ÿÆÿ≤ŸäŸÜ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ Ÿàÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ±Ÿàÿßÿ®ÿ∑ ÿ®ÿ≥ŸáŸàŸÑÿ©.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-4 mb-4">
                        <div class="card h-100">
                            <div class="card-body text-center p-4">
                                <div class="feature-icon">
                                    <i class="fas fa-redo"></i>
                                </div>
                                <h4 class="mb-3">ÿ•ÿπÿßÿØÿ© ÿ™Ÿàÿ¨ŸäŸá ŸÅŸàÿ±Ÿäÿ©</h4>
                                <p>ÿ£ÿπÿØ ÿ™Ÿàÿ¨ŸäŸá ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ ŸÅŸàÿ±Ÿãÿß ŸÖÿπ ÿßŸÑŸÇÿØÿ±ÿ© ÿπŸÑŸâ ÿ™ÿ™ÿ®ÿπ ÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™.</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-4">
                        <div class="card h-100">
                            <div class="card-body text-center p-4">
                                <div class="feature-icon">
                                    <i class="fas fa-shield-alt"></i>
                                </div>
                                <h4 class="mb-3">ÿ≠ŸÖÿßŸäÿ© ŸÖÿ™ŸÇÿØŸÖÿ©</h4>
                                <p>ÿßÿ≥ÿ™ÿÆÿØŸÖ reCAPTCHA v3 ŸÑŸÖŸÜÿπ ÿßŸÑÿ•ÿ≥ÿßÿ°ÿ© Ÿàÿ≠ŸÖÿßŸäÿ© ÿßŸÑŸÖŸÜÿµÿ©.</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-4">
                        <div class="card h-100">
                            <div class="card-body text-center p-4">
                                <div class="feature-icon">
                                    <i class="fas fa-mobile-alt"></i>
                                </div>
                                <h4 class="mb-3">ÿ™ÿµŸÖŸäŸÖ ŸÖÿ™ÿ¨ÿßŸàÿ®</h4>
                                <p>Ÿàÿßÿ¨Ÿáÿ© ŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿ™ÿπŸÖŸÑ ÿ®ÿ¥ŸÉŸÑ ŸÖÿ´ÿßŸÑŸä ÿπŸÑŸâ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ŸàÿßŸÑŸÖŸÇÿßÿ≥ÿßÿ™.</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row mt-5">
                    <div class="col-12 text-center">
                        <h2 class="display-5 fw-bold mb-3">ŸÖŸäÿ≤ÿßÿ™ ŸÖŸÖŸäÿ≤ÿ© - ŸÖÿ¨ÿßŸÜÿßŸã ŸÑŸÉ!</h2>
                        <p class="lead mb-5">ŸÖŸäÿ≤ÿßÿ™ ÿßÿ≠ÿ™ÿ±ÿßŸÅŸäÿ© ŸÖÿØŸÅŸàÿπÿ© ŸÅŸä ŸÖŸÜÿµÿßÿ™ ÿ£ÿÆÿ±Ÿâÿå ŸÖÿ™ÿßÿ≠ÿ© ŸÖÿ¨ÿßŸÜŸãÿß ÿπŸÑŸâ Turkify</p>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-4 mb-4">
                        <div class="card h-100 border-2 border-primary">
                            <div class="card-body text-center p-4">
                                <div class="feature-icon">
                                    <i class="fas fa-globe"></i>
                                </div>
                                <h4 class="mb-3">ŸÜÿ∑ÿßŸÇÿßÿ™ ŸÖÿÆÿµÿµÿ©</h4>
                                <p>ÿßÿ≥ÿ™ÿÆÿØŸÖ ŸÜÿ∑ÿßŸÇŸÉ ÿßŸÑÿÆÿßÿµ ŸÑÿ•ŸÜÿ¥ÿßÿ° ÿ±Ÿàÿßÿ®ÿ∑ ŸÇÿµŸäÿ±ÿ© ŸÖŸÖŸäÿ≤ÿ©.</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-4">
                        <div class="card h-100 border-2 border-primary">
                            <div class="card-body text-center p-4">
                                <div class="feature-icon">
                                    <i class="fas fa-lock"></i>
                                </div>
                                <h4 class="mb-3">ÿ≠ŸÖÿßŸäÿ© ÿ®ŸÉŸÑŸÖÿ© ŸÖÿ±Ÿàÿ±</h4>
                                <p>ÿ£ÿ∂ŸÅ ÿ∑ÿ®ŸÇÿ© ÿ•ÿ∂ÿßŸÅŸäÿ© ŸÖŸÜ ÿßŸÑÿ£ŸÖÿßŸÜ ŸÑÿ±Ÿàÿßÿ®ÿ∑ŸÉ ÿßŸÑÿ≠ÿ≥ÿßÿ≥ÿ©.</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-4">
                        <div class="card h-100 border-2 border-primary">
                            <div class="card-body text-center p-4">
                                <div class="feature-icon">
                                    <i class="fas fa-hourglass-half"></i>
                                </div>
                                <h4 class="mb-3">ÿßŸÜÿ™Ÿáÿßÿ° ÿßŸÑÿ±Ÿàÿßÿ®ÿ∑</h4>
                                <p>ÿ≠ÿØÿØ ÿ™Ÿàÿßÿ±ŸäÿÆ ÿßŸÜÿ™Ÿáÿßÿ° ŸÑŸÑÿ±Ÿàÿßÿ®ÿ∑ ÿßŸÑŸÖÿ§ŸÇÿ™ÿ©.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!-- Smart Algorithms Panel -->
<section id="algorithms">
    <div id="algorithmsPanel" style="display: none;">
        <div class="row mb-5">
            <div class="col-12 text-center">
                <h2 class="display-5 fw-bold mb-3">ü§ñ ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™ ÿßŸÑÿ∞ŸÉŸäÿ©</h2>
                <p class="lead mb-5">15 ÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿ© ŸÖÿ™ŸÇÿØŸÖÿ© ŸÑÿ™ÿ≠ÿ≥ŸäŸÜ ÿ£ÿØÿßÿ° ŸÖŸÜÿµÿ™ŸÉ</p>
            </div>
        </div>

        <!-- Algorithm Controls -->
        <div class="row mb-4">
            <div class="col-md-6">
                <div class="card algorithm-control-card">
                    <div class="card-header">
                        <i class="fas fa-brain me-2"></i>ÿßŸÑÿ™ÿ≠ŸÉŸÖ ŸÅŸä ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label">ÿ™ŸÅÿπŸäŸÑ ÿ¨ŸÖŸäÿπ ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™:</label>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="masterAlgorithmSwitch">
                                <label class="form-check-label" for="masterAlgorithmSwitch">
                                    ÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑŸÜÿ∏ÿßŸÖ ÿßŸÑÿ∞ŸÉŸä
                                </label>
                            </div>
                        </div>
                        <button class="btn btn-primary" id="runAllAlgorithms">
                            <i class="fas fa-play me-2"></i>ÿ™ÿ¥ÿ∫ŸäŸÑ ÿ¨ŸÖŸäÿπ ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™
                        </button>
                        <button class="btn btn-outline-info ms-2" id="algorithmReport">
                            <i class="fas fa-chart-line me-2"></i>ÿ™ŸÇÿ±Ÿäÿ± ÿßŸÑÿ£ÿØÿßÿ°
                        </button>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card algorithm-status-card">
                    <div class="card-header">
                        <i class="fas fa-tachometer-alt me-2"></i>ÿ≠ÿßŸÑÿ© ÿßŸÑŸÜÿ∏ÿßŸÖ
                    </div>
                    <div class="card-body">
                        <div class="algorithm-metric">
                            <span>ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™ ÿßŸÑŸÜÿ¥ÿ∑ÿ©:</span>
                            <span id="activeAlgorithmsCount" class="badge bg-success">0/15</span>
                        </div>
                        <div class="algorithm-metric">
                            <span>ŸÖÿπÿØŸÑ ÿßŸÑÿ£ÿØÿßÿ°:</span>
                            <span id="performanceRate" class="badge bg-info">0%</span>
                        </div>
                        <div class="algorithm-metric">
                            <span>ÿ¢ÿÆÿ± ÿ™ÿ≠ÿØŸäÿ´:</span>
                            <span id="lastAlgorithmUpdate" class="text-muted">ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÑÿ™ÿ¥ÿ∫ŸäŸÑ</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Algorithm Categories -->
        <div class="algorithm-categories mb-4">
            <div class="btn-group w-100" role="group">
                <button type="button" class="btn btn-outline-primary active" data-category="all">ÿßŸÑŸÉŸÑ</button>
                <button type="button" class="btn btn-outline-primary" data-category="analytics">ÿ™ÿ≠ŸÑŸäŸÑÿßÿ™</button>
                <button type="button" class="btn btn-outline-primary" data-category="prediction">ÿ™ŸÜÿ®ÿ§ÿßÿ™</button>
                <button type="button" class="btn btn-outline-primary" data-category="security">ÿ£ŸÖÿßŸÜ</button>
                <button type="button" class="btn btn-outline-primary" data-category="optimization">ÿ™ÿ≠ÿ≥ŸäŸÜ</button>
            </div>
        </div>

        <!-- Algorithms Grid -->
        <div class="algorithms-grid" id="algorithmsGrid">
            <!-- ÿ≥Ÿäÿ™ŸÖ ŸÖŸÑÿ§Ÿáÿß ÿ®ŸÄ JavaScript -->
        </div>

        <!-- Algorithm Results -->
        <div class="row mt-5">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-chart-bar me-2"></i>ŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™
                    </div>
                    <div class="card-body">
                        <div id="algorithmResults" class="algorithm-results">
                            <p class="text-muted text-center">ŸÑŸÖ Ÿäÿ™ŸÖ ÿ™ÿ¥ÿ∫ŸäŸÑ ÿ£Ÿä ÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿ© ÿ®ÿπÿØ</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
        <!-- Redirect Panel -->
        <div id="redirectPanel" class="redirect-container" style="display: none;">
            <div class="ad-container">
                <h6>ÿ•ÿπŸÑÿßŸÜÿßÿ™ ŸÖŸÜ ÿ¥ÿ±ŸÉÿßÿ¶ŸÜÿß</h6>
                <div class="ad-placeholder ad-350x50">
                    AdSterra Ad (350√ó50)
                </div>
            </div>
            
            
            <!-- ÿ®ÿ∑ÿßŸÇÿ© ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑŸÖÿ≠ÿØÿ´ÿ© -->
<div class="content-card" id="contentCard" style="display: block;">
    <!-- ÿ•ÿπŸÑÿßŸÜ ÿπŸÑŸàŸä -->
    <div class="ad-container" style="margin: 20px 0;">
        <div class="ad-placeholder ad-350x50">
            AdSterra Ad (350√ó50)
        </div>
    </div>
    
    <!-- ÿµŸàÿ±ÿ© ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ -->
    <div class="content-image-container">
        <img id="contentThumbnail" 
             src="https://via.placeholder.com/800x300/4A154B/FFFFFF?text=ÿ¨ÿßÿ±Ÿä+ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ..." 
             class="content-thumbnail" 
             alt="ÿµŸàÿ±ÿ© ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ" 
             style="display: block; visibility: visible;"
             onerror="this.src='https://via.placeholder.com/800x300/4A154B/FFFFFF?text=ŸÑÿß+ÿ™Ÿàÿ¨ÿØ+ÿµŸàÿ±ÿ©';">
    </div>
    
    <!-- ÿ•ÿπŸÑÿßŸÜ Ÿàÿ≥ÿ∑Ÿä -->
    <div class="ad-container" style="margin: 20px 0;">
        <div class="ad-placeholder ad-350x250">
            AdSterra Ad (350√ó250)
        </div>
    </div>
    
    <!-- ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ -->
    <div class="content-info" style="display: block; visibility: visible;">
        <!-- ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿ£ÿ≥ÿßÿ≥Ÿäÿ© -->
        <div class="content-meta" style="display: flex; visibility: visible;">
            <span id="contentType" class="content-type" style="display: inline-block;">ŸÖÿ≥ŸÑÿ≥ŸÑ</span>
            <span id="contentEpisode" class="content-episode" style="display: none;">ÿßŸÑÿ≠ŸÑŸÇÿ© 1</span>
            <span id="contentDate" class="content-date" style="display: none;">ÿßŸÑŸäŸàŸÖ</span>
        </div>
        
        <!-- ÿπŸÜŸàÿßŸÜ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ -->
        <h2 id="contentTitle" class="content-title" style="display: block; visibility: visible;">
            ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ŸÑÿ≥ŸÑ
        </h2>
        
        <!-- ŸàÿµŸÅ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ -->
        <p id="contentDescription" class="content-description" style="display: block; visibility: visible;">
            ŸàÿµŸÅ ÿßŸÑŸÖÿ≥ŸÑÿ≥ŸÑ Ÿàÿ£ÿ≠ÿØÿßÿ´ ÿßŸÑÿ≠ŸÑŸÇÿ© ÿßŸÑÿ≠ÿßŸÑŸäÿ©
        </p>
        
        <!-- ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿ•ÿ∂ÿßŸÅŸäÿ© -->
        <div class="content-stats" style="display: flex; gap: 20px; margin-top: 15px;">
            <div class="stat-item">
                <i class="fas fa-eye text-muted"></i>
                <span id="contentViews" class="ms-2">0 ŸÖÿ¥ÿßŸáÿØÿ©</span>
            </div>
            <div class="stat-item">
                <i class="fas fa-calendar text-muted"></i>
                <span id="contentCreated" class="ms-2">ÿßŸÑŸäŸàŸÖ</span>
            </div>
        </div>
    </div>
</div>
            
            <!-- Update 1: Redirect text based on content type -->
            <div class="redirect-text" id="redirectText">
                <span id="redirectMessage">Ÿäÿ™ŸÖ ÿ™Ÿàÿ¨ŸäŸáŸÉ ÿßŸÑÿ¢ŸÜ</span>
            </div>
            
            <div class="loader" id="redirectLoader"></div>
            <div class="security-text">
                <p><i class="fas fa-shield-alt me-2"></i>ÿßÿ™ÿµÿßŸÑŸÉ ÿ¢ŸÖŸÜ ŸàŸÖÿ¥ŸÅŸëÿ±</p>
                <p><i class="fas fa-bolt me-2"></i>ŸÖÿØÿπŸàŸÖ ŸÖŸÜ ŸÖŸÜÿµÿ© Turkify Pro ŸÑÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ±Ÿàÿßÿ®ÿ∑</p>
            </div>
            <button class="btn btn-primary redirect-btn" id="manualRedirectBtn" style="display: none;" aria-label="Continue to destination">
                <i class="fas fa-arrow-right me-2"></i>ÿßŸÑŸÖÿ™ÿßÿ®ÿπÿ© ÿ•ŸÑŸâ ÿßŸÑŸàÿ¨Ÿáÿ©
            </button>
        </div>
    </div>
    
    <!-- Link Generated Modal -->
    <div class="modal fade" id="linkModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-check-circle me-2"></i>ÿ™ŸÖ ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑÿ±ÿßÿ®ÿ∑ ÿ®ŸÜÿ¨ÿßÿ≠!</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-4">
                        <p class="mb-1">ÿ±ÿßÿ®ÿ∑ŸÉ ÿßŸÑŸÇÿµŸäÿ± ÿßŸÑÿ¨ÿØŸäÿØ:</p>
                        <div class="input-group">
                            <input type="text" class="form-control form-control-lg" id="generatedLink" readonly aria-label="Generated link">
                            <button class="btn btn-primary" id="copyLinkBtn" aria-label="Copy link">
                                <i class="fas fa-copy me-1"></i>ŸÜÿ≥ÿÆ
                            </button>
                        </div>
                    </div>
                    
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        ÿ≥ŸäŸÇŸàŸÖ Ÿáÿ∞ÿß ÿßŸÑÿ±ÿßÿ®ÿ∑ ÿ®ÿ•ÿπÿßÿØÿ© ÿßŸÑÿ™Ÿàÿ¨ŸäŸá ÿ•ŸÑŸâ: <span id="originalLinkDisplay" class="fw-bold"></span>
                    </div>
                    
                    <div class="d-flex justify-content-between mt-4">
                        <button class="btn btn-outline-primary" id="viewAnalyticsBtn" aria-label="View analytics">
                            <i class="fas fa-chart-bar me-1"></i>ÿπÿ±ÿ∂ ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑÿßÿ™
                        </button>
                        <button class="btn btn-outline-success" id="shareLinkBtn" aria-label="Share link">
                            <i class="fas fa-share-alt me-1"></i>ŸÖÿ¥ÿßÿ±ÿ© ÿßŸÑÿ±ÿßÿ®ÿ∑
                        </button>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" aria-label="Close modal">ÿ•ÿ∫ŸÑÿßŸÇ</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Confirmation Modal -->
    <div class="modal fade" id="confirmationModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-exclamation-triangle me-2 text-warning"></i>ÿ™ÿ£ŸÉŸäÿØ ÿßŸÑÿπŸÖŸÑŸäÿ©</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p id="confirmationMessage">ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿ±ÿ∫ÿ®ÿ™ŸÉ ŸÅŸä ÿ≠ÿ∞ŸÅ Ÿáÿ∞ÿß ÿßŸÑÿ±ÿßÿ®ÿ∑ÿü</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ÿ•ŸÑÿ∫ÿßÿ°</button>
                    <button type="button" class="btn btn-danger" id="confirmActionBtn">ÿ™ÿ£ŸÉŸäÿØ</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Stats Modal -->
    <div class="modal fade" id="statsModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-chart-bar me-2"></i>ÿ™ÿ≠ŸÑŸäŸÑÿßÿ™ ÿßŸÑÿ±ÿßÿ®ÿ∑</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="stats-modal-content">
                        <div class="stats-header">
                         <h4 id="statsLinkTitle" class="stats-title">ÿ™ÿ≠ŸÑŸäŸÑÿßÿ™ ÿßŸÑÿ±ÿßÿ®ÿ∑</h4>
    <p class="text-muted">
        ÿßŸÑÿ±ÿßÿ®ÿ∑ ÿßŸÑŸÇÿµŸäÿ±: <a id="statsLinkUrl" href="#" target="_blank" class="text-decoration-none">ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ±ÿßÿ®ÿ∑</a>
    </p>
    <div class="time-filter">
        <button class="time-btn active">ÿßŸÑŸäŸàŸÖ</button>
        <button class="time-btn">ÿ£ÿ≥ÿ®Ÿàÿπ</button>
        <button class="time-btn">ÿ¥Ÿáÿ±</button>
        <button class="time-btn">3 ÿ£ÿ¥Ÿáÿ±</button>
        <button class="time-btn">ÿ≥ŸÜÿ©</button>
    </div>
</div>
                        
                        <div class="stats-grid">
                            <div class="stats-card">
                                <div class="stats-card-title"><i class="fas fa-users"></i> ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿ≤Ÿäÿßÿ±ÿßÿ™</div>
                                <div class="stats-number" id="totalVisits">1,842</div>
                            </div>
                            <div class="stats-card">
                                <div class="stats-card-title"><i class="fas fa-mouse-pointer"></i> ÿßŸÑŸÜŸÇÿ±ÿßÿ™ ÿßŸÑŸäŸàŸÖ</div>
                                <div class="stats-number" id="todayVisits">56</div>
                            </div>
                            <div class="stats-card">
                                <div class="stats-card-title"><i class="fas fa-map-marker-alt"></i> ÿßŸÑÿ®ŸÑÿØ ÿßŸÑÿ£ŸÉÿ´ÿ± ÿ≤Ÿäÿßÿ±ÿ©</div>
                                <div class="stats-number" id="topCountry">ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©</div>
                            </div>
                            <div class="stats-card">
                                <div class="stats-card-title"><i class="fas fa-desktop"></i> ÿßŸÑÿ¨Ÿáÿßÿ≤ ÿßŸÑÿ£ŸÉÿ´ÿ± ÿßÿ≥ÿ™ÿÆÿØÿßŸÖÿßŸã</div>
                                <div class="stats-number" id="topDevice">ÿßŸÑŸáÿßÿ™ŸÅ</div>
                            </div>
                        </div>
                        
                        <div class="row mt-4">
                            <div class="col-md-6">
                                <div class="stats-card">
                                    <div class="stats-card-title"><i class="fas fa-chart-line"></i> ÿßŸÑŸÜŸÇÿ±ÿßÿ™ ŸÖÿπ ŸÖÿ±Ÿàÿ± ÿßŸÑŸàŸÇÿ™</div>
                                    <div class="stats-chart">
                                        <canvas id="visitsChart"></canvas>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="stats-card">
                                    <div class="stats-card-title"><i class="fas fa-globe-asia"></i> ÿßŸÑÿ™Ÿàÿ≤Ÿäÿπ ÿßŸÑÿ¨ÿ∫ÿ±ÿßŸÅŸä</div>
                                    <div class="stats-chart">
                                        <canvas id="geoChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-4">
                            <div class="col-md-6">
                                <div class="stats-card">
                                    <div class="stats-card-title"><i class="fas fa-laptop"></i> ÿ£ŸÜŸàÿßÿπ ÿßŸÑÿ£ÿ¨Ÿáÿ≤ÿ©</div>
                                    <div class="stats-chart">
                                        <canvas id="devicesChart"></canvas>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="stats-card">
                                    <div class="stats-card-title"><i class="fas fa-share-alt"></i> ŸÖÿµÿßÿØÿ± ÿßŸÑÿ≤Ÿäÿßÿ±ÿßÿ™</div>
                                    <div class="stats-chart">
                                        <canvas id="sourcesChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ÿ•ÿ∫ŸÑÿßŸÇ</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Earnings Modal -->
    <div class="modal fade" id="earningsModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-dollar-sign me-2 text-success"></i>ÿ•Ÿäÿ±ÿßÿØÿßÿ™ ÿßŸÑÿ±ÿßÿ®ÿ∑</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="stats-modal-content">
                        <div class="stats-header">
                            <h4 id="earningsLinkTitle" class="stats-title">ÿ™ÿÆŸÅŸäÿ∂ÿßÿ™ ÿßŸÑÿµŸäŸÅ</h4>
                            <div class="time-filter">
                                <button class="time-btn active">ÿßŸÑŸäŸàŸÖ</button>
                                <button class="time-btn">ÿ£ÿ≥ÿ®Ÿàÿπ</button>
                                <button class="time-btn">ÿ¥Ÿáÿ±</button>
                                <button class="time-btn">3 ÿ£ÿ¥Ÿáÿ±</button>
                                <button class="time-btn">ÿ≥ŸÜÿ©</button>
                            </div>
                        </div>
                        
                        <div class="earnings-stats">
    <div class="earnings-card">
        <div id="totalEarnings" class="earnings-value">$0.00</div>
        <div class="earnings-label">ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿ£ÿ±ÿ®ÿßÿ≠</div>
    </div>
    <div class="earnings-card">
        <div id="totalImpressions" class="earnings-value">0</div>
        <div class="earnings-label">ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÖÿ¥ÿßŸáÿØÿßÿ™</div>
    </div>
    <div class="earnings-card">
        <div id="averageRPM" class="earnings-value">$0.00</div>
        <div class="earnings-label">ŸÖÿ™Ÿàÿ≥ÿ∑ ÿßŸÑÿ±ÿ®ÿ≠ ŸÑŸÉŸÑ 1000 ŸÖÿ¥ÿßŸáÿØÿ©</div>
    </div>
    <div class="earnings-card">
        <div id="todayEarnings" class="earnings-value">$0.00</div>
        <div class="earnings-label">ÿ£ÿ±ÿ®ÿßÿ≠ ÿßŸÑŸäŸàŸÖ</div>
    </div>
</div>

<div class="earnings-breakdown mt-4">
    <h6 class="mb-3">ÿ™ŸÅÿµŸäŸÑ ÿßŸÑÿ£ÿ±ÿ®ÿßÿ≠ ÿ≠ÿ≥ÿ® ÿßŸÑŸÖŸÜÿ∑ŸÇÿ©:</h6>
    <div class="row">
        <div class="col-md-6">
            <div class="earnings-region-card">
                <div class="d-flex justify-content-between align-items-center">
                    <span><i class="fas fa-flag me-2"></i>ÿßŸÑÿ®ŸÑÿØÿßŸÜ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</span>
                    <div class="text-end">
                        <div id="arabVisits" class="fw-bold">0 ÿ≤Ÿäÿßÿ±ÿ©</div>
                        <small id="arabEarnings" class="text-success">$0.00</small>
                    </div>
                </div>
                <div class="progress mt-2" style="height: 5px;">
                    <div id="arabProgress" class="progress-bar bg-success" style="width: 0%"></div>
                </div>
                <small class="text-muted">ŸÖÿπÿØŸÑ: $1.00 ŸÑŸÉŸÑ 1000 ÿ≤Ÿäÿßÿ±ÿ©</small>
            </div>
        </div>
        <div class="col-md-6">
            <div class="earnings-region-card">
                <div class="d-flex justify-content-between align-items-center">
                    <span><i class="fas fa-globe me-2"></i>ÿßŸÑÿ®ŸÑÿØÿßŸÜ ÿßŸÑÿ£ÿ¨ŸÜÿ®Ÿäÿ©</span>
                    <div class="text-end">
                        <div id="foreignVisits" class="fw-bold">0 ÿ≤Ÿäÿßÿ±ÿ©</div>
                        <small id="foreignEarnings" class="text-primary">$0.00</small>
                    </div>
                </div>
                <div class="progress mt-2" style="height: 5px;">
                    <div id="foreignProgress" class="progress-bar bg-primary" style="width: 0%"></div>
                </div>
                <small class="text-muted">ŸÖÿπÿØŸÑ: $3.00 ŸÑŸÉŸÑ 1000 ÿ≤Ÿäÿßÿ±ÿ©</small>
            </div>
        </div>
    </div>
</div>
                        
                        <div class="earnings-chart">
                            <canvas id="earningsChart"></canvas>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ÿ•ÿ∫ŸÑÿßŸÇ</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Global Loader -->
    <div class="global-loader" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255,255,255,0.7); z-index: 2000; justify-content: center; align-items: center;">
        <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;"></div>
    </div>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script src="https://www.google.com/recaptcha/api.js?render=6LesFYErAAAAAOpY8Pbc0furepnxPt0WyJorH5Qw"></script>
    
    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyC5VmidRUmMF6W3vvl44zznScS1gn2GHn0",
            authDomain: "turkify-redirect.firebaseapp.com",
            projectId: "turkify-redirect",
            storageBucket: "turkify-redirect.appspot.com",
            messagingSenderId: "986441766029",
            appId: "1:986441766029:web:dd6a13879306472e43bec4"
        };
        
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        
        // ŸÅÿ≠ÿµ Firebase ŸÇÿ®ŸÑ ÿßŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ
function checkFirebaseConnection() {
    if (!firebase || !firebase.firestore) {
        console.error('Firebase ÿ∫Ÿäÿ± ŸÖÿ™ŸàŸÅÿ±');
        showNotification('error', 'ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿßÿ™ÿµÿßŸÑ ÿ®ŸÇÿßÿπÿØÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™');
        return false;
    }
    return true;
}

// ÿ™ÿ≠ÿØŸäÿ´ ÿØÿßŸÑÿ© setLoading ŸÑÿ™ŸÉŸàŸÜ ÿ£ŸÉÿ´ÿ± ÿ£ŸÖÿßŸÜÿßŸã
function setLoading(show) {
    const loader = document.querySelector('.global-loader');
    if (loader) {
        loader.style.display = show ? 'flex' : 'none';
    }
}
        
        // DOM Elements
        const adminPanel = document.getElementById('adminPanel');
        const analyticsPanel = document.getElementById('analyticsPanel');
        const redirectPanel = document.getElementById('redirectPanel');
        const featuresPanel = document.getElementById('featuresPanel');
        const linksTable = document.getElementById('linksTable');
        const signInButton = document.getElementById('signInButton');
        const signOutButton = document.getElementById('signOutButton');
        const userProfile = document.getElementById('userProfile');
        const userPhoto = document.getElementById('userPhoto');
        const userName = document.getElementById('userName');
        const authButtons = document.getElementById('authButtons');
        const navLinks = document.querySelectorAll('.nav-link');
        const adminOnlyElements = document.querySelectorAll('.admin-only');
        const globalLoader = document.querySelector('.global-loader');
        const generateBtn = document.getElementById('generateBtn');
        const updateBtn = document.getElementById('updateBtn');
        const redirectText = document.getElementById('redirectText');
        const redirectMessage = document.getElementById('redirectMessage');
        const backToHomeBtn = document.getElementById('backToHomeBtn');
        
        // Current editing link ID
        let currentEditingLinkId = null;
        
        // Set loading state
        function setLoading(show) {
            globalLoader.style.display = show ? 'flex' : 'none';
        }
        
        // ÿ™ŸÜÿ≥ŸäŸÇ ÿßŸÑÿ™ÿßÿ±ŸäÿÆ ŸàÿßŸÑŸàŸÇÿ™ ÿ®ÿßŸÑÿ•ŸÜÿ¨ŸÑŸäÿ≤Ÿäÿ©
        function formatFirestoreDateTime(timestamp) {
            const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp.seconds * 1000);
            return date.toLocaleString('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }
        
        // Initialize page based on URL
       
         // ÿ™ÿ≠ÿØŸäÿ´ ÿØÿßŸÑÿ© initPage ŸÑÿ™ÿ™ÿ∂ŸÖŸÜ ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™
function initPage() {
    const urlParams = new URLSearchParams(window.location.search);
    const linkId = urlParams.get('id');
    const hash = window.location.hash.substring(1);
    
    // Highlight active navigation item
    highlightActiveNav();
    
    if (linkId) {
        // ÿ™ÿ∑ÿ®ŸäŸÇ ÿ£ŸÜŸÖÿßÿ∑ ÿßŸÑÿ•ÿ∏Ÿáÿßÿ± ÿßŸÑŸÇÿ≥ÿ±Ÿä ŸÇÿ®ŸÑ ŸÖÿπÿßŸÑÿ¨ÿ© ÿ•ÿπÿßÿØÿ© ÿßŸÑÿ™Ÿàÿ¨ŸäŸá
        if (typeof forceShowElements === 'function') forceShowElements();
        setTimeout(() => {
            if (typeof showContentCard === 'function') showContentCard();
            handleRedirection(linkId);
        }, 100);
    } else {
        // ÿßŸÑÿ™ŸÜŸÇŸÑ ÿ≠ÿ≥ÿ® ÿßŸÑŸáÿßÿ¥
        switch(hash) {
            case 'admin':
                showAdminPanel();
                break;
            case 'analytics':
                showAnalytics();
                break;
            case 'algorithms':
                showAlgorithms();
                break;
            case 'dashboard':
                showDashboard();
                break;
            case 'super-admin':
                showSuperAdminPanel();
                break;
            case 'features':
                showFeatures();
                break;
            case 'home':
            case '':
            default:
                showFeatures();
                break;
        }
    }
}

// ÿ™ÿ≠ÿØŸäÿ´ ÿØÿßŸÑÿ© hideAllPanels
function hideAllPanels() {
    const panels = [
        'adminPanel',
        'analyticsPanel', 
        'redirectPanel',
        'featuresPanel',
        'algorithmsPanel'
    ];
    
    panels.forEach(panelId => {
        const panel = document.getElementById(panelId);
        if (panel) panel.style.display = 'none';
    });
    
    // ÿ•ÿÆŸÅÿßÿ° ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑÿØŸäŸÜÿßŸÖŸäŸÉŸä
    const dynamicContainers = [
        '.dashboard-container',
        '.super-admin-panel'
    ];
    
    dynamicContainers.forEach(selector => {
        const containers = document.querySelectorAll(selector);
        containers.forEach(container => container.remove());
    });
}
         
        // Highlight active navigation item
        function highlightActiveNav() {
            navLinks.forEach(link => {
                link.classList.remove('nav-active');
                if (window.location.hash === link.getAttribute('href')) {
                    link.classList.add('nav-active');
                }
            });
        }
        
        // Show admin panel
        function showAdminPanel() {
            hideAllPanels();
            adminPanel.classList.remove('admin-only');
            adminPanel.style.display = 'block';
            loadLinks();
        }
        
        // Show analytics panel
        function showAnalytics() {
            hideAllPanels();
            analyticsPanel.style.display = 'block';
            loadAnalytics();
        }
        
        // Show features panel
        function showFeatures() {
            hideAllPanels();
            featuresPanel.style.display = 'block';
        }
        
        // Hide all panels
        function hideAllPanels() {
            adminPanel.style.display = 'none';
            analyticsPanel.style.display = 'none';
            redirectPanel.style.display = 'none';
            featuresPanel.style.display = 'none';
        }
        
        // ÿØÿßŸÑÿ© ŸÖÿ≥ÿßÿπÿØÿ© ŸÑÿ¨ŸÑÿ® ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿ≤ÿßÿ¶ÿ± ŸÖŸÜ ip-api
        async function getVisitorInfo() {
            try {
                // Get IP from ipify
                const ipRes = await fetch('https://api.ipify.org?format=json');
                const ipData = await ipRes.json();
                const ip = ipData.ip;

                // Get location from ip-api.com
                const response = await fetch(`https://ip-api.com/json/${ip}?fields=status,message,country,countryCode,regionName,city,isp,org,query&lang=ar`);
                const data = await response.json();
                
                if (data.status === 'success') {
                    return {
                        country: data.country || "ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ",
                        region: data.regionName || "ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ",
                        city: data.city || "ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ",
                        ip: ip,
                        org: data.org || "ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ"
                    };
                }
                return {
                    country: "ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ",
                    region: "ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ",
                    city: "ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ",
                    ip: "ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ",
                    org: "ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ"
                };
            } catch (error) {
                console.error("Error getting visitor info:", error);
                return {
                    country: "ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ",
                    region: "ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ",
                    city: "ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ",
                    ip: "ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ",
                    org: "ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ"
                };
            }
        }

        // ÿØŸàÿßŸÑ ŸÖÿ≥ÿßÿπÿØÿ© ŸÑÿßŸÉÿ™ÿ¥ÿßŸÅ ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑÿ¨Ÿáÿßÿ≤
        function detectDeviceType() {
            const ua = navigator.userAgent.toLowerCase();
            if (ua.includes("smart-tv") || ua.includes("hbbtv") || ua.includes("appletv")) return "ÿ™ŸÑŸÅÿßÿ≤ ÿ∞ŸÉŸä";
            if (/mobile|iphone|ipod|android/.test(ua)) return "Ÿáÿßÿ™ŸÅ";
            if (/tablet|ipad/.test(ua)) return "ÿ™ÿßÿ®ŸÑÿ™";
            if (/windows|mac|linux/.test(ua)) return "ŸÉŸÖÿ®ŸäŸàÿ™ÿ±";
            return "ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ";
        }

        function detectOS() {
            const ua = navigator.userAgent;
            if (ua.includes("Android")) return "Android";
            if (ua.includes("iPhone") || ua.includes("iPad")) return "iOS";
            if (ua.includes("Windows")) return "Windows";
            if (ua.includes("Mac OS")) return "macOS";
            return "ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ";
        }

        function detectBrowser() {
            const ua = navigator.userAgent;
            if (ua.includes("Chrome")) return "Chrome";
            if (ua.includes("Firefox")) return "Firefox";
            if (ua.includes("Safari") && !ua.includes("Chrome")) return "Safari";
            if (ua.includes("Edge")) return "Edge";
            return "ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ";
        }

        function detectReferrer() {
            const ref = document.referrer;
            if (ref.includes("facebook")) return "ŸÅŸäÿ≥ÿ®ŸàŸÉ";
            if (ref.includes("instagram")) return "ÿ•ŸÜÿ≥ÿ™ÿ∫ÿ±ÿßŸÖ";
            if (ref.includes("youtube")) return "ŸäŸàÿ™ŸäŸàÿ®";
            if (ref.includes("twitter")) return "ÿ™ŸàŸäÿ™ÿ±";
            if (ref.includes("tiktok")) return "ÿ™ŸäŸÉ ÿ™ŸàŸÉ";
            return "ŸÖÿ®ÿßÿ¥ÿ±";
        }

       // ÿØÿßŸÑÿ© ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿ≤Ÿäÿßÿ±ÿ© ÿßŸÑŸÖÿ≠ÿØÿ´ÿ© ŸÑÿ™ŸàÿßŸÅŸÇ GitHub Pages
async function recordVisit(linkId) {
    try {
        // ÿ¨ŸÑÿ® ŸÖÿπŸÑŸàŸÖÿßÿ™ IP ÿ®ÿ∑ÿ±ŸäŸÇÿ© ŸÖÿ™ŸàÿßŸÅŸÇÿ© ŸÖÿπ GitHub Pages
        let ipInfo = {
            country: "ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ",
            region: "ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ", 
            city: "ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ",
            ip: "ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ",
            org: "ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ"
        };
        
        try {
            // ŸÖÿ≠ÿßŸàŸÑÿ© ÿ¨ŸÑÿ® ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÖŸàŸÇÿπ
            const response = await fetch('https://ipapi.co/json/');
            if (response.ok) {
                const data = await response.json();
                ipInfo = {
                    country: data.country_name || "ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ",
                    region: data.region || "ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ", 
                    city: data.city || "ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ",
                    ip: data.ip || "ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ",
                    org: data.org || "ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ"
                };
            }
        } catch (ipError) {
            console.log('ÿ™ÿπÿ∞ÿ± ÿ¨ŸÑÿ® ŸÖÿπŸÑŸàŸÖÿßÿ™ IP:', ipError.message);
        }

        const visitData = {
            timestamp: new Date(),
            linkId: linkId,
            country: ipInfo.country,
            region: ipInfo.region,
            city: ipInfo.city,
            ip: ipInfo.ip,
            org: ipInfo.org,
            device: detectDeviceType(),
            browser: detectBrowser(), 
            os: detectOS(),
            source: detectReferrer(),
            userAgent: navigator.userAgent.substring(0, 100) // ÿ™ŸÇŸäŸäÿØ ÿ∑ŸàŸÑ userAgent
        };

        // ÿ≠ŸÅÿ∏ ÿßŸÑÿ≤Ÿäÿßÿ±ÿ© ŸÅŸä Firebase
        await db.collection('visits').add(visitData);
        
        // ÿ™ÿ≠ÿØŸäÿ´ ÿπÿØÿßÿØ ÿßŸÑŸÜŸÇÿ±ÿßÿ™
        await db.collection('links').doc(linkId).update({
            clicks: firebase.firestore.FieldValue.increment(1),
            lastVisit: firebase.firestore.FieldValue.serverTimestamp()
        });

        console.log('ÿ™ŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿ≤Ÿäÿßÿ±ÿ© ÿ®ŸÜÿ¨ÿßÿ≠');

    } catch (error) {
        console.error('ŸÅÿ¥ŸÑ ŸÅŸä ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿ≤Ÿäÿßÿ±ÿ©:', error);
        
        // ŸÅŸä ÿ≠ÿßŸÑÿ© ÿßŸÑŸÅÿ¥ŸÑÿå ÿ≥ÿ¨ŸÑ ÿ≤Ÿäÿßÿ±ÿ© ÿ£ÿ≥ÿßÿ≥Ÿäÿ© ÿπŸÑŸâ ÿßŸÑÿ£ŸÇŸÑ
        try {
            await db.collection('links').doc(linkId).update({
                clicks: firebase.firestore.FieldValue.increment(1)
            });
        } catch (basicError) {
            console.error('ŸÅÿ¥ŸÑ ŸÅŸä ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿä:', basicError);
        }
    }
}
        
        // ÿØÿßŸÑÿ© ÿ•ŸÜÿ¥ÿßÿ° ŸàÿµŸÅ ÿ™ÿ¥ŸàŸäŸÇŸä ÿ®ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ Deepseek API
        async function generateEpisodeDescription(linkId, seriesName, episodeNum) {
            try {
                const SECRET_KEY = "MySuperSecret123!"; // Ÿäÿ¨ÿ® ÿ£ŸÜ Ÿäÿ™ÿ∑ÿßÿ®ŸÇ ŸÖÿπ Netlify
                const response = await fetch('/.netlify/functions/deepseek-proxy', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'x-secret-key': SECRET_KEY
                    },
                    body: JSON.stringify({ 
                        seriesName, 
                        episodeNum,
                        linkId
                    })
                });

                if (!response.ok) throw new Error('ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿ¥ÿ®ŸÉÿ©');
                
                const data = await response.json();
                return data.description;
                
            } catch (error) {
                console.error('ŸÅÿ¥ŸÑ ŸÅŸä ÿ™ŸàŸÑŸäÿØ ÿßŸÑŸàÿµŸÅ:', error);
                
                try {
                    const linkDoc = await db.collection('links').doc(linkId).get();
                    if (linkDoc.exists) {
                        const linkData = linkDoc.data();
                        
                        if (linkData.socialDescription) {
                            return linkData.socialDescription;
                        }
                        
                        return `ŸÖÿ≥ŸÑÿ≥ŸÑ ${seriesName} - ÿßŸÑÿ≠ŸÑŸÇÿ© ${episodeNum}: ${linkData.seriesName} Ÿäÿ™ŸÜÿßŸàŸÑ ŸÇÿµÿ© ÿ¥ŸäŸÇÿ© ÿ™ÿ≥ÿ™ÿ≠ŸÇ ÿßŸÑŸÖÿ¥ÿßŸáÿØÿ©`;
                    }
                } catch (firestoreError) {
                    console.error('ŸÅÿ¥ŸÑ ŸÅŸä ÿ¨ŸÑÿ® ÿßŸÑŸàÿµŸÅ ÿßŸÑŸÖÿÆÿ≤ŸÜ:', firestoreError);
                }
                
                return `ÿ¥ÿßŸáÿØ ÿßŸÑÿ≠ŸÑŸÇÿ© ${episodeNum} ŸÖŸÜ ${seriesName} ÿ®ÿ£ÿ≠ÿØÿßÿ´ ŸÖÿ¥ŸàŸÇÿ© Ÿàÿ™ÿ∑Ÿàÿ±ÿßÿ™ ÿ∫Ÿäÿ± ŸÖÿ™ŸàŸÇÿπÿ©!`;
            }
        }

       // Handle redirection with proper content display
async function handleRedirection(linkId) {
    console.log('ÿ®ÿØÿ° ŸÖÿπÿßŸÑÿ¨ÿ© ÿ•ÿπÿßÿØÿ© ÿßŸÑÿ™Ÿàÿ¨ŸäŸá ŸÑŸÑÿ±ÿßÿ®ÿ∑:', linkId);
    
    hideAllPanels();
    redirectPanel.style.display = 'block';
    
    // ÿπŸÜÿßÿµÿ± ÿßŸÑÿ®ÿ∑ÿßŸÇÿ©
    const redirectLoader = document.getElementById('redirectLoader');
    const contentCard = document.getElementById('contentCard');
    const contentThumbnail = document.getElementById('contentThumbnail');
    const contentType = document.getElementById('contentType');
    const contentEpisode = document.getElementById('contentEpisode');
    const contentDate = document.getElementById('contentDate');
    const contentTitle = document.getElementById('contentTitle');
    const contentDescription = document.getElementById('contentDescription');
    const contentViews = document.getElementById('contentViews');
    const contentCreated = document.getElementById('contentCreated');
    
    // ÿ•ÿ∏Ÿáÿßÿ± ÿßŸÑÿ®ÿ∑ÿßŸÇÿ© ŸÅŸàÿ±ÿßŸã
    if (contentCard) {
        contentCard.style.display = 'block';
        contentCard.style.visibility = 'visible';
    }
    
    redirectLoader.style.display = 'block';
    redirectMessage.textContent = 'ÿ¨ÿßÿ±Ÿä ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ...';
    
    try {
        // ÿ¨ŸÑÿ® ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ±ÿßÿ®ÿ∑ ŸÖŸÜ Firestore
        console.log('ÿ¨ŸÑÿ® ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ±ÿßÿ®ÿ∑ ŸÖŸÜ Firestore...');
        const linkDoc = await db.collection('links').doc(linkId).get();
        
        if (!linkDoc.exists) {
            throw new Error('ÿßŸÑÿ±ÿßÿ®ÿ∑ ÿ∫Ÿäÿ± ŸÖŸàÿ¨ŸàÿØ ŸÅŸä ŸÇÿßÿπÿØÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™');
        }
        
        const linkData = linkDoc.data();
        console.log('ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ±ÿßÿ®ÿ∑ ÿßŸÑŸÖÿ¨ŸÑÿ®ÿ©:', linkData);
        
        const destinationUrl = linkData.originalUrl;
        
        // ÿ™ÿπÿ®ÿ¶ÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ©
        if (contentTitle) {
            contentTitle.textContent = linkData.seriesName || 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ';
            contentTitle.style.display = 'block';
            contentTitle.style.visibility = 'visible';
        }
        
        if (contentType) {
            contentType.textContent = getTypeName(linkData.linkType || 'series');
            contentType.style.display = 'inline-block';
            contentType.style.visibility = 'visible';
        }
        
        // ÿ™ÿ≠ÿØŸäÿØ Ÿàÿπÿ±ÿ∂ ÿßŸÑÿµŸàÿ±ÿ©
        const imageUrl = linkData.socialImage || 
                        linkData.thumbnailUrl || 
                        'https://via.placeholder.com/800x300/4A154B/FFFFFF?text=' + 
                        encodeURIComponent(linkData.seriesName || 'ŸÖÿ≠ÿ™ŸàŸâ');
        
        if (contentThumbnail) {
            contentThumbnail.src = imageUrl;
            contentThumbnail.alt = linkData.seriesName || 'ÿµŸàÿ±ÿ© ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ';
            contentThumbnail.style.display = 'block';
            contentThumbnail.style.visibility = 'visible';
            
            // ŸÖÿπÿßŸÑÿ¨ÿ© ŸÅÿ¥ŸÑ ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿµŸàÿ±ÿ©
            contentThumbnail.onerror = function() {
                this.src = 'https://via.placeholder.com/800x300/4A154B/FFFFFF?text=' + 
                          encodeURIComponent('ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿµŸàÿ±ÿ©');
                console.log('ŸÅÿ¥ŸÑ ŸÅŸä ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿµŸàÿ±ÿ©ÿå ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿµŸàÿ±ÿ© ÿ®ÿØŸäŸÑÿ©');
            };
            
            console.log('ÿ™ŸÖ ÿ™ÿπŸäŸäŸÜ ÿµŸàÿ±ÿ© ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ:', imageUrl);
        }
        
        // ÿ≠ÿ≥ÿßÿ® ÿ±ŸÇŸÖ ÿßŸÑÿ≠ŸÑŸÇÿ© ŸÑŸÑŸÖÿ≥ŸÑÿ≥ŸÑÿßÿ™
        let episodeNum = 1;
        let showEpisodeInfo = false;
        
        if (linkData.linkType === 'series' && linkData.startingEpisode && linkData.startDate) {
            const createdAt = linkData.startDate.toDate();
            const now = new Date();
            
            // ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÅÿ±ŸÇ ÿ®ÿßŸÑÿ£ŸäÿßŸÖ
            const timezoneOffset = 3; // ÿ™ŸàŸÇŸäÿ™ ÿßŸÑŸÖŸÜÿ∑ŸÇÿ©
            const nowUTC = new Date(now.getTime() + (now.getTimezoneOffset() * 60000));
            const startUTC = new Date(createdAt.getTime() + (createdAt.getTimezoneOffset() * 60000));
            
            nowUTC.setHours(nowUTC.getHours() + timezoneOffset);
            startUTC.setHours(startUTC.getHours() + timezoneOffset);
            
            const msPerDay = 24 * 60 * 60 * 1000;
            const diffDays = Math.floor((nowUTC - startUTC) / msPerDay);
            
            episodeNum = linkData.startingEpisode + diffDays;
            
            if (linkData.totalEpisodes && episodeNum > linkData.totalEpisodes) {
                episodeNum = linkData.totalEpisodes;
            }
            
            showEpisodeInfo = true;
            
            // ÿ™ÿ≠ÿØŸäÿ´ ÿ±ÿ≥ÿßŸÑÿ© ÿßŸÑÿ™Ÿàÿ¨ŸäŸá
            redirectMessage.innerHTML = `ÿ≥Ÿäÿ™ŸÖ ÿ™Ÿàÿ¨ŸäŸáŸÉ ŸÑŸÖÿ¥ÿßŸáÿØÿ© ÿ≠ŸÑŸÇÿ© ÿßŸÑŸäŸàŸÖ <span class="highlight">${episodeNum}</span> ŸÖŸÜ ÿßŸÑŸÖÿ≥ŸÑÿ≥ŸÑ:<br><span class="highlight">${linkData.seriesName}</span>`;
        } else {
            redirectMessage.innerHTML = `ÿ≥Ÿäÿ™ŸÖ ÿ™Ÿàÿ¨ŸäŸáŸÉ ÿ•ŸÑŸâ <span class="highlight">${getTypeName(linkData.linkType)}</span>:<br><span class="highlight">${linkData.seriesName}</span>`;
        }
        
        // ÿ•ÿ∏Ÿáÿßÿ± ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿ≠ŸÑŸÇÿ©
        if (showEpisodeInfo && contentEpisode) {
            contentEpisode.textContent = `ÿßŸÑÿ≠ŸÑŸÇÿ© ${episodeNum}`;
            contentEpisode.style.display = 'inline-block';
            contentEpisode.style.visibility = 'visible';
        } else if (contentEpisode) {
            contentEpisode.style.display = 'none';
        }
        
        // ÿπÿ±ÿ∂ ÿßŸÑÿ™ÿßÿ±ŸäÿÆ
        if (contentDate) {
            const today = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            contentDate.textContent = today.toLocaleDateString('ar-EG', options);
            contentDate.style.display = 'inline-block';
            contentDate.style.visibility = 'visible';
        }
        
        // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸàÿµŸÅ
        let description = '';
        if (linkData.linkType === 'series') {
            try {
                description = await generateEpisodeDescription(linkId, linkData.seriesName, episodeNum);
            } catch (error) {
                console.log('ŸÅÿ¥ŸÑ ŸÅŸä ÿ™ŸàŸÑŸäÿØ ÿßŸÑŸàÿµŸÅ:', error);
                description = linkData.socialDescription || `ÿ¥ÿßŸáÿØ ÿßŸÑÿ≠ŸÑŸÇÿ© ${episodeNum} ŸÖŸÜ ${linkData.seriesName}`;
            }
        } else {
            description = linkData.socialDescription || linkData.seriesName || 'ŸÑÿß ŸäŸàÿ¨ÿØ ŸàÿµŸÅ ŸÖÿ™ÿßÿ≠';
        }
        
        if (contentDescription) {
            contentDescription.textContent = description;
            contentDescription.style.display = 'block';
            contentDescription.style.visibility = 'visible';
        }
        
        // ÿπÿ±ÿ∂ ÿπÿØÿØ ÿßŸÑŸÖÿ¥ÿßŸáÿØÿßÿ™
        if (contentViews) {
            const views = linkData.clicks || 0;
            contentViews.textContent = `${views.toLocaleString()} ŸÖÿ¥ÿßŸáÿØÿ©`;
            contentViews.style.display = 'block';
            contentViews.style.visibility = 'visible';
        }
        
        // ÿπÿ±ÿ∂ ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿ•ŸÜÿ¥ÿßÿ°
        if (contentCreated && linkData.createdAt) {
            const createdDate = linkData.createdAt.toDate();
            contentCreated.textContent = createdDate.toLocaleDateString('ar-EG');
            contentCreated.style.display = 'block';
            contentCreated.style.visibility = 'visible';
        }
        
        // ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿ≤Ÿäÿßÿ±ÿ©
        console.log('ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿ≤Ÿäÿßÿ±ÿ©...');
        recordVisit(linkId);
        
        // ÿ•ÿÆŸÅÿßÿ° ŸÖÿ§ÿ¥ÿ± ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ ÿ®ÿπÿØ ÿßŸÑÿ™ÿπÿ®ÿ¶ÿ©
        redirectLoader.style.display = 'none';
        
        console.log('ÿ™ŸÖ ÿ™ÿ≠ŸÖŸäŸÑ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ®ŸÜÿ¨ÿßÿ≠');
        
        // ÿ•ÿπÿßÿØÿ© ÿßŸÑÿ™Ÿàÿ¨ŸäŸá ÿ®ÿπÿØ 15 ÿ´ÿßŸÜŸäÿ©
        setTimeout(() => {
            console.log('ÿ•ÿπÿßÿØÿ© ÿßŸÑÿ™Ÿàÿ¨ŸäŸá ÿ•ŸÑŸâ:', destinationUrl);
            window.location.href = destinationUrl;
        }, 15000);
        
    } catch (error) {
        console.error('ÿÆÿ∑ÿ£ ŸÅŸä ŸÖÿπÿßŸÑÿ¨ÿ© ÿ•ÿπÿßÿØÿ© ÿßŸÑÿ™Ÿàÿ¨ŸäŸá:', error);
        redirectLoader.style.display = 'none';
        
        // ÿπÿ±ÿ∂ ÿ±ÿ≥ÿßŸÑÿ© ÿÆÿ∑ÿ£ ŸÖÿπ ÿ•ÿ®ŸÇÿßÿ° ÿßŸÑÿ®ÿ∑ÿßŸÇÿ© ŸÖÿ±ÿ¶Ÿäÿ©
        if (contentTitle) contentTitle.textContent = 'ÿÆÿ∑ÿ£ ŸÅŸä ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ';
        if (contentDescription) contentDescription.textContent = `ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£: ${error.message}`;
        if (contentType) contentType.textContent = 'ÿÆÿ∑ÿ£';
        
        redirectMessage.innerHTML = `
            <strong>ÿÆÿ∑ÿ£!</strong> ŸÅÿ¥ŸÑ ŸÅŸä ÿ™ÿ≠ŸÖŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ±ÿßÿ®ÿ∑.<br>
            <span class="text-danger">${error.message}</span>
        `;
    }
}
        
        // ÿØÿßŸÑÿ© ŸÑŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿµŸàÿ±ÿ© Ÿàÿ•ÿ∏Ÿáÿßÿ±Ÿáÿß
function ensureImageVisibility(imageElement, fallbackUrl, title) {
    if (!imageElement) return;
    
    // ÿ•ÿ∏Ÿáÿßÿ± ÿßŸÑÿπŸÜÿµÿ± ŸÅŸàÿ±ÿßŸã
    imageElement.style.display = 'block';
    imageElement.style.visibility = 'visible';
    imageElement.style.opacity = '1';
    
    // ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿπÿßŸÑÿ¨ ŸÑŸÜÿ¨ÿßÿ≠ ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ
    imageElement.onload = function() {
        console.log('ÿ™ŸÖ ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿµŸàÿ±ÿ© ÿ®ŸÜÿ¨ÿßÿ≠');
        this.style.opacity = '1';
        this.style.visibility = 'visible';
        this.style.display = 'block';
    };
    
    // ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿπÿßŸÑÿ¨ ŸÑŸÅÿ¥ŸÑ ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ
    imageElement.onerror = function() {
        console.log('ŸÅÿ¥ŸÑ ŸÅŸä ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿµŸàÿ±ÿ©ÿå ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿµŸàÿ±ÿ© ÿ®ÿØŸäŸÑÿ©');
        this.src = fallbackUrl || 'https://via.placeholder.com/800x300/4A154B/FFFFFF?text=' + 
                   encodeURIComponent(title || 'ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿµŸàÿ±ÿ©');
        this.style.display = 'block';
        this.style.visibility = 'visible';
        this.style.opacity = '1';
    };
    
    // ŸÅÿ±ÿ∂ ÿßŸÑÿ•ÿ∏Ÿáÿßÿ± ÿ®ÿπÿØ ÿ´ÿßŸÜŸäÿ© Ÿàÿßÿ≠ÿØÿ©
    setTimeout(() => {
        if (imageElement) {
            imageElement.style.display = 'block';
            imageElement.style.visibility = 'visible';
            imageElement.style.opacity = '1';
        }
    }, 1000);
}

// ÿØÿßŸÑÿ© ŸÑÿ•ÿ∏Ÿáÿßÿ± ÿ¨ŸÖŸäÿπ ÿπŸÜÿßÿµÿ± ÿßŸÑÿ®ÿ∑ÿßŸÇÿ©
function showContentCard() {
    const elements = [
        'contentCard',
        'contentThumbnail', 
        'contentType',
        'contentTitle',
        'contentDescription',
        'contentMeta'
    ];
    
    elements.forEach(id => {
        const element = document.getElementById(id);
        if (element) {
            element.style.display = element.tagName === 'IMG' ? 'block' : 
                                   element.classList.contains('content-meta') ? 'flex' : 'block';
            element.style.visibility = 'visible';
            element.style.opacity = '1';
        }
    });
    
    console.log('ÿ™ŸÖ ÿ•ÿ∏Ÿáÿßÿ± ÿ¨ŸÖŸäÿπ ÿπŸÜÿßÿµÿ± ÿßŸÑÿ®ÿ∑ÿßŸÇÿ©');
}

// ÿØÿßŸÑÿ© ŸÑÿ™ÿ∑ÿ®ŸäŸÇ ÿ£ŸÜŸÖÿßÿ∑ ÿßŸÑÿ•ÿ∏Ÿáÿßÿ± ÿßŸÑŸÇÿ≥ÿ±Ÿä
function forceShowElements() {
    const forceShowCSS = `
        .content-card,
        .content-thumbnail,
        .content-info,
        .content-meta,
        .content-title,
        .content-description,
        .content-type,
        .content-episode,
        .content-date {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        
        .content-meta {
            display: flex !important;
        }
        
        .content-type,
        .content-episode, 
        .content-date {
            display: inline-block !important;
        }
    `;
    
    // ÿ•ÿ∂ÿßŸÅÿ© CSS ŸÑŸÑÿµŸÅÿ≠ÿ©
    const style = document.createElement('style');
    style.textContent = forceShowCSS;
    document.head.appendChild(style);
    
    console.log('ÿ™ŸÖ ÿ™ÿ∑ÿ®ŸäŸÇ ÿ£ŸÜŸÖÿßÿ∑ ÿßŸÑÿ•ÿ∏Ÿáÿßÿ± ÿßŸÑŸÇÿ≥ÿ±Ÿä');
}
        
        // Show notification
        function showNotification(type, message, duration = 3000) {
            const notification = document.getElementById(`${type}Notification`);
            const messageEl = notification.querySelector('div:first-child');
            
            messageEl.textContent = message;
            notification.style.display = 'block';
            setTimeout(() => {
                notification.classList.add('show');
            }, 10);
            
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    notification.style.display = 'none';
                }, 400);
            }, duration);
        }
        
        // Copy to clipboard with fallback and error handling
        function copyToClipboard() {
            const copyText = document.getElementById("generatedLink");
            copyText.select();
            copyText.setSelectionRange(0, 99999);
            
            try {
                if (navigator.clipboard) {
                    navigator.clipboard.writeText(copyText.value)
                        .then(() => {
                            showNotification('success', 'ÿ™ŸÖ ŸÜÿ≥ÿÆ ÿßŸÑÿ±ÿßÿ®ÿ∑ ÿ•ŸÑŸâ ÿßŸÑÿ≠ÿßŸÅÿ∏ÿ©!');
                            // Change button icon to success
                            const copyBtn = document.getElementById('copyLinkBtn');
                            copyBtn.innerHTML = '<i class="fas fa-check me-1"></i>ÿ™ŸÖ ÿßŸÑŸÜÿ≥ÿÆ!';
                            setTimeout(() => {
                                copyBtn.innerHTML = '<i class="fas fa-copy me-1"></i>ŸÜÿ≥ÿÆ';
                            }, 2000);
                        })
                        .catch(err => {
                            console.error('Failed to copy: ', err);
                            showNotification('error', 'ŸÅÿ¥ŸÑ ŸÜÿ≥ÿÆ ÿßŸÑÿ±ÿßÿ®ÿ∑');
                        });
                } else {
                    // Fallback for older browsers
                    document.execCommand('copy');
                    showNotification('success', 'ÿ™ŸÖ ŸÜÿ≥ÿÆ ÿßŸÑÿ±ÿßÿ®ÿ∑ ÿ•ŸÑŸâ ÿßŸÑÿ≠ÿßŸÅÿ∏ÿ©!');
                    const copyBtn = document.getElementById('copyLinkBtn');
                    copyBtn.innerHTML = '<i class="fas fa-check me-1"></i>ÿ™ŸÖ ÿßŸÑŸÜÿ≥ÿÆ!';
                    setTimeout(() => {
                                copyBtn.innerHTML = '<i class="fas fa-copy me-1"></i>ŸÜÿ≥ÿÆ';
                            }, 2000);
                }
            } catch (err) {
                console.error('Failed to copy: ', err);
                showNotification('error', 'ŸÅÿ¥ŸÑ ŸÜÿ≥ÿÆ ÿßŸÑÿ±ÿßÿ®ÿ∑');
            }
        }
        
        // URL validation
        function isValidUrl(url) {
            try {
                new URL(url);
                return true;
            } catch (e) {
                return false;
            }
        }
        
        // Series name validation
        function isValidSeriesName(name) {
            // Allow all Arabic characters and standard symbols
            const regex = /^[\p{Script=Arabic}\w\s\-_]+$/u;
            return regex.test(name);
        }
        
        // Generate new link with reCAPTCHA
        async function generateLink() {
            const seriesNameInput = document.getElementById('seriesName');
            const originalUrlInput = document.getElementById('originalUrl');
            const seriesName = seriesNameInput.value.trim();
            const originalUrl = originalUrlInput.value.trim();
            const socialTitle = document.getElementById('socialTitle').value.trim();
            const socialDescription = document.getElementById('socialDescription').value.trim();
            const socialImage = document.getElementById('socialImage').value.trim();
            const linkType = document.getElementById('linkType').value;
            const totalEpisodes = parseInt(document.getElementById('totalEpisodes').value) || 0;
            const startingEpisode = parseInt(document.getElementById('startingEpisode').value) || 1;
            
            // Reset validation states
            seriesNameInput.classList.remove('is-invalid');
            originalUrlInput.classList.remove('is-invalid');
            document.getElementById('episodeError').style.display = 'none';
            
            // Validate URL
            if (!isValidUrl(originalUrl)) {
                originalUrlInput.classList.add('is-invalid');
                showNotification('error', 'ÿßŸÑÿ±ÿ¨ÿßÿ° ÿ•ÿØÿÆÿßŸÑ ÿ±ÿßÿ®ÿ∑ ÿµÿßŸÑÿ≠');
                return;
            }
            
            // Validate series name
            if (!seriesName || !isValidSeriesName(seriesName)) {
                seriesNameInput.classList.add('is-invalid');
                showNotification('error', 'ÿßŸÑÿ±ÿ¨ÿßÿ° ÿ•ÿØÿÆÿßŸÑ ÿßÿ≥ŸÖ ÿ≥ŸÑÿ≥ŸÑÿ© ÿµÿßŸÑÿ≠');
                return;
            }
            
            // Validate episode count for series
            if (linkType === 'series' && (!totalEpisodes || totalEpisodes < 1)) {
                document.getElementById('episodeError').style.display = 'block';
                showNotification('error', 'ÿßŸÑÿ±ÿ¨ÿßÿ° ÿ•ÿØÿÆÿßŸÑ ÿπÿØÿØ ÿ≠ŸÑŸÇÿßÿ™ ÿµÿ≠Ÿäÿ≠');
                return;
            }
            
            try {
                // Execute reCAPTCHA
                const token = await new Promise((resolve) => {
                    grecaptcha.ready(() => {
                        grecaptcha.execute('6LesFYErAAAAAOpY8Pbc0furepnxPt0WyJorH5Qw', {action: 'create_link'})
                            .then(resolve);
                    });
                });
                
                // Disable button during processing
                generateBtn.disabled = true;
                generateBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ•ŸÜÿ¥ÿßÿ°...';
                
                // Generate random 6-digit ID
                const linkId = Math.floor(100000 + Math.random() * 900000).toString();
                
                // Create the new link in the required format
                const customDomain = document.getElementById('customDomain').value || 'turkify.com';
                
                // Update 8: Change parameter name for series
                const paramName = linkType === 'series' ? 'halqat-alyawm-min-musalsal' : linkType;
                const newLink = `https://${customDomain}/?${paramName}=${encodeURIComponent(seriesName)}&id=${linkId}`;
                
                // Get current user
                const user = auth.currentUser;
                
                // Create link data
                const linkData = {
                    id: linkId,
                    seriesName: seriesName,
                    linkType: linkType,
                    originalUrl: originalUrl,
                    shortUrl: newLink,
                    customDomain: customDomain,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                    userId: user ? user.uid : null,
                    clicks: 0,
                    socialTitle: socialTitle || `Turkify - ${getTypeName(linkType)} ${seriesName}`,
                    socialDescription: socialDescription || `ÿ¥ÿßŸáÿØ ${seriesName} ÿßŸÑÿ¢ŸÜ ÿπŸÑŸâ Turkify!`,
                    socialImage: socialImage || 'https://via.placeholder.com/1200x630/4A154B/FFFFFF?text=Turkify+Pro',
                };
                
                // Add totalEpisodes and startingEpisode for series
                if (linkType === 'series') {
                    linkData.totalEpisodes = totalEpisodes;
                    linkData.startingEpisode = startingEpisode;
                    
                    // Set startDate to current time (for episode calculation)
                    linkData.startDate = firebase.firestore.Timestamp.now();
                }
                
                // Save to Firestore
                await db.collection('links').doc(linkId).set(linkData);
                
                // Show modal with the new link
                document.getElementById('generatedLink').value = newLink;
                document.getElementById('originalLinkDisplay').textContent = originalUrl;
                
                const modal = new bootstrap.Modal(document.getElementById('linkModal'));
                modal.show();
                
                // Show success notification
                showNotification('success', 'ÿ™ŸÖ ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑÿ±ÿßÿ®ÿ∑ ÿ®ŸÜÿ¨ÿßÿ≠!');
                
                // Reset form
                document.getElementById('seriesName').value = '';
                document.getElementById('originalUrl').value = '';
                document.getElementById('totalEpisodes').value = '';
                document.getElementById('startingEpisode').value = '1';
                document.getElementById('episodeCountWrapper').style.display = 'none';
                document.getElementById('startingEpisodeWrapper').style.display = 'none';
                document.getElementById('socialTitle').value = '';
                document.getElementById('socialDescription').value = '';
                document.getElementById('socialImage').value = '';
                
                // Re-enable button
                generateBtn.disabled = false;
                generateBtn.innerHTML = '<i class="fas fa-bolt me-2"></i>ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑÿ±ÿßÿ®ÿ∑';
                
                // Reload links table
                loadLinks();
            } catch (error) {
                console.error('Error saving link:', error);
                showNotification('error', `ŸÅÿ¥ŸÑ ŸÅŸä ÿ≠ŸÅÿ∏ ÿßŸÑÿ±ÿßÿ®ÿ∑: ${error.message}`);
                // Re-enable button
                generateBtn.disabled = false;
                generateBtn.innerHTML = '<i class="fas fa-bolt me-2"></i>ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑÿ±ÿßÿ®ÿ∑';
            }
        }
        
        // Update existing link
        async function updateLink() {
            const seriesNameInput = document.getElementById('seriesName');
            const originalUrlInput = document.getElementById('originalUrl');
            const seriesName = seriesNameInput.value.trim();
            const originalUrl = originalUrlInput.value.trim();
            const socialTitle = document.getElementById('socialTitle').value.trim();
            const socialDescription = document.getElementById('socialDescription').value.trim();
            const socialImage = document.getElementById('socialImage').value.trim();
            const linkType = document.getElementById('linkType').value;
            const totalEpisodes = parseInt(document.getElementById('totalEpisodes').value) || 0;
            const startingEpisode = parseInt(document.getElementById('startingEpisode').value) || 1;
            
            // Reset validation states
            seriesNameInput.classList.remove('is-invalid');
            originalUrlInput.classList.remove('is-invalid');
            document.getElementById('episodeError').style.display = 'none';
            
            // Validate URL
            if (!isValidUrl(originalUrl)) {
                originalUrlInput.classList.add('is-invalid');
                showNotification('error', 'ÿßŸÑÿ±ÿ¨ÿßÿ° ÿ•ÿØÿÆÿßŸÑ ÿ±ÿßÿ®ÿ∑ ÿµÿßŸÑÿ≠');
                return;
            }
            
            // Validate series name
            if (!seriesName || !isValidSeriesName(seriesName)) {
                seriesNameInput.classList.add('is-invalid');
                showNotification('error', 'ÿßŸÑÿ±ÿ¨ÿßÿ° ÿ•ÿØÿÆÿßŸÑ ÿßÿ≥ŸÖ ÿ≥ŸÑÿ≥ŸÑÿ© ÿµÿßŸÑÿ≠');
                return;
            }
            
            // Validate episode count for series
            if (linkType === 'series' && (!totalEpisodes || totalEpisodes < 1)) {
                document.getElementById('episodeError').style.display = 'block';
                showNotification('error', 'ÿßŸÑÿ±ÿ¨ÿßÿ° ÿ•ÿØÿÆÿßŸÑ ÿπÿØÿØ ÿ≠ŸÑŸÇÿßÿ™ ÿµÿ≠Ÿäÿ≠');
                return;
            }
            
            try {
                // Disable button during processing
                updateBtn.disabled = true;
                updateBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ≠ŸÅÿ∏...';
                
                // Get link data
                const linkDoc = await db.collection('links').doc(currentEditingLinkId).get();
                
                if (linkDoc.exists) {
                    const linkData = linkDoc.data();
                    
                    // Update link data
                    const updatedData = {
                        seriesName: seriesName,
                        originalUrl: originalUrl,
                        socialTitle: socialTitle,
                        socialDescription: socialDescription,
                        socialImage: socialImage,
                        linkType: linkType
                    };
                    
                    // Add totalEpisodes and startingEpisode for series
                    if (linkType === 'series') {
                        updatedData.totalEpisodes = totalEpisodes;
                        updatedData.startingEpisode = startingEpisode;
                    } else {
                        updatedData.totalEpisodes = null;
                        updatedData.startingEpisode = null;
                    }
                    
                    // Save to Firestore
                    await db.collection('links').doc(currentEditingLinkId).update(updatedData);
                    
                    // Show success notification
                    showNotification('success', 'ÿ™ŸÖ ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ±ÿßÿ®ÿ∑ ÿ®ŸÜÿ¨ÿßÿ≠!');
                    
                    // Hide update button and show generate button
                    updateBtn.style.display = 'none';
                    generateBtn.style.display = 'block';
                    
                    // Reset form
                    document.getElementById('seriesName').value = '';
                    document.getElementById('originalUrl').value = '';
                    document.getElementById('totalEpisodes').value = '';
                    document.getElementById('startingEpisode').value = '1';
                    document.getElementById('episodeCountWrapper').style.display = 'none';
                    document.getElementById('startingEpisodeWrapper').style.display = 'none';
                    document.getElementById('socialTitle').value = '';
                    document.getElementById('socialDescription').value = '';
                    document.getElementById('socialImage').value = '';
                    
                    // Reset editing state
                    currentEditingLinkId = null;
                    
                    // Re-enable button
                    updateBtn.disabled = false;
                    updateBtn.innerHTML = '<i class="fas fa-save me-2"></i>ÿ≠ŸÅÿ∏ ÿßŸÑÿ™ÿ∫ŸäŸäÿ±ÿßÿ™';
                    
                    // Reload links table
                    loadLinks();
                }
            } catch (error) {
                console.error('Error updating link:', error);
                showNotification('error', `ŸÅÿ¥ŸÑ ŸÅŸä ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ±ÿßÿ®ÿ∑: ${error.message}`);
                // Re-enable button
                updateBtn.disabled = false;
                updateBtn.innerHTML = '<i class="fas fa-save me-2"></i>ÿ≠ŸÅÿ∏ ÿßŸÑÿ™ÿ∫ŸäŸäÿ±ÿßÿ™';
            }
        }
        
        // Get type name in Arabic
        function getTypeName(type) {
            const types = {
                'series': 'ŸÖÿ≥ŸÑÿ≥ŸÑ',
                'movie': 'ŸÅŸäŸÑŸÖ',
                'match': 'ŸÖÿ®ÿßÿ±ÿßÿ©',
                'recipe': 'ŸàÿµŸÅÿ©',
                'game': 'ŸÑÿπÿ®ÿ©',
                'app': 'ÿ™ÿ∑ÿ®ŸäŸÇ',
                'channel': 'ŸÇŸÜÿßÿ©',
                'reels': 'ÿ±ŸäŸÑÿ≤'
            };
            return types[type] || 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ';
        }
        
        // Load links for admin panel
        async function loadLinks() {
            setLoading(true);
            // Show loading spinner
            linksTable.innerHTML = `
                <tr>
                    <td colspan="7" class="text-center table-loader">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ...</span>
                        </div>
                    </td>
                </tr>
            `;
            
            try {
                // Get current user
                const user = auth.currentUser;
                if (!user) {
                    linksTable.innerHTML = `
                        <tr>
                            <td colspan="7" class="text-center py-5">
                                <div class="alert alert-info">
                                    Ÿäÿ±ÿ¨Ÿâ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ ŸÑÿπÿ±ÿ∂ ÿßŸÑÿ±Ÿàÿßÿ®ÿ∑ ÿßŸÑÿÆÿßÿµÿ© ÿ®ŸÉ
                                </div>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                // Load links from Firestore
                const querySnapshot = await db.collection('links').where('userId', '==', user.uid).get();
                
                if (querySnapshot.empty) {
                    linksTable.innerHTML = `
                        <tr>
                            <td colspan="7" class="text-center py-5">
                                ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ±Ÿàÿßÿ®ÿ∑. ŸÇŸÖ ÿ®ÿ•ŸÜÿ¥ÿßÿ° ÿ±ÿßÿ®ÿ∑ŸÉ ÿßŸÑÿ£ŸàŸÑ!
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                let tableContent = '';
                querySnapshot.forEach(doc => {
                    const link = doc.data();
                    
                    // Map link type to badge
                    const typeBadge = `<span class="link-type-badge type-${link.linkType || 'series'}">${getTypeName(link.linkType)}</span>`;
                    
                    tableContent += `
                        <tr>
                            <td>${link.id}</td>
                            <td>${link.seriesName}</td>
                            <td>${typeBadge}</td>
                            <td>
                                <a href="${link.shortUrl}" target="_blank" class="short-url">
                                    ${link.shortUrl}
                                </a>
                            </td>
                            <td>${link.createdAt ? formatFirestoreDateTime(link.createdAt) : 'N/A'}</td>
                            <td><span class="clicks-badge">${link.clicks}</span></td>
                            <td class="action-buttons">
                                <button class="btn btn-sm btn-outline-primary stats-btn" data-id="${link.id}" aria-label="ÿπÿ±ÿ∂ ÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™">
                                    <i class="fas fa-chart-bar"></i>
                                </button>
                                <button class="btn btn-sm btn-outline-info copy-btn" data-link="${link.shortUrl}" aria-label="ŸÜÿ≥ÿÆ ÿßŸÑÿ±ÿßÿ®ÿ∑">
                                    <i class="fas fa-copy"></i>
                                </button>
                                <button class="btn btn-sm btn-outline-primary edit-btn" data-id="${link.id}" aria-label="ÿ™ÿπÿØŸäŸÑ ÿßŸÑÿ±ÿßÿ®ÿ∑">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-sm btn-outline-danger delete-btn" data-id="${link.id}" aria-label="ÿ≠ÿ∞ŸÅ ÿßŸÑÿ±ÿßÿ®ÿ∑">
                                    <i class="fas fa-trash"></i>
                                </button>
                                <button class="btn btn-sm btn-outline-success earnings-btn" data-id="${link.id}" aria-label="ÿßŸÑÿ•Ÿäÿ±ÿßÿØÿßÿ™">
                                    <i class="fas fa-dollar-sign"></i>
                                </button>
                            </td>
                        </tr>
                    `;
                });
                
                linksTable.innerHTML = tableContent;
                
                // Add event listeners to action buttons
                document.querySelectorAll('.stats-btn').forEach(btn => {
    btn.addEventListener('click', async function() {
        const linkId = this.getAttribute('data-id');
        
        if (!linkId) {
            showNotification('error', 'ŸÖÿπÿ±ŸÅ ÿßŸÑÿ±ÿßÿ®ÿ∑ ÿ∫Ÿäÿ± ÿµÿßŸÑÿ≠');
            return;
        }
        
        // ÿ™ÿπÿ∑ŸäŸÑ ÿßŸÑÿ≤ÿ± ŸÖÿ§ŸÇÿ™ÿßŸã
        this.disabled = true;
        this.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
        
        try {
            await showLinkStats(linkId);
        } catch (error) {
            console.error('Error:', error);
            showNotification('error', 'ŸÅÿ¥ŸÑ ŸÅŸä ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™');
        } finally {
            // ÿ•ÿπÿßÿØÿ© ÿ™ŸÅÿπŸäŸÑ ÿßŸÑÿ≤ÿ±
            this.disabled = false;
            this.innerHTML = '<i class="fas fa-chart-bar"></i>';
        }
    });
});
                
                document.querySelectorAll('.copy-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const linkUrl = this.getAttribute('data-link');
                        navigator.clipboard.writeText(linkUrl);
                        showNotification('success', 'ÿ™ŸÖ ŸÜÿ≥ÿÆ ÿßŸÑÿ±ÿßÿ®ÿ∑ ÿ•ŸÑŸâ ÿßŸÑÿ≠ÿßŸÅÿ∏ÿ©!');
                    });
                });
                
                document.querySelectorAll('.edit-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const linkId = this.getAttribute('data-id');
                        editLink(linkId);
                    });
                });
                
                document.querySelectorAll('.delete-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const linkId = this.getAttribute('data-id');
                        showConfirmation('ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿ±ÿ∫ÿ®ÿ™ŸÉ ŸÅŸä ÿ≠ÿ∞ŸÅ Ÿáÿ∞ÿß ÿßŸÑÿ±ÿßÿ®ÿ∑ÿü', () => {
                            deleteLink(linkId);
                        });
                    });
                });
                
                document.querySelectorAll('.earnings-btn').forEach(btn => {
    btn.addEventListener('click', async function() {
        const linkId = this.getAttribute('data-id');
        
        if (!linkId) {
            showNotification('error', 'ŸÖÿπÿ±ŸÅ ÿßŸÑÿ±ÿßÿ®ÿ∑ ÿ∫Ÿäÿ± ÿµÿßŸÑÿ≠');
            return;
        }
        
        // ÿ™ÿπÿ∑ŸäŸÑ ÿßŸÑÿ≤ÿ± ŸÖÿ§ŸÇÿ™ÿßŸã
        this.disabled = true;
        const originalHTML = this.innerHTML;
        this.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
        
        try {
            // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ Ÿàÿ¨ŸàÿØ ÿ®ŸäÿßŸÜÿßÿ™ ŸÉÿßŸÅŸäÿ©
            const visitsQuery = await db.collection('visits')
                .where('linkId', '==', linkId)
                .limit(1)
                .get();
            
            if (visitsQuery.empty) {
                showNotification('info', 'ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ≤Ÿäÿßÿ±ÿßÿ™ ŸÉÿßŸÅŸäÿ© ŸÑÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ£ÿ±ÿ®ÿßÿ≠ ÿ®ÿπÿØ');
                return;
            }
            
            await showEarnings(linkId);
        } catch (error) {
            console.error('Error loading earnings:', error);
            showNotification('error', 'ŸÅÿ¥ŸÑ ŸÅŸä ÿ™ÿ≠ŸÖŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ£ÿ±ÿ®ÿßÿ≠: ' + error.message);
        } finally {
            // ÿ•ÿπÿßÿØÿ© ÿ™ŸÅÿπŸäŸÑ ÿßŸÑÿ≤ÿ±
            this.disabled = false;
            this.innerHTML = originalHTML;
        }
    });
});
            } catch (error) {
                console.error('Error loading links:', error);
                linksTable.innerHTML = `
                    <tr>
                        <td colspan="7" class="text-center py-5">
                            <div class="alert alert-danger">
                                ŸÅÿ¥ŸÑ ŸÅŸä ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ±Ÿàÿßÿ®ÿ∑: ${error.message}
                            </div>
                        </td>
                    </tr>
                `;
            } finally {
                setLoading(false);
            }
        }
        
        // Show link statistics
async function showLinkStats(linkId) {
    setLoading(true);
    
    try {
        // ÿ¨ŸÑÿ® ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ±ÿßÿ®ÿ∑ ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ©
        const linkDoc = await db.collection('links').doc(linkId).get();
        
        if (!linkDoc.exists) {
            throw new Error('ÿßŸÑÿ±ÿßÿ®ÿ∑ ÿ∫Ÿäÿ± ŸÖŸàÿ¨ŸàÿØ');
        }
        
        const linkData = linkDoc.data();
        
        // ÿ¨ŸÑÿ® ÿßŸÑÿ≤Ÿäÿßÿ±ÿßÿ™ ÿßŸÑŸÅÿπŸÑŸäÿ© ŸÖŸÜ Firebase
        const visitsQuery = await db.collection('visits')
            .where('linkId', '==', linkId)
            .orderBy('timestamp', 'desc')
            .get();
        
        // ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿßŸÑŸÅÿπŸÑŸäÿ©
        const visits = visitsQuery.docs.map(doc => doc.data());
        const totalVisits = visits.length;
        
        // ÿ≠ÿ≥ÿßÿ® ÿ≤Ÿäÿßÿ±ÿßÿ™ ÿßŸÑŸäŸàŸÖ
        const today = new Date();
        const startOfDay = new Date(today.getFullYear(), today.getMonth(), today.getDate());
        const todayVisits = visits.filter(visit => {
            const visitDate = visit.timestamp.toDate();
            return visitDate >= startOfDay;
        }).length;
        
        // ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ®ŸÑÿØ ÿßŸÑÿ£ŸÉÿ´ÿ± ÿ≤Ÿäÿßÿ±ÿ©
        const countryCounts = {};
        visits.forEach(visit => {
            countryCounts[visit.country] = (countryCounts[visit.country] || 0) + 1;
        });
        const topCountry = Object.keys(countryCounts).reduce((a, b) => 
            countryCounts[a] > countryCounts[b] ? a : b, 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ'
        );
        
        // ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ¨Ÿáÿßÿ≤ ÿßŸÑÿ£ŸÉÿ´ÿ± ÿßÿ≥ÿ™ÿÆÿØÿßŸÖÿßŸã
        const deviceCounts = {};
        visits.forEach(visit => {
            deviceCounts[visit.device] = (deviceCounts[visit.device] || 0) + 1;
        });
        const topDevice = Object.keys(deviceCounts).reduce((a, b) => 
            deviceCounts[a] > deviceCounts[b] ? a : b, 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ'
        );
        
        // ÿ™ÿπÿ®ÿ¶ÿ© ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖŸàÿØÿßŸÑ
        const titleElement = document.getElementById('statsLinkTitle');
        const urlElement = document.getElementById('statsLinkUrl');
        const totalVisitsElement = document.getElementById('totalVisits');
        const todayVisitsElement = document.getElementById('todayVisits');
        const topCountryElement = document.getElementById('topCountry');
        const topDeviceElement = document.getElementById('topDevice');
        
        // ŸÅÿ≠ÿµ Ÿàÿ¨ŸàÿØ ÿßŸÑÿπŸÜÿßÿµÿ± ŸÇÿ®ŸÑ ÿßŸÑÿ™ÿ≠ÿØŸäÿ´
        if (titleElement) titleElement.textContent = linkData.seriesName || 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ';
        if (urlElement) {
            urlElement.textContent = linkData.shortUrl || 'ÿ∫Ÿäÿ± ŸÖÿ™ÿßÿ≠';
            urlElement.href = linkData.shortUrl || '#';
        }
        if (totalVisitsElement) totalVisitsElement.textContent = totalVisits.toLocaleString();
        if (todayVisitsElement) todayVisitsElement.textContent = todayVisits.toLocaleString();
        if (topCountryElement) topCountryElement.textContent = topCountry;
        if (topDeviceElement) topDeviceElement.textContent = topDevice;
        
        // ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑÿ±ÿ≥ŸàŸÖ ÿßŸÑÿ®ŸäÿßŸÜŸäÿ© ÿ®ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ≠ŸÇŸäŸÇŸäÿ©
        createRealTimeCharts(visits);
        
        // ÿπÿ±ÿ∂ ÿßŸÑŸÖŸàÿØÿßŸÑ
        const modal = new bootstrap.Modal(document.getElementById('statsModal'));
        modal.show();
        
    } catch (error) {
        console.error('Error loading stats:', error);
        showNotification('error', 'ŸÅÿ¥ŸÑ ŸÅŸä ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™: ' + error.message);
    } finally {
        setLoading(false);
    }
}
       
       // ŸÅÿ≠ÿµ ÿµÿ≠ÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÇÿ®ŸÑ ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ£ÿ±ÿ®ÿßÿ≠
function validateEarningsData(visits) {
    const validVisits = visits.filter(visit => {
        // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ Ÿàÿ¨ŸàÿØ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿ∑ŸÑŸàÿ®ÿ©
        return visit && 
               visit.timestamp && 
               visit.country && 
               typeof visit.country === 'string' &&
               visit.linkId;
    });
    
    if (validVisits.length !== visits.length) {
        console.warn(`ÿ™ŸÖ ÿ™ÿ¨ÿßŸáŸÑ ${visits.length - validVisits.length} ÿ≤Ÿäÿßÿ±ÿ© ŸÑÿπÿØŸÖ ÿßŸÉÿ™ŸÖÿßŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™`);
    }
    
    return validVisits;
}

// ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿπŸÑŸàŸÖÿßÿ™ ŸÖŸÅŸäÿØÿ© ŸÑŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ
function generateEarningsReport(totalEarnings, arabVisits, foreignVisits) {
    const totalVisits = arabVisits + foreignVisits;
    
    let report = `üìä ÿ™ŸÇÿ±Ÿäÿ± ÿßŸÑÿ£ÿ±ÿ®ÿßÿ≠:\n`;
    report += `üí∞ ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿ£ÿ±ÿ®ÿßÿ≠: $${totalEarnings.toFixed(2)}\n`;
    report += `üë• ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿ≤Ÿäÿßÿ±ÿßÿ™: ${totalVisits.toLocaleString()}\n`;
    
    if (totalVisits > 0) {
        report += `üåç ÿßŸÑÿ≤Ÿäÿßÿ±ÿßÿ™ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©: ${arabVisits} (${((arabVisits/totalVisits)*100).toFixed(1)}%)\n`;
        report += `üåé ÿßŸÑÿ≤Ÿäÿßÿ±ÿßÿ™ ÿßŸÑÿ£ÿ¨ŸÜÿ®Ÿäÿ©: ${foreignVisits} (${((foreignVisits/totalVisits)*100).toFixed(1)}%)\n`;
        
        // ŸÜÿµÿßÿ¶ÿ≠ ŸÑŸÑÿ™ÿ≠ÿ≥ŸäŸÜ
        if (foreignVisits < arabVisits) {
            report += `\nüí° ŸÜÿµŸäÿ≠ÿ©: ÿ≠ÿßŸàŸÑ ÿßŸÑÿ™ÿ±ŸàŸäÿ¨ ŸÅŸä ÿßŸÑÿ®ŸÑÿØÿßŸÜ ÿßŸÑÿ£ÿ¨ŸÜÿ®Ÿäÿ© ŸÑŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ÿ£ÿ±ÿ®ÿßÿ≠ ÿ£ÿπŸÑŸâ!`;
        }
    }
    
    return report;
} 
        // Show real earnings for a link
async function showEarnings(linkId) {
    setLoading(true);
    window.currentEarningsLinkId = linkId;
    
    try {
        // ÿ¨ŸÑÿ® ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ±ÿßÿ®ÿ∑
        const linkDoc = await db.collection('links').doc(linkId).get();
        if (!linkDoc.exists) {
            throw new Error('ÿßŸÑÿ±ÿßÿ®ÿ∑ ÿ∫Ÿäÿ± ŸÖŸàÿ¨ŸàÿØ');
        }
        
        const linkData = linkDoc.data();
        
        // ÿ¨ŸÑÿ® ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≤Ÿäÿßÿ±ÿßÿ™ ŸÑŸÑÿ±ÿßÿ®ÿ∑
        const visitsQuery = await db.collection('visits')
            .where('linkId', '==', linkId)
            .orderBy('timestamp', 'desc')
            .get();
        
        const visits = visitsQuery.docs.map(doc => doc.data());
        
        // ÿ™ÿµŸÜŸäŸÅ ÿßŸÑÿ®ŸÑÿØÿßŸÜ ÿßŸÑÿπÿ±ÿ®Ÿäÿ© ŸàÿßŸÑÿ£ÿ¨ŸÜÿ®Ÿäÿ©
        const arabicCountries = [
            'ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©', 'ÿßŸÑÿ•ŸÖÿßÿ±ÿßÿ™', 'ŸÖÿµÿ±', 'ÿßŸÑÿπÿ±ÿßŸÇ', 'ÿßŸÑÿ£ÿ±ÿØŸÜ', 'ŸÑÿ®ŸÜÿßŸÜ', 
            'ÿ≥Ÿàÿ±Ÿäÿß', 'ÿßŸÑŸÉŸàŸäÿ™', 'ŸÇÿ∑ÿ±', 'ÿßŸÑÿ®ÿ≠ÿ±ŸäŸÜ', 'ÿπŸÖÿßŸÜ', 'ÿßŸÑŸäŸÖŸÜ',
            'ÿßŸÑŸÖÿ∫ÿ±ÿ®', 'ÿßŸÑÿ¨ÿ≤ÿßÿ¶ÿ±', 'ÿ™ŸàŸÜÿ≥', 'ŸÑŸäÿ®Ÿäÿß', 'ÿßŸÑÿ≥ŸàÿØÿßŸÜ', 'ÿßŸÑÿµŸàŸÖÿßŸÑ',
            'ŸÖŸàÿ±Ÿäÿ™ÿßŸÜŸäÿß', 'ÿ¨Ÿäÿ®Ÿàÿ™Ÿä', 'ÿ¨ÿ≤ÿ± ÿßŸÑŸÇŸÖÿ±', 'ŸÅŸÑÿ≥ÿ∑ŸäŸÜ',
            'Saudi Arabia', 'United Arab Emirates', 'Egypt', 'Iraq', 
            'Jordan', 'Lebanon', 'Syria', 'Kuwait', 'Qatar', 'Bahrain', 
            'Oman', 'Yemen', 'Morocco', 'Algeria', 'Tunisia', 'Libya', 
            'Sudan', 'Somalia', 'Mauritania', 'Djibouti', 'Comoros', 'Palestine'
        ];
        
        // ŸÅÿµŸÑ ÿßŸÑÿ≤Ÿäÿßÿ±ÿßÿ™ ÿ≠ÿ≥ÿ® ÿßŸÑŸÖŸÜÿ∑ŸÇÿ©
        let arabVisits = 0;
        let foreignVisits = 0;
        let todayArabVisits = 0;
        let todayForeignVisits = 0;
        
        const today = new Date();
        const startOfDay = new Date(today.getFullYear(), today.getMonth(), today.getDate());
        
        visits.forEach(visit => {
            const isArabic = arabicCountries.includes(visit.country);
            const visitDate = visit.timestamp.toDate();
            const isToday = visitDate >= startOfDay;
            
            if (isArabic) {
                arabVisits++;
                if (isToday) todayArabVisits++;
            } else {
                foreignVisits++;
                if (isToday) todayForeignVisits++;
            }
        });
        
        // ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ£ÿ±ÿ®ÿßÿ≠
        // $1 ŸÑŸÉŸÑ 1000 ÿ≤Ÿäÿßÿ±ÿ© ÿπÿ±ÿ®Ÿäÿ©
        // $3 ŸÑŸÉŸÑ 1000 ÿ≤Ÿäÿßÿ±ÿ© ÿ£ÿ¨ŸÜÿ®Ÿäÿ©
        const arabEarnings = (arabVisits / 1000) * 1.00;
        const foreignEarnings = (foreignVisits / 1000) * 3.00;
        const totalEarnings = arabEarnings + foreignEarnings;
        
        const todayArabEarnings = (todayArabVisits / 1000) * 1.00;
        const todayForeignEarnings = (todayForeignVisits / 1000) * 3.00;
        const todayTotalEarnings = todayArabEarnings + todayForeignEarnings;
        
        const totalVisits = arabVisits + foreignVisits;
        const averageRPM = totalVisits > 0 ? (totalEarnings / totalVisits) * 1000 : 0;
        const validVisits = validateEarningsData(visits);
        
        // ÿ™ÿ≠ÿØŸäÿ´ modal ÿßŸÑÿπŸÜŸàÿßŸÜ
        document.getElementById('earningsLinkTitle').textContent = linkData.seriesName || 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ';
        
        // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÅŸä modal
        document.getElementById('totalEarnings').textContent = `$${totalEarnings.toFixed(2)}`;
        document.getElementById('totalImpressions').textContent = totalVisits.toLocaleString();
        document.getElementById('averageRPM').textContent = `$${averageRPM.toFixed(2)}`;
        document.getElementById('todayEarnings').textContent = `$${todayTotalEarnings.toFixed(2)}`;
        
        // ÿ™ÿ≠ÿØŸäÿ´ ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑŸÖŸÜÿßÿ∑ŸÇ
        document.getElementById('arabVisits').textContent = `${arabVisits.toLocaleString()} ÿ≤Ÿäÿßÿ±ÿ©`;
        document.getElementById('arabEarnings').textContent = `$${arabEarnings.toFixed(2)}`;
        document.getElementById('foreignVisits').textContent = `${foreignVisits.toLocaleString()} ÿ≤Ÿäÿßÿ±ÿ©`;
        document.getElementById('foreignEarnings').textContent = `$${foreignEarnings.toFixed(2)}`;
        
        // ÿ™ÿ≠ÿØŸäÿ´ ÿ£ÿ¥ÿ±ÿ∑ÿ© ÿßŸÑÿ™ŸÇÿØŸÖ
        const arabPercentage = totalVisits > 0 ? (arabVisits / totalVisits) * 100 : 0;
        const foreignPercentage = totalVisits > 0 ? (foreignVisits / totalVisits) * 100 : 0;
        
        document.getElementById('arabProgress').style.width = `${arabPercentage}%`;
        document.getElementById('foreignProgress').style.width = `${foreignPercentage}%`;
        
        // ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑÿ±ÿ≥ŸÖ ÿßŸÑÿ®ŸäÿßŸÜŸä ŸÑŸÑÿ£ÿ±ÿ®ÿßÿ≠
        await createEarningsChart(visits, arabicCountries);
        
        // ÿπÿ±ÿ∂ modal
        const modal = new bootstrap.Modal(document.getElementById('earningsModal'));
        modal.show();
        
    } catch (error) {
        console.error('Error loading earnings:', error);
        showNotification('error', 'ŸÅÿ¥ŸÑ ŸÅŸä ÿ™ÿ≠ŸÖŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ£ÿ±ÿ®ÿßÿ≠: ' + error.message);
    } finally {
        setLoading(false);
    }
}

// ŸÅŸÑÿ™ÿ±ÿ© ÿßŸÑÿ£ÿ±ÿ®ÿßÿ≠ ÿ≠ÿ≥ÿ® ÿßŸÑŸÅÿ™ÿ±ÿ© ÿßŸÑÿ≤ŸÖŸÜŸäÿ©
function filterEarningsByTime(visits, timePeriod, arabicCountries) {
    const now = new Date();
    let startDate;
    
    switch(timePeriod) {
        case 'ÿßŸÑŸäŸàŸÖ':
            startDate = new Date(now.getFullYear(), now.getMonth(), now.getDate());
            break;
        case 'ÿ£ÿ≥ÿ®Ÿàÿπ':
            startDate = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
            break;
        case 'ÿ¥Ÿáÿ±':
            startDate = new Date(now.getFullYear(), now.getMonth() - 1, now.getDate());
            break;
        case '3 ÿ£ÿ¥Ÿáÿ±':
            startDate = new Date(now.getFullYear(), now.getMonth() - 3, now.getDate());
            break;
        case 'ÿ≥ŸÜÿ©':
            startDate = new Date(now.getFullYear() - 1, now.getMonth(), now.getDate());
            break;
        default:
            startDate = new Date(0); // ÿ¨ŸÖŸäÿπ ÿßŸÑÿ£ŸàŸÇÿßÿ™
    }
    
    const filteredVisits = visits.filter(visit => {
        const visitDate = visit.timestamp.toDate();
        return visitDate >= startDate;
    });
    
    // ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ£ÿ±ÿ®ÿßÿ≠ ÿßŸÑŸÖŸÅŸÑÿ™ÿ±ÿ©
    let arabVisits = 0;
    let foreignVisits = 0;
    
    filteredVisits.forEach(visit => {
        if (arabicCountries.includes(visit.country)) {
            arabVisits++;
        } else {
            foreignVisits++;
        }
    });
    
    const arabEarnings = (arabVisits / 1000) * 1.00;
    const foreignEarnings = (foreignVisits / 1000) * 3.00;
    const totalEarnings = arabEarnings + foreignEarnings;
    
    return {
        arabVisits,
        foreignVisits,
        arabEarnings,
        foreignEarnings,
        totalEarnings,
        totalVisits: arabVisits + foreignVisits
    };
}

// ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿπÿßŸÑÿ¨ÿßÿ™ ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑŸÅŸÑÿ™ÿ±ÿ© ÿßŸÑÿ≤ŸÖŸÜŸäÿ© ŸÑŸÑÿ£ÿ±ÿ®ÿßÿ≠
document.addEventListener('DOMContentLoaded', function() {
    // ŸÖÿπÿßŸÑÿ¨ ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑŸÅŸÑÿ™ÿ±ÿ© ŸÅŸä modal ÿßŸÑÿ£ÿ±ÿ®ÿßÿ≠
    const earningsModal = document.getElementById('earningsModal');
    if (earningsModal) {
        earningsModal.addEventListener('click', function(e) {
            if (e.target.classList.contains('time-btn')) {
                // ÿ•ÿ≤ÿßŸÑÿ© active ŸÖŸÜ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ£ÿ≤ÿ±ÿßÿ±
                earningsModal.querySelectorAll('.time-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                // ÿ•ÿ∂ÿßŸÅÿ© active ŸÑŸÑÿ≤ÿ± ÿßŸÑŸÖÿ≠ÿØÿØ
                e.target.classList.add('active');
                
                // ÿ•ÿπÿßÿØÿ© ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ®ÿßŸÑŸÅŸÑÿ™ÿ± ÿßŸÑÿ¨ÿØŸäÿØ
                const timePeriod = e.target.textContent;
                updateEarningsWithFilter(timePeriod);
            }
        });
    }
});

// ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ£ÿ±ÿ®ÿßÿ≠ ŸÖÿπ ÿßŸÑŸÅŸÑÿ™ÿ±
async function updateEarningsWithFilter(timePeriod) {
    // ÿßŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ linkId ÿßŸÑÿ≠ÿßŸÑŸä (Ÿäÿ¨ÿ® ÿ™ÿÆÿ≤ŸäŸÜŸá ÿπŸÜÿØ ŸÅÿ™ÿ≠ modal)
    const currentLinkId = window.currentEarningsLinkId;
    if (!currentLinkId) return;
    
    try {
        setLoading(true);
        
        // ÿ¨ŸÑÿ® ÿßŸÑÿ≤Ÿäÿßÿ±ÿßÿ™
        const visitsQuery = await db.collection('visits')
            .where('linkId', '==', currentLinkId)
            .orderBy('timestamp', 'desc')
            .get();
        
        const visits = visitsQuery.docs.map(doc => doc.data());
        
        const arabicCountries = [
            'ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©', 'ÿßŸÑÿ•ŸÖÿßÿ±ÿßÿ™', 'ŸÖÿµÿ±', 'ÿßŸÑÿπÿ±ÿßŸÇ', 'ÿßŸÑÿ£ÿ±ÿØŸÜ', 'ŸÑÿ®ŸÜÿßŸÜ', 
            'ÿ≥Ÿàÿ±Ÿäÿß', 'ÿßŸÑŸÉŸàŸäÿ™', 'ŸÇÿ∑ÿ±', 'ÿßŸÑÿ®ÿ≠ÿ±ŸäŸÜ', 'ÿπŸÖÿßŸÜ', 'ÿßŸÑŸäŸÖŸÜ',
            'ÿßŸÑŸÖÿ∫ÿ±ÿ®', 'ÿßŸÑÿ¨ÿ≤ÿßÿ¶ÿ±', 'ÿ™ŸàŸÜÿ≥', 'ŸÑŸäÿ®Ÿäÿß', 'ÿßŸÑÿ≥ŸàÿØÿßŸÜ', 'ÿßŸÑÿµŸàŸÖÿßŸÑ',
            'ŸÖŸàÿ±Ÿäÿ™ÿßŸÜŸäÿß', 'ÿ¨Ÿäÿ®Ÿàÿ™Ÿä', 'ÿ¨ÿ≤ÿ± ÿßŸÑŸÇŸÖÿ±', 'ŸÅŸÑÿ≥ÿ∑ŸäŸÜ',
            'Saudi Arabia', 'United Arab Emirates', 'Egypt', 'Iraq', 
            'Jordan', 'Lebanon', 'Syria', 'Kuwait', 'Qatar', 'Bahrain', 
            'Oman', 'Yemen', 'Morocco', 'Algeria', 'Tunisia', 'Libya', 
            'Sudan', 'Somalia', 'Mauritania', 'Djibouti', 'Comoros', 'Palestine'
        ];
        
        // ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑŸÅŸÑÿ™ÿ±
        const filteredData = filterEarningsByTime(visits, timePeriod, arabicCountries);
        
        // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÇŸäŸÖ ŸÅŸä modal
        document.getElementById('totalEarnings').textContent = `$${filteredData.totalEarnings.toFixed(2)}`;
        document.getElementById('totalImpressions').textContent = filteredData.totalVisits.toLocaleString();
        document.getElementById('arabVisits').textContent = `${filteredData.arabVisits.toLocaleString()} ÿ≤Ÿäÿßÿ±ÿ©`;
        document.getElementById('arabEarnings').textContent = `$${filteredData.arabEarnings.toFixed(2)}`;
        document.getElementById('foreignVisits').textContent = `${filteredData.foreignVisits.toLocaleString()} ÿ≤Ÿäÿßÿ±ÿ©`;
        document.getElementById('foreignEarnings').textContent = `$${filteredData.foreignEarnings.toFixed(2)}`;
        
        // ÿ™ÿ≠ÿØŸäÿ´ ÿ£ÿ¥ÿ±ÿ∑ÿ© ÿßŸÑÿ™ŸÇÿØŸÖ
        const arabPercentage = filteredData.totalVisits > 0 ? (filteredData.arabVisits / filteredData.totalVisits) * 100 : 0;
        const foreignPercentage = filteredData.totalVisits > 0 ? (filteredData.foreignVisits / filteredData.totalVisits) * 100 : 0;
        
        document.getElementById('arabProgress').style.width = `${arabPercentage}%`;
        document.getElementById('foreignProgress').style.width = `${foreignPercentage}%`;
        
        // ÿ™ÿ≠ÿØŸäÿ´ ŸÖÿ™Ÿàÿ≥ÿ∑ ÿßŸÑÿ±ÿ®ÿ≠
        const averageRPM = filteredData.totalVisits > 0 ? (filteredData.totalEarnings / filteredData.totalVisits) * 1000 : 0;
        document.getElementById('averageRPM').textContent = `$${averageRPM.toFixed(2)}`;
        
    } catch (error) {
        console.error('Error updating filtered earnings:', error);
        showNotification('error', 'ŸÅÿ¥ŸÑ ŸÅŸä ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖŸÅŸÑÿ™ÿ±ÿ©');
    } finally {
        setLoading(false);
    }
}

// Create real earnings chart
async function createEarningsChart(visits, arabicCountries) {
    // ÿ™ŸÜÿ∏ŸäŸÅ ÿßŸÑÿ±ÿ≥ŸÖ ÿßŸÑÿ≥ÿßÿ®ŸÇ
    Chart.getChart('earningsChart')?.destroy();
    
    const ctx = document.getElementById('earningsChart');
    if (!ctx) return;
    
    // ÿ™ÿ¨ŸÖŸäÿπ ÿßŸÑÿ£ÿ±ÿ®ÿßÿ≠ ÿ≠ÿ≥ÿ® ÿßŸÑŸäŸàŸÖ (ÿ¢ÿÆÿ± 30 ŸäŸàŸÖ)
    const last30Days = [];
    const earningsByDay = {};
    
    for (let i = 29; i >= 0; i--) {
        const date = new Date();
        date.setDate(date.getDate() - i);
        const dateStr = date.toISOString().split('T')[0]; // YYYY-MM-DD format
        const displayDate = date.toLocaleDateString('ar-EG', { month: 'short', day: 'numeric' });
        last30Days.push(displayDate);
        earningsByDay[dateStr] = { arab: 0, foreign: 0, total: 0 };
    }
    
    // ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ£ÿ±ÿ®ÿßÿ≠ ŸÑŸÉŸÑ ŸäŸàŸÖ
    visits.forEach(visit => {
        const visitDate = visit.timestamp.toDate();
        const dateStr = visitDate.toISOString().split('T')[0];
        
        if (earningsByDay[dateStr]) {
            if (arabicCountries.includes(visit.country)) {
                earningsByDay[dateStr].arab += (1.00 / 1000); // $1 per 1000 visits
            } else {
                earningsByDay[dateStr].foreign += (3.00 / 1000); // $3 per 1000 visits
            }
            earningsByDay[dateStr].total = earningsByDay[dateStr].arab + earningsByDay[dateStr].foreign;
        }
    });
    
    // ÿ•ÿπÿØÿßÿØ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÑŸÑÿ±ÿ≥ŸÖ ÿßŸÑÿ®ŸäÿßŸÜŸä
    const arabData = Object.values(earningsByDay).map(day => day.arab);
    const foreignData = Object.values(earningsByDay).map(day => day.foreign);
    const totalData = Object.values(earningsByDay).map(day => day.total);
    
    new Chart(ctx, {
        type: 'line',
        data: {
            labels: last30Days,
            datasets: [
                {
                    label: 'ÿ£ÿ±ÿ®ÿßÿ≠ ÿπÿ±ÿ®Ÿäÿ© ($1/1000)',
                    data: arabData,
                    borderColor: '#2EC4B6',
                    backgroundColor: 'rgba(46, 196, 182, 0.1)',
                    borderWidth: 2,
                    tension: 0.3,
                    fill: false
                },
                {
                    label: 'ÿ£ÿ±ÿ®ÿßÿ≠ ÿ£ÿ¨ŸÜÿ®Ÿäÿ© ($3/1000)',
                    data: foreignData,
                    borderColor: '#4A154B',
                    backgroundColor: 'rgba(74, 21, 75, 0.1)',
                    borderWidth: 2,
                    tension: 0.3,
                    fill: false
                },
                {
                    label: 'ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿ£ÿ±ÿ®ÿßÿ≠',
                    data: totalData,
                    borderColor: '#EF5A5F',
                    backgroundColor: 'rgba(239, 90, 95, 0.1)',
                    borderWidth: 3,
                    tension: 0.3,
                    fill: true
                }
            ]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    display: true,
                    position: 'top'
                },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            return `${context.dataset.label}: $${context.parsed.y.toFixed(4)}`;
                        }
                    }
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                        callback: function(value) {
                            return '$' + value.toFixed(3);
                        }
                    }
                },
                x: {
                    ticks: {
                        maxTicksLimit: 10
                    }
                }
            }
        }
    });
}
        
        // Create charts for stats
function createRealTimeCharts(visits) {
    // ÿ™ŸÜÿ∏ŸäŸÅ ÿßŸÑÿ±ÿ≥ŸàŸÖ ÿßŸÑÿ≥ÿßÿ®ŸÇÿ©
    Chart.getChart('visitsChart')?.destroy();
    Chart.getChart('geoChart')?.destroy();
    Chart.getChart('devicesChart')?.destroy();
    Chart.getChart('sourcesChart')?.destroy();
    
    // ÿ±ÿ≥ŸÖ ÿ®ŸäÿßŸÜŸä ŸÑŸÑÿ≤Ÿäÿßÿ±ÿßÿ™ ÿ≠ÿ≥ÿ® ÿßŸÑÿ™ÿßÿ±ŸäÿÆ (ÿ¢ÿÆÿ± 7 ÿ£ŸäÿßŸÖ)
    const last7Days = [];
    const visitsByDay = {};
    
    for (let i = 6; i >= 0; i--) {
        const date = new Date();
        date.setDate(date.getDate() - i);
        const dateStr = date.toLocaleDateString('ar-EG');
        last7Days.push(dateStr);
        visitsByDay[dateStr] = 0;
    }
    
    visits.forEach(visit => {
        const visitDate = visit.timestamp.toDate().toLocaleDateString('ar-EG');
        if (visitsByDay.hasOwnProperty(visitDate)) {
            visitsByDay[visitDate]++;
        }
    });
    
    // ÿ±ÿ≥ŸÖ ÿßŸÑÿ≤Ÿäÿßÿ±ÿßÿ™ ŸÖÿπ ÿßŸÑŸàŸÇÿ™
    const visitsCtx = document.getElementById('visitsChart');
    if (visitsCtx) {
        new Chart(visitsCtx, {
            type: 'line',
            data: {
                labels: last7Days,
                datasets: [{
                    label: 'ÿßŸÑÿ≤Ÿäÿßÿ±ÿßÿ™',
                    data: last7Days.map(date => visitsByDay[date]),
                    borderColor: '#4A154B',
                    backgroundColor: 'rgba(74, 21, 75, 0.1)',
                    borderWidth: 2,
                    tension: 0.3,
                    fill: true
                }]
            },
            options: {
                responsive: true,
                plugins: { legend: { display: false } },
                scales: {
                    y: { beginAtZero: true, ticks: { stepSize: 1 } }
                }
            }
        });
    }
    
    // ÿ±ÿ≥ŸÖ ÿßŸÑÿ™Ÿàÿ≤Ÿäÿπ ÿßŸÑÿ¨ÿ∫ÿ±ÿßŸÅŸä
    const countryCounts = {};
    visits.forEach(visit => {
        countryCounts[visit.country] = (countryCounts[visit.country] || 0) + 1;
    });
    
    const topCountries = Object.entries(countryCounts)
        .sort(([,a], [,b]) => b - a)
        .slice(0, 5);
    
    const geoCtx = document.getElementById('geoChart');
    if (geoCtx && topCountries.length > 0) {
        new Chart(geoCtx, {
            type: 'doughnut',
            data: {
                labels: topCountries.map(([country]) => country),
                datasets: [{
                    data: topCountries.map(([,count]) => count),
                    backgroundColor: ['#4A154B', '#EF5A5F', '#2EC4B6', '#FF9F1C', '#6C757D']
                }]
            },
            options: {
                responsive: true,
                plugins: { legend: { position: 'bottom' } }
            }
        });
    }
    
    // ÿ±ÿ≥ŸÖ ÿ£ŸÜŸàÿßÿπ ÿßŸÑÿ£ÿ¨Ÿáÿ≤ÿ©
    const deviceCounts = {};
    visits.forEach(visit => {
        deviceCounts[visit.device] = (deviceCounts[visit.device] || 0) + 1;
    });
    
    const devicesCtx = document.getElementById('devicesChart');
    if (devicesCtx && Object.keys(deviceCounts).length > 0) {
        new Chart(devicesCtx, {
            type: 'pie',
            data: {
                labels: Object.keys(deviceCounts),
                datasets: [{
                    data: Object.values(deviceCounts),
                    backgroundColor: ['#4A154B', '#2EC4B6', '#EF5A5F', '#FF9F1C']
                }]
            },
            options: {
                responsive: true,
                plugins: { legend: { position: 'bottom' } }
            }
        });
    }
    
    // ÿ±ÿ≥ŸÖ ŸÖÿµÿßÿØÿ± ÿßŸÑÿ≤Ÿäÿßÿ±ÿßÿ™
    const sourceCounts = {};
    visits.forEach(visit => {
        sourceCounts[visit.source] = (sourceCounts[visit.source] || 0) + 1;
    });
    
    const sourcesCtx = document.getElementById('sourcesChart');
    if (sourcesCtx && Object.keys(sourceCounts).length > 0) {
        new Chart(sourcesCtx, {
            type: 'bar',
            data: {
                labels: Object.keys(sourceCounts),
                datasets: [{
                    label: 'ÿßŸÑÿ≤Ÿäÿßÿ±ÿßÿ™',
                    data: Object.values(sourceCounts),
                    backgroundColor: '#4A154B'
                }]
            },
            options: {
                responsive: true,
                plugins: { legend: { display: false } },
                scales: { y: { beginAtZero: true, ticks: { stepSize: 1 } } }
            }
        });
    }
}
        
        // Edit link function
        async function editLink(linkId) {
            setLoading(true);
            try {
                const linkDoc = await db.collection('links').doc(linkId).get();
                
                if (linkDoc.exists) {
                    const linkData = linkDoc.data();
                    
                    // ÿ™ÿπÿ®ÿ¶ÿ© ÿßŸÑŸÜŸÖŸàÿ∞ÿ¨ ÿ®ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ±ÿßÿ®ÿ∑
                    document.getElementById('seriesName').value = linkData.seriesName;
                    document.getElementById('originalUrl').value = linkData.originalUrl;
                    document.getElementById('customDomain').value = linkData.customDomain;
                    document.getElementById('linkType').value = linkData.linkType || 'series';
                    document.getElementById('socialTitle').value = linkData.socialTitle || '';
                    document.getElementById('socialDescription').value = linkData.socialDescription || '';
                    document.getElementById('socialImage').value = linkData.socialImage || '';
                    
                    // ÿ•ÿ∏Ÿáÿßÿ± ÿ≠ŸÇŸàŸÑ ÿßŸÑŸÖÿ≥ŸÑÿ≥ŸÑ
                    if (linkData.linkType === 'series') {
                        document.getElementById('episodeCountWrapper').style.display = 'block';
                        document.getElementById('startingEpisodeWrapper').style.display = 'block';
                        document.getElementById('totalEpisodes').value = linkData.totalEpisodes || '';
                        document.getElementById('startingEpisode').value = linkData.startingEpisode || 1;
                    } else {
                        document.getElementById('episodeCountWrapper').style.display = 'none';
                        document.getElementById('startingEpisodeWrapper').style.display = 'none';
                    }
                    
                    // Set current editing link ID
                    currentEditingLinkId = linkId;
                    
                    // Show update button and hide generate button
                    updateBtn.style.display = 'block';
                    generateBtn.style.display = 'none';
                    
                    // ŸÜŸÇŸÑ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸÑŸÜŸÖŸàÿ∞ÿ¨ ÿßŸÑÿ•ŸÜÿ¥ÿßÿ°
                    window.location.hash = 'admin';
                    window.scrollTo(0, 0);
                    
                    // Update preview
                    updateSocialPreview();
                }
            } catch (error) {
                showNotification('error', `ŸÅÿ¥ŸÑ ŸÅŸä ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ±ÿßÿ®ÿ∑: ${error.message}`);
            } finally {
                setLoading(false);
            }
        }
        
        // Delete link function
        async function deleteLink(linkId) {
            setLoading(true);
            try {
                await db.collection('links').doc(linkId).delete();
                showNotification('success', 'ÿ™ŸÖ ÿ≠ÿ∞ŸÅ ÿßŸÑÿ±ÿßÿ®ÿ∑ ÿ®ŸÜÿ¨ÿßÿ≠!');
                loadLinks();
            } catch (error) {
                console.error('Error deleting link:', error);
                showNotification('error', `ŸÅÿ¥ŸÑ ŸÅŸä ÿ≠ÿ∞ŸÅ ÿßŸÑÿ±ÿßÿ®ÿ∑: ${error.message}`);
            } finally {
                setLoading(false);
            }
        }
        
        // ÿØÿßŸÑÿ© ŸÑÿ¨ŸÑÿ® ÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿßŸÑÿ≠ŸÇŸäŸÇŸäÿ©
        async function loadAnalytics() {
            try {
                const statsDoc = await db.collection('stats').doc('global').get();
                const stats = statsDoc.data() || {};
                
                document.getElementById('totalLinksStat').textContent = 
                    (stats.totalLinks || 25000).toLocaleString() + '+';
                
                document.getElementById('totalClicksStat').textContent = 
                    (stats.totalClicks || 1200000).toLocaleString() + '+';
                
                document.getElementById('todayClicksStat').textContent = 
                    (stats.todayClicks || 1245).toLocaleString();
                
                document.getElementById('uptimeStat').textContent = 
                    (stats.uptime || 99.9).toFixed(1) + '%';
            } catch (error) {
                console.error('Error loading live stats:', error);
            }
        }

        // Firebase Authentication
        function initAuth() {
            auth.onAuthStateChanged(async (user) => {
                if (user) {
                    // User is signed in
                    userProfile.style.display = 'flex';
                    authButtons.style.display = 'none';
                    
                    // Set user info
                    userPhoto.src = user.photoURL || 'https://via.placeholder.com/40';
                    userName.textContent = user.displayName || 'ŸÖÿ≥ÿ™ÿÆÿØŸÖ';
                    
                    // Show welcome notification
                    showNotification('success', `ÿ£ŸáŸÑÿßŸã ÿ®ÿπŸàÿØÿ™ŸÉÿå ${user.displayName || 'ŸÖÿ≥ÿ™ÿÆÿØŸÖ'}!`, 4000);
                    
                    // Set first user as admin
                    await setFirstUserAsAdmin(user);
                    
                    // Show admin panel if on admin page
                    if (window.location.hash === '#admin') {
                        showAdminPanel();
                    }
                    
                    // Load live statistics
                    loadLiveStats();
                } else {
                    // User is signed out
                    userProfile.style.display = 'none';
                    authButtons.style.display = 'block';
                    
                    // Hide admin panel
                    if (window.location.hash === '#admin') {
                        hideAllPanels();
                        showFeatures();
                    }
                }
            });
            
            // Sign in with Google
            signInButton.addEventListener('click', async () => {
                try {
                    const provider = new firebase.auth.GoogleAuthProvider();
                    const result = await auth.signInWithPopup(provider);
                    showNotification('success', `ÿ™ŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿØÿÆŸàŸÑŸÉ ÿ®ŸÜÿ¨ÿßÿ≠ÿå ÿ£ŸáŸÑÿßŸã ÿ®ŸÉ ${result.user.displayName || 'ŸÖÿ≥ÿ™ÿÆÿØŸÖ'}!`);
                } catch (error) {
                    showNotification('error', `ŸÅÿ¥ŸÑ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ: ${error.message}`);
                }
            });
            
            // Sign out
            signOutButton.addEventListener('click', () => {
                auth.signOut();
                showNotification('info', 'ÿ™ŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿÆÿ±Ÿàÿ¨ŸÉ ÿ®ŸÜÿ¨ÿßÿ≠');
            });
        }
        
        // Set first user as admin
        async function setFirstUserAsAdmin(user) {
            const usersRef = db.collection('users');
            
            try {
                const usersSnapshot = await usersRef.get();
                
                if (usersSnapshot.empty) {
                    // This is the first user, set as admin
                    await usersRef.doc(user.uid).set({
                        uid: user.uid,
                        email: user.email,
                        displayName: user.displayName,
                        photoURL: user.photoURL,
                        isAdmin: true,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    showNotification('success', 'ÿ™ŸÖ ÿ™ÿπŸäŸäŸÜŸÉ ŸÉŸÖÿ≥ÿ§ŸàŸÑ ŸÑŸÑŸÖŸÜÿµÿ©!');
                    // Show admin-only elements
                    adminOnlyElements.forEach(el => {
                        el.style.display = 'block';
                    });
                } else {
                    // Check if user is admin
                    const userDoc = await usersRef.doc(user.uid).get();
                    if (userDoc.exists && userDoc.data().isAdmin) {
                        // Show admin-only elements
                        adminOnlyElements.forEach(el => {
                            el.style.display = 'block';
                        });
                    } else {
                        // Hide admin-only elements for non-admin users
                        adminOnlyElements.forEach(el => {
                            el.style.display = 'none';
                        });
                    }
                }
            } catch (error) {
                console.error('Error setting admin:', error);
            }
        }
        
        // Load live statistics
        async function loadLiveStats() {
            try {
                const statsDoc = await db.collection('stats').doc('global').get();
                const stats = statsDoc.data() || {};
                
                document.getElementById('totalLinksStat').textContent = 
                    (stats.totalLinks || 25000).toLocaleString() + '+';
                
                document.getElementById('totalClicksStat').textContent = 
                    (stats.totalClicks || 1200000).toLocaleString() + '+';
                
                document.getElementById('todayClicksStat').textContent = 
                    (stats.todayClicks || 1245).toLocaleString();
                
                document.getElementById('uptimeStat').textContent = 
                    (stats.uptime || 99.9).toFixed(1) + '%';
            } catch (error) {
                console.error('Error loading live stats:', error);
            }
        }
        
        // Update social media preview
        function updateSocialPreview() {
            const title = document.getElementById('socialTitle').value || 'ÿπŸÜŸàÿßŸÜ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ';
            const description = document.getElementById('socialDescription').value || 'ŸàÿµŸÅ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑÿ∞Ÿä ÿ≥Ÿäÿ∏Ÿáÿ± ÿπŸÑŸâ ŸÖŸÜÿµÿßÿ™ ÿßŸÑÿ™ŸàÿßÿµŸÑ ÿßŸÑÿßÿ¨ÿ™ŸÖÿßÿπŸä';
            const image = document.getElementById('socialImage').value || 'https://via.placeholder.com/500x300/4A154B/FFFFFF?text=ÿµŸàÿ±ÿ©+ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ';
            const domain = document.getElementById('customDomain').value || 'turkify.com';
            
            document.getElementById('previewTitle').textContent = title;
            document.getElementById('previewDescription').textContent = description;
            document.getElementById('previewImage').src = image;
            document.getElementById('previewDomain').textContent = domain;
        }
        
        // Show confirmation modal
        function showConfirmation(message, callback) {
            const modal = new bootstrap.Modal(document.getElementById('confirmationModal'));
            document.getElementById('confirmationMessage').textContent = message;
            document.getElementById('confirmActionBtn').onclick = function() {
                callback();
                modal.hide();
            };
            modal.show();
        }
        
        // Navigation event listeners
        document.getElementById('adminLink').addEventListener('click', function(e) {
            e.preventDefault();
            window.location.hash = 'admin';
            highlightActiveNav();
            if (auth.currentUser) {
                showAdminPanel();
            } else {
                showFeatures();
            }
            window.scrollTo(0, 0);
        });
        
        document.getElementById('statsLink').addEventListener('click', function(e) {
            e.preventDefault();
            window.location.hash = 'analytics';
            highlightActiveNav();
            showAnalytics();
            window.scrollTo(0, 0);
        });
        
        document.getElementById('featuresLink').addEventListener('click', function(e) {
            e.preventDefault();
            window.location.hash = 'features';
            highlightActiveNav();
            showFeatures();
            window.scrollTo(0, 0);
        });
        
        document.getElementById('homeLink').addEventListener('click', function(e) {
            e.preventDefault();
            window.location.hash = '';
            highlightActiveNav();
            showFeatures();
            window.scrollTo(0, 0);
        });
        
        // Handle hash changes
        window.addEventListener('hashchange', function() {
            initPage();
        });
        
        // Share link function
        document.getElementById('shareLinkBtn').addEventListener('click', function() {
            const link = document.getElementById('generatedLink').value;
            
            if (navigator.share) {
                navigator.share({
                    title: 'ÿ±ÿßÿ®ÿ∑ ŸÇÿµŸäÿ± ŸÖŸÜ Turkify Pro',
                    text: 'ÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ Ÿáÿ∞ÿß ÿßŸÑÿ±ÿßÿ®ÿ∑ ÿßŸÑŸÇÿµŸäÿ± ÿßŸÑÿ∞Ÿä ÿ£ŸÜÿ¥ÿ£ÿ™Ÿá ÿ®ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ Turkify Pro',
                    url: link
                }).then(() => {
                    showNotification('success', 'ÿ™ŸÖ ŸÖÿ¥ÿßÿ±ŸÉÿ© ÿßŸÑÿ±ÿßÿ®ÿ∑ ÿ®ŸÜÿ¨ÿßÿ≠!');
                }).catch(error => {
                    console.error('Error sharing:', error);
                    copyToClipboard();
                    showNotification('info', 'ÿ™ŸÖ ŸÜÿ≥ÿÆ ÿßŸÑÿ±ÿßÿ®ÿ∑ ÿ•ŸÑŸâ ÿßŸÑÿ≠ÿßŸÅÿ∏ÿ©');
                });
            } else {
                copyToClipboard();
                showNotification('success', 'ÿ™ŸÖ ŸÜÿ≥ÿÆ ÿßŸÑÿ±ÿßÿ®ÿ∑ ÿ•ŸÑŸâ ÿßŸÑÿ≠ÿßŸÅÿ∏ÿ©');
            }
        });
        
        // View analytics function
        document.getElementById('viewAnalyticsBtn').addEventListener('click', function() {
            const modal = bootstrap.Modal.getInstance(document.getElementById('linkModal'));
            modal.hide();
            window.location.hash = 'analytics';
            highlightActiveNav();
            showAnalytics();
            window.scrollTo(0, 0);
        });
        
        // Copy link button
        document.getElementById('copyLinkBtn').addEventListener('click', copyToClipboard);
        
        // Social media preview updates
        document.getElementById('socialTitle').addEventListener('input', updateSocialPreview);
        document.getElementById('socialDescription').addEventListener('input', updateSocialPreview);
        document.getElementById('socialImage').addEventListener('input', updateSocialPreview);
        
        // Toggle episode count field based on content type
        document.getElementById('linkType').addEventListener('change', function() {
            const selectedType = this.value;
            const episodeWrapper = document.getElementById('episodeCountWrapper');
            const startingEpisodeWrapper = document.getElementById('startingEpisodeWrapper');
            if (selectedType === 'series') {
                episodeWrapper.style.display = 'block';
                startingEpisodeWrapper.style.display = 'block';
            } else {
                episodeWrapper.style.display = 'none';
                startingEpisodeWrapper.style.display = 'none';
            }
        });
        
        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            initPage();
            initAuth();
            updateSocialPreview();
            
            // Set up button event listeners
            generateBtn.addEventListener('click', generateLink);
            updateBtn.addEventListener('click', updateLink);
        });
        
        // ŸÖÿ±ÿßŸÇÿ® ŸÑÿ∂ŸÖÿßŸÜ ÿ∏ŸáŸàÿ± ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ
document.addEventListener('DOMContentLoaded', function() {
    // ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ•ÿ∏Ÿáÿßÿ± ÿßŸÑŸÇÿ≥ÿ±Ÿä ÿπŸÜÿØ ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿµŸÅÿ≠ÿ©
    forceShowElements();
    
    // ŸÖÿ±ÿßŸÇÿ®ÿ© ÿ™ÿ∫ŸäŸäÿ±ÿßÿ™ DOM
    const observer = new MutationObserver(function(mutations) {
        mutations.forEach(function(mutation) {
            if (mutation.type === 'childList' || mutation.type === 'attributes') {
                // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ Ÿàÿ¨ŸàÿØ ÿπŸÜÿßÿµÿ± ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ Ÿàÿ•ÿ∏Ÿáÿßÿ±Ÿáÿß
                const contentElements = [
                    'contentCard',
                    'contentThumbnail',
                    'contentTitle', 
                    'contentDescription',
                    'contentType'
                ];
                
                contentElements.forEach(id => {
                    const element = document.getElementById(id);
                    if (element && element.style.display === 'none') {
                        element.style.display = element.tagName === 'IMG' ? 'block' : 
                                               element.classList.contains('content-meta') ? 'flex' : 'block';
                        element.style.visibility = 'visible';
                        element.style.opacity = '1';
                    }
                });
            }
        });
    });
    
    // ÿ®ÿØÿ° ÿßŸÑŸÖÿ±ÿßŸÇÿ®ÿ©
    observer.observe(document.body, {
        childList: true,
        subtree: true,
        attributes: true,
        attributeFilter: ['style', 'class']
    });
    
    console.log('ÿ™ŸÖ ÿ™ŸÅÿπŸäŸÑ ŸÖÿ±ÿßŸÇÿ® ÿπÿ±ÿ∂ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ');
});

// ÿØÿßŸÑÿ© ŸÑŸÑÿ™ÿ≠ŸÇŸÇ ÿßŸÑÿØŸàÿ±Ÿä ŸÖŸÜ ÿ∏ŸáŸàÿ± ÿßŸÑÿπŸÜÿßÿµÿ±
function periodicVisibilityCheck() {
    const urlParams = new URLSearchParams(window.location.search);
    const linkId = urlParams.get('id');
    
    if (linkId) {
        const checkInterval = setInterval(() => {
            showContentCard();
            
            // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑÿµŸàÿ±ÿ©
            const thumbnail = document.getElementById('contentThumbnail');
            if (thumbnail && !thumbnail.src.includes('placeholder')) {
                ensureImageVisibility(thumbnail);
            }
            
            // ÿ•ŸäŸÇÿßŸÅ ÿßŸÑÿ™ÿ≠ŸÇŸÇ ÿ®ÿπÿØ 10 ÿ´ŸàÿßŸÜ
            setTimeout(() => {
                clearInterval(checkInterval);
            }, 10000);
        }, 1000);
    }
}

// ÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑÿ™ÿ≠ŸÇŸÇ ÿßŸÑÿØŸàÿ±Ÿä
periodicVisibilityCheck();

// ü§ñ ŸÜÿ∏ÿßŸÖ ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™ ÿßŸÑÿ∞ŸÉŸäÿ© ÿßŸÑŸÖÿ™ŸÇÿØŸÖÿ©
class SmartAlgorithms {
    constructor() {
        this.algorithms = this.initializeAlgorithms();
        this.results = {};
        this.isRunning = false;
    }

    initializeAlgorithms() {
        return [
            // ŸÖÿ¨ŸÖŸàÿπÿ© ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑÿßÿ™ (5 ÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™)
            {
                id: 'user-behavior-analysis',
                name: 'ÿ™ÿ≠ŸÑŸäŸÑ ÿ≥ŸÑŸàŸÉ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ',
                category: 'analytics',
                description: 'ÿ™ÿ≠ŸÑŸäŸÑ ÿ£ŸÜŸÖÿßÿ∑ ÿ≥ŸÑŸàŸÉ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ Ÿàÿ™ŸÅÿ∂ŸäŸÑÿßÿ™ŸáŸÖ ÿ®ŸÜÿßÿ°Ÿã ÿπŸÑŸâ ÿ™ŸÅÿßÿπŸÑÿßÿ™ŸáŸÖ',
                complexity: 'ŸÖÿ™ŸÇÿØŸÖ',
                enabled: false,
                icon: 'fas fa-user-chart',
                algorithm: this.userBehaviorAnalysis
            },
            {
                id: 'click-prediction',
                name: 'ÿ™ŸàŸÇÿπ ÿßŸÑŸÜŸÇÿ±ÿßÿ™',
                category: 'prediction',
                description: 'ÿßŸÑÿ™ŸÜÿ®ÿ§ ÿ®ÿπÿØÿØ ÿßŸÑŸÜŸÇÿ±ÿßÿ™ ÿßŸÑŸÖÿ™ŸàŸÇÿπÿ© ŸÑŸÑÿ±Ÿàÿßÿ®ÿ∑ ÿßŸÑÿ¨ÿØŸäÿØÿ© ÿ®ŸÜÿßÿ°Ÿã ÿπŸÑŸâ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ™ÿßÿ±ŸäÿÆŸäÿ©',
                complexity: 'ŸÖÿ™ŸÇÿØŸÖ',
                enabled: false,
                icon: 'fas fa-mouse-pointer',
                algorithm: this.clickPredictionAnalysis
            },
            {
                id: 'optimal-timing',
                name: 'ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿ£ŸàŸÇÿßÿ™ ÿßŸÑŸÖÿ´ŸÑŸâ',
                category: 'analytics',
                description: 'ÿ™ÿ≠ÿØŸäÿØ ÿ£ŸÅÿ∂ŸÑ ÿ£ŸàŸÇÿßÿ™ ÿßŸÑŸÜÿ¥ÿ± ŸÑŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ÿ£ŸÇÿµŸâ ÿ™ŸÅÿßÿπŸÑ',
                complexity: 'ŸÖÿ™Ÿàÿ≥ÿ∑',
                enabled: false,
                icon: 'fas fa-clock',
                algorithm: this.optimalTimingAnalysis
            },
            {
                id: 'content-attraction',
                name: 'ÿ™ÿ≠ŸÑŸäŸÑ ÿ¨ÿßÿ∞ÿ®Ÿäÿ© ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ',
                category: 'analytics',
                description: 'ÿ™ŸÇŸäŸäŸÖ ŸÖÿØŸâ ÿ¨ÿßÿ∞ÿ®Ÿäÿ© ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ Ÿàÿ•ŸÖŸÉÿßŸÜŸäÿ© ÿßŸÜÿ™ÿ¥ÿßÿ±Ÿá',
                complexity: 'ŸÖÿ™ŸÇÿØŸÖ',
                enabled: false,
                icon: 'fas fa-magnet',
                algorithm: this.contentAttractionAnalysis
            },
            {
                id: 'geo-analysis',
                name: 'ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿ¨ÿ∫ÿ±ÿßŸÅŸä ÿßŸÑŸÖÿ™ŸÇÿØŸÖ',
                category: 'analytics',
                description: 'ÿ™ÿ≠ŸÑŸäŸÑ ŸÖÿ™ÿπŸÖŸÇ ŸÑŸÑÿ™Ÿàÿ≤Ÿäÿπ ÿßŸÑÿ¨ÿ∫ÿ±ÿßŸÅŸä Ÿàÿ£ŸÜŸÖÿßÿ∑ ÿßŸÑÿ≤Ÿäÿßÿ±ÿßÿ™ ÿ≠ÿ≥ÿ® ÿßŸÑŸÖŸÜÿßÿ∑ŸÇ',
                complexity: 'ŸÖÿ™ŸÇÿØŸÖ',
                enabled: false,
                icon: 'fas fa-globe',
                algorithm: this.advancedGeoAnalysis
            },

            // ŸÖÿ¨ŸÖŸàÿπÿ© ÿßŸÑÿ™ŸÜÿ®ÿ§ (3 ÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™)
            {
                id: 'trend-prediction',
                name: 'ÿßŸÑÿ™ŸÜÿ®ÿ§ ÿ®ÿßŸÑÿßÿ™ÿ¨ÿßŸáÿßÿ™',
                category: 'prediction',
                description: 'ÿ™ŸàŸÇÿπ ÿßŸÑÿßÿ™ÿ¨ÿßŸáÿßÿ™ ÿßŸÑŸÇÿßÿØŸÖÿ© ŸÅŸä ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑÿ±Ÿàÿßÿ®ÿ∑ ŸàÿßŸÑŸÖÿ≠ÿ™ŸàŸâ',
                complexity: 'ÿÆÿ®Ÿäÿ±',
                enabled: false,
                icon: 'fas fa-chart-line',
                algorithm: this.trendPrediction
            },
            {
                id: 'revenue-prediction',
                name: 'ÿ™ŸàŸÇÿπ ÿßŸÑÿ£ÿ±ÿ®ÿßÿ≠',
                category: 'prediction',
                description: 'ÿßŸÑÿ™ŸÜÿ®ÿ§ ÿ®ÿßŸÑÿ£ÿ±ÿ®ÿßÿ≠ ÿßŸÑŸÖÿ≥ÿ™ŸÇÿ®ŸÑŸäÿ© ÿ®ŸÜÿßÿ°Ÿã ÿπŸÑŸâ ÿßŸÑÿ£ÿØÿßÿ° ÿßŸÑÿ≠ÿßŸÑŸä',
                complexity: 'ŸÖÿ™ŸÇÿØŸÖ',
                enabled: false,
                icon: 'fas fa-dollar-sign',
                algorithm: this.revenuePrediction
            },
            {
                id: 'peak-time-prediction',
                name: 'ÿ™ŸàŸÇÿπ ÿ£ŸàŸÇÿßÿ™ ÿßŸÑÿ∞ÿ±Ÿàÿ©',
                category: 'prediction',
                description: 'ÿßŸÑÿ™ŸÜÿ®ÿ§ ÿ®ÿ£ŸàŸÇÿßÿ™ ÿßŸÑÿ∞ÿ±Ÿàÿ© ÿßŸÑŸÖÿ≥ÿ™ŸÇÿ®ŸÑŸäÿ© ŸÑŸÑÿ≤Ÿäÿßÿ±ÿßÿ™',
                complexity: 'ŸÖÿ™Ÿàÿ≥ÿ∑',
                enabled: false,
                icon: 'fas fa-chart-area',
                algorithm: this.peakTimePrediction
            },

            // ŸÖÿ¨ŸÖŸàÿπÿ© ÿßŸÑÿ£ŸÖÿßŸÜ (3 ÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™)
            {
                id: 'bot-detection',
                name: 'ŸÉÿ¥ŸÅ ÿßŸÑÿ®Ÿàÿ™ÿßÿ™',
                category: 'security',
                description: 'ÿßŸÉÿ™ÿ¥ÿßŸÅ ŸàŸÅŸÑÿ™ÿ±ÿ© ÿßŸÑÿ≤Ÿäÿßÿ±ÿßÿ™ ŸÖŸÜ ÿßŸÑÿ®Ÿàÿ™ÿßÿ™ ŸàÿßŸÑÿ≠ÿ≥ÿßÿ®ÿßÿ™ ÿßŸÑŸàŸáŸÖŸäÿ©',
                complexity: 'ŸÖÿ™ŸÇÿØŸÖ',
                enabled: false,
                icon: 'fas fa-robot',
                algorithm: this.botDetection
            },
            {
                id: 'fraud-detection',
                name: 'ŸÖŸÉÿßŸÅÿ≠ÿ© ÿßŸÑÿßÿ≠ÿ™ŸäÿßŸÑ',
                category: 'security',
                description: 'ÿßŸÉÿ™ÿ¥ÿßŸÅ ÿßŸÑŸÜŸÇÿ±ÿßÿ™ ÿßŸÑÿßÿ≠ÿ™ŸäÿßŸÑŸäÿ© ŸàÿßŸÑÿ£ŸÜÿ¥ÿ∑ÿ© ÿßŸÑŸÖÿ¥ÿ®ŸàŸáÿ©',
                complexity: 'ÿÆÿ®Ÿäÿ±',
                enabled: false,
                icon: 'fas fa-shield-alt',
                algorithm: this.fraudDetection
            },
            {
                id: 'link-protection',
                name: 'ÿ≠ŸÖÿßŸäÿ© ÿßŸÑÿ±Ÿàÿßÿ®ÿ∑',
                category: 'security',
                description: 'ÿ≠ŸÖÿßŸäÿ© ÿßŸÑÿ±Ÿàÿßÿ®ÿ∑ ŸÖŸÜ ÿßŸÑŸáÿ¨ŸÖÿßÿ™ ŸàÿßŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿ∫Ÿäÿ± ÿßŸÑŸÖÿµÿ±ÿ≠',
                complexity: 'ŸÖÿ™ŸÇÿØŸÖ',
                enabled: false,
                icon: 'fas fa-lock',
                algorithm: this.linkProtection
            },

            // ŸÖÿ¨ŸÖŸàÿπÿ© ÿßŸÑÿ™ÿ≠ÿ≥ŸäŸÜ (4 ÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™)
            {
                id: 'redirect-optimization',
                name: 'ÿ™ÿ≠ÿ≥ŸäŸÜ ÿ≥ÿ±ÿπÿ© ÿßŸÑÿ™Ÿàÿ¨ŸäŸá',
                category: 'optimization',
                description: 'ÿ™ÿ≠ÿ≥ŸäŸÜ ÿ≥ÿ±ÿπÿ© ÿ•ÿπÿßÿØÿ© ÿßŸÑÿ™Ÿàÿ¨ŸäŸá Ÿàÿ™ŸÇŸÑŸäŸÑ ÿ≤ŸÖŸÜ ÿßŸÑÿßÿ≥ÿ™ÿ¨ÿßÿ®ÿ©',
                complexity: 'ŸÖÿ™Ÿàÿ≥ÿ∑',
                enabled: false,
                icon: 'fas fa-tachometer-alt',
                algorithm: this.redirectOptimization
            },
            {
                id: 'conversion-optimization',
                name: 'ÿ™ÿ≠ÿ≥ŸäŸÜ ŸÖÿπÿØŸÑ ÿßŸÑÿ™ÿ≠ŸàŸäŸÑ',
                category: 'optimization',
                description: 'ÿ™ÿ≠ÿ≥ŸäŸÜ ŸÖÿπÿØŸÑ ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑÿ≤Ÿàÿßÿ± ÿ•ŸÑŸâ ŸÜŸÇÿ±ÿßÿ™ ŸÅÿπŸÑŸäÿ©',
                complexity: 'ŸÖÿ™ŸÇÿØŸÖ',
                enabled: false,
                icon: 'fas fa-bullseye',
                algorithm: this.conversionOptimization
            },
            {
                id: 'auto-seo-optimization',
                name: 'ÿßŸÑÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ™ŸÑŸÇÿßÿ¶Ÿä ŸÑŸÑŸÄ SEO',
                category: 'optimization',
                description: 'ÿ™ÿ≠ÿ≥ŸäŸÜ ÿ™ŸÑŸÇÿßÿ¶Ÿä ŸÑŸÑÿπŸÜÿßŸàŸäŸÜ ŸàÿßŸÑÿ£ŸàÿµÿßŸÅ ŸÑŸÖÿ≠ÿ±ŸÉÿßÿ™ ÿßŸÑÿ®ÿ≠ÿ´',
                complexity: 'ŸÖÿ™ŸÇÿØŸÖ',
                enabled: false,
                icon: 'fas fa-search',
                algorithm: this.autoSEOOptimization
            },
            {
                id: 'ai-recommendations',
                name: 'ÿßŸÑÿ™ŸàÿµŸäÿßÿ™ ÿßŸÑÿ∞ŸÉŸäÿ©',
                category: 'optimization',
                description: 'ŸÜÿ∏ÿßŸÖ ÿ∞ŸÉŸä ŸÑÿ™ŸÇÿØŸäŸÖ ÿ™ŸàÿµŸäÿßÿ™ ÿ¥ÿÆÿµŸäÿ© ŸÑŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ',
                complexity: 'ÿÆÿ®Ÿäÿ±',
                enabled: false,
                icon: 'fas fa-brain',
                algorithm: this.aiRecommendations
            }
        ];
    }

    // üîç ÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿ© ÿ™ÿ≠ŸÑŸäŸÑ ÿ≥ŸÑŸàŸÉ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ
    async userBehaviorAnalysis(data) {
        const visits = data.visits || [];
        const links = data.links || [];
        
        // ÿ™ÿ≠ŸÑŸäŸÑ ÿ£ŸÜŸÖÿßÿ∑ ÿßŸÑŸÜŸÇÿ±
        const clickPatterns = this.analyzeClickPatterns(visits);
        
        // ÿ™ÿ≠ŸÑŸäŸÑ ÿ£ŸàŸÇÿßÿ™ ÿßŸÑÿ™ŸÅÿßÿπŸÑ
        const interactionTimes = this.analyzeInteractionTimes(visits);
        
        // ÿ™ÿ≠ŸÑŸäŸÑ ÿ™ŸÅÿ∂ŸäŸÑÿßÿ™ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ
        const contentPreferences = this.analyzeContentPreferences(visits, links);
        
        return {
            score: this.calculateBehaviorScore(clickPatterns, interactionTimes),
            patterns: clickPatterns,
            preferences: contentPreferences,
            recommendations: this.generateBehaviorRecommendations(clickPatterns, contentPreferences),
            insights: [
                `ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸàŸÜ ŸäŸÅÿ∂ŸÑŸàŸÜ ÿßŸÑŸÜŸÇÿ± ŸÅŸä ÿßŸÑÿ≥ÿßÿπÿ© ${interactionTimes.peakHour}`,
                `ŸÖÿπÿØŸÑ ÿßŸÑÿ™ŸÅÿßÿπŸÑ ÿßŸÑÿ£ÿπŸÑŸâ ŸÅŸä ÿ£ŸäÿßŸÖ ${interactionTimes.bestDays.join('ÿå ')}`,
                `ŸÜŸàÿπ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑŸÖŸÅÿ∂ŸÑ: ${contentPreferences.topCategory}`
            ]
        };
    }

    // üìà ÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿ© ÿ™ŸàŸÇÿπ ÿßŸÑŸÜŸÇÿ±ÿßÿ™
    async clickPredictionAnalysis(data) {
        const historicalData = data.visits || [];
        const linkData = data.currentLink || {};
        
        // ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿßÿ™ÿ¨ÿßŸáÿßÿ™ ÿßŸÑÿ™ÿßÿ±ŸäÿÆŸäÿ©
        const trends = this.analyzeTrends(historicalData);
        
        // ÿ≠ÿ≥ÿßÿ® ŸÖÿπÿßŸÖŸÑÿßÿ™ ÿßŸÑÿ™ÿ£ÿ´Ÿäÿ±
        const factors = {
            timeOfDay: this.getTimeImpactFactor(linkData.createdAt),
            contentType: this.getContentTypeImpactFactor(linkData.linkType),
            seasonality: this.getSeasonalityFactor(),
            historicalPerformance: trends.averageGrowth
        };
        
        // ÿßŸÑÿ™ŸÜÿ®ÿ§ ÿ®ÿßŸÑŸÜŸÇÿ±ÿßÿ™
        const predictedClicks = this.calculatePredictedClicks(factors, trends);
        
        return {
            prediction: predictedClicks,
            confidence: this.calculatePredictionConfidence(factors),
            factors: factors,
            timeline: this.generateClickTimeline(predictedClicks),
            insights: [
                `ŸÖÿ™ŸàŸÇÿπ ${predictedClicks.daily} ŸÜŸÇÿ±ÿ© ŸäŸàŸÖŸäÿßŸã`,
                `ÿ£ŸÅÿ∂ŸÑ ÿ£ÿØÿßÿ° ŸÖÿ™ŸàŸÇÿπ ŸÅŸä ${predictedClicks.peakTime}`,
                `ŸÖÿπÿØŸÑ ÿßŸÑŸÜŸÖŸà ÿßŸÑŸÖÿ™ŸàŸÇÿπ: ${predictedClicks.growthRate}%`
            ]
        };
    }

    // ‚è∞ ÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿ© ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿ£ŸàŸÇÿßÿ™ ÿßŸÑŸÖÿ´ŸÑŸâ
    async optimalTimingAnalysis(data) {
        const visits = data.visits || [];
        
        // ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿ≤Ÿäÿßÿ±ÿßÿ™ ÿ≠ÿ≥ÿ® ÿßŸÑÿ≥ÿßÿπÿ©
        const hourlyData = this.analyzeHourlyDistribution(visits);
        
        // ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿ≤Ÿäÿßÿ±ÿßÿ™ ÿ≠ÿ≥ÿ® ÿßŸÑŸäŸàŸÖ
        const dailyData = this.analyzeDailyDistribution(visits);
        
        // ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿ£ŸÜŸÖÿßÿ∑ ÿßŸÑÿ£ÿ≥ÿ®ŸàÿπŸäÿ©
        const weeklyPatterns = this.analyzeWeeklyPatterns(visits);
        
        const optimalTimes = {
            bestHour: hourlyData.peak,
            bestDay: dailyData.peak,
            bestTimeRange: this.findOptimalTimeRange(hourlyData),
            avoidTimes: this.findWorstTimes(hourlyData, dailyData)
        };
        
        return {
            optimal: optimalTimes,
            distribution: { hourly: hourlyData, daily: dailyData, weekly: weeklyPatterns },
            score: this.calculateTimingScore(optimalTimes),
            recommendations: this.generateTimingRecommendations(optimalTimes),
            insights: [
                `ÿ£ŸÅÿ∂ŸÑ ŸàŸÇÿ™ ŸÑŸÑŸÜÿ¥ÿ±: ${optimalTimes.bestDay} ÿßŸÑÿ≥ÿßÿπÿ© ${optimalTimes.bestHour}`,
                `ÿ™ÿ¨ŸÜÿ® ÿßŸÑŸÜÿ¥ÿ± ŸÅŸä: ${optimalTimes.avoidTimes.join('ÿå ')}`,
                `ŸÖÿπÿØŸÑ ÿßŸÑŸÜÿ¨ÿßÿ≠ ŸÅŸä ÿßŸÑÿ£ŸàŸÇÿßÿ™ ÿßŸÑŸÖÿ´ŸÑŸâ: ${optimalTimes.successRate}%`
            ]
        };
    }

    // üß≤ ÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿ© ÿ™ÿ≠ŸÑŸäŸÑ ÿ¨ÿßÿ∞ÿ®Ÿäÿ© ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ
    async contentAttractionAnalysis(data) {
        const links = data.links || [];
        const visits = data.visits || [];
        
        // ÿ™ÿ≠ŸÑŸäŸÑ ÿπŸÜÿßÿµÿ± ÿßŸÑÿ¨ÿßÿ∞ÿ®Ÿäÿ©
        const attractionFactors = {
            titleEffectiveness: this.analyzeTitleEffectiveness(links),
            descriptionImpact: this.analyzeDescriptionImpact(links),
            imageInfluence: this.analyzeImageInfluence(links),
            contentTypePerformance: this.analyzeContentTypePerformance(links, visits)
        };
        
        // ÿ≠ÿ≥ÿßÿ® ŸÜŸÇÿßÿ∑ ÿßŸÑÿ¨ÿßÿ∞ÿ®Ÿäÿ©
        const attractionScore = this.calculateAttractionScore(attractionFactors);
        
        // ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑŸÉŸÑŸÖÿßÿ™ ÿßŸÑŸÖŸÅÿ™ÿßÿ≠Ÿäÿ© ÿßŸÑÿ£ŸÉÿ´ÿ± ÿ¨ÿßÿ∞ÿ®Ÿäÿ©
        const keywordAnalysis = this.analyzeAttractiveKeywords(links);
        
        return {
            score: attractionScore,
            factors: attractionFactors,
            keywords: keywordAnalysis,
            improvements: this.generateContentImprovements(attractionFactors),
            insights: [
                `ÿßŸÑÿπŸÜÿßŸàŸäŸÜ ÿßŸÑÿ™Ÿä ÿ™ÿ≠ÿ™ŸàŸä ÿπŸÑŸâ "${keywordAnalysis.topKeyword}" ÿ™ÿ≠ÿµŸÑ ÿπŸÑŸâ ŸÜŸÇÿ±ÿßÿ™ ÿ£ŸÉÿ´ÿ± ÿ®ŸÄ${keywordAnalysis.impact}%`,
                `ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ŸÖŸÜ ŸÜŸàÿπ ${attractionFactors.contentTypePerformance.best} ÿßŸÑÿ£ŸÉÿ´ÿ± ÿ¨ÿßÿ∞ÿ®Ÿäÿ©`,
                `ÿßŸÑÿµŸàÿ± ÿ™ÿ≤ŸäÿØ ÿßŸÑŸÜŸÇÿ±ÿßÿ™ ÿ®ŸÜÿ≥ÿ®ÿ© ${attractionFactors.imageInfluence.impact}%`
            ]
        };
    }

    // üåç ÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿ© ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿ¨ÿ∫ÿ±ÿßŸÅŸä ÿßŸÑŸÖÿ™ŸÇÿØŸÖ
    async advancedGeoAnalysis(data) {
        const visits = data.visits || [];
        
        // ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿ™Ÿàÿ≤Ÿäÿπ ÿßŸÑÿ¨ÿ∫ÿ±ÿßŸÅŸä
        const geoDistribution = this.analyzeGeoDistribution(visits);
        
        // ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿ£ŸÜŸÖÿßÿ∑ ÿßŸÑÿ¨ÿ∫ÿ±ÿßŸÅŸäÿ©
        const geoPatterns = this.analyzeGeoPatterns(visits);
        
        // ÿ™ÿ≠ŸÑŸäŸÑ ŸÖÿπÿØŸÑÿßÿ™ ÿßŸÑÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑÿ¨ÿ∫ÿ±ÿßŸÅŸäÿ©
        const geoConversions = this.analyzeGeoConversions(visits);
        
        // ÿ™ŸàŸÇÿπ ÿßŸÑÿ£ÿ≥ŸàÿßŸÇ ÿßŸÑŸÜÿßÿ¥ÿ¶ÿ©
        const emergingMarkets = this.predictEmergingMarkets(geoDistribution, geoPatterns);
        
        return {
            distribution: geoDistribution,
            patterns: geoPatterns,
            conversions: geoConversions,
            emerging: emergingMarkets,
            score: this.calculateGeoScore(geoDistribution, geoConversions),
            insights: [
                `ÿ£ÿπŸÑŸâ ŸÖÿπÿØŸÑ ÿ™ÿ≠ŸàŸäŸÑ ŸÅŸä: ${geoConversions.topCountry} (${geoConversions.topRate}%)`,
                `ÿßŸÑÿ≥ŸàŸÇ ÿßŸÑŸÜÿßÿ¥ÿ¶ ÿßŸÑÿ£ŸÉÿ´ÿ± ŸàÿßÿπÿØŸäÿ©: ${emergingMarkets.top}`,
                `ÿßŸÑÿ™Ÿàÿ≤Ÿäÿπ ÿßŸÑŸÖÿ™Ÿàÿßÿ≤ŸÜ ÿπÿ®ÿ± ${geoDistribution.activeRegions} ŸÖŸÜÿ∑ŸÇÿ©`
            ]
        };
    }

    // üìä ÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿ© ÿßŸÑÿ™ŸÜÿ®ÿ§ ÿ®ÿßŸÑÿßÿ™ÿ¨ÿßŸáÿßÿ™
    async trendPrediction(data) {
        const historicalData = data.visits || [];
        const timeSeriesData = this.prepareTimeSeriesData(historicalData);
        
        // ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿßÿ™ÿ¨ÿßŸáÿßÿ™
        const trends = this.analyzeTrendPatterns(timeSeriesData);
        
        // ÿßŸÑÿ™ŸÜÿ®ÿ§ ÿ®ÿßŸÑÿßÿ™ÿ¨ÿßŸáÿßÿ™ ÿßŸÑŸÖÿ≥ÿ™ŸÇÿ®ŸÑŸäÿ©
        const futureTrends = this.predictFutureTrends(trends, timeSeriesData);
        
        // ÿ™ÿ≠ÿØŸäÿØ ÿßŸÑÿßÿ™ÿ¨ÿßŸáÿßÿ™ ÿßŸÑÿµÿßÿπÿØÿ© ŸàÿßŸÑŸáÿßÿ®ÿ∑ÿ©
        const trendClassification = this.classifyTrends(futureTrends);
        
        return {
            current: trends,
            predictions: futureTrends,
            classification: trendClassification,
            confidence: this.calculateTrendConfidence(trends),
            insights: [
                `ÿßŸÑÿßÿ™ÿ¨ÿßŸá ÿßŸÑÿπÿßŸÖ: ${trendClassification.overall}`,
                `ÿ™ŸàŸÇÿπ ŸÜŸÖŸà ÿ®ŸÜÿ≥ÿ®ÿ© ${futureTrends.growthRate}% ŸÅŸä ÿßŸÑÿ¥Ÿáÿ± ÿßŸÑŸÇÿßÿØŸÖ`,
                `ÿßÿ≠ÿ™ŸÖÿßŸÑŸäÿ© ÿ≠ÿØŸàÿ´ ŸÇŸÅÿ≤ÿ© ŸÅŸä ÿßŸÑŸÜÿ¥ÿßÿ∑: ${futureTrends.spikeChance}%`
            ]
        };
    }

    // üí∞ ÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿ© ÿ™ŸàŸÇÿπ ÿßŸÑÿ£ÿ±ÿ®ÿßÿ≠
    async revenuePrediction(data) {
        const visits = data.visits || [];
        const revenueData = this.calculateHistoricalRevenue(visits);
        
        // ÿ™ÿ≠ŸÑŸäŸÑ ÿ£ŸÜŸÖÿßÿ∑ ÿßŸÑÿ•Ÿäÿ±ÿßÿØÿßÿ™
        const revenuePatterns = this.analyzeRevenuePatterns(revenueData);
        
        // ÿßŸÑÿ™ŸÜÿ®ÿ§ ÿ®ÿßŸÑÿ•Ÿäÿ±ÿßÿØÿßÿ™
        const futurePredictions = this.predictFutureRevenue(revenuePatterns, revenueData);
        
        // ÿ™ÿ≠ŸÑŸäŸÑ ÿπŸàÿßŸÖŸÑ ÿßŸÑÿ™ÿ£ÿ´Ÿäÿ± ÿπŸÑŸâ ÿßŸÑÿ•Ÿäÿ±ÿßÿØÿßÿ™
        const revenueFactors = this.analyzeRevenueFactors(visits, revenueData);
        
        return {
            historical: revenueData,
            patterns: revenuePatterns,
            predictions: futurePredictions,
            factors: revenueFactors,
            insights: [
                `ÿßŸÑÿ•Ÿäÿ±ÿßÿØÿßÿ™ ÿßŸÑŸÖÿ™ŸàŸÇÿπÿ© ŸÑŸÑÿ¥Ÿáÿ± ÿßŸÑŸÇÿßÿØŸÖ: $${futurePredictions.nextMonth.toFixed(2)}`,
                `ÿ£ŸÅÿ∂ŸÑ ŸÖÿµÿØÿ± ŸÑŸÑÿ•Ÿäÿ±ÿßÿØÿßÿ™: ${revenueFactors.topSource}`,
                `ŸÖÿπÿØŸÑ ŸÜŸÖŸà ÿßŸÑÿ•Ÿäÿ±ÿßÿØÿßÿ™ ÿßŸÑŸÖÿ™ŸàŸÇÿπ: ${futurePredictions.growthRate}%`
            ]
        };
    }

    // üïí ÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿ© ÿ™ŸàŸÇÿπ ÿ£ŸàŸÇÿßÿ™ ÿßŸÑÿ∞ÿ±Ÿàÿ©
    async peakTimePrediction(data) {
        const visits = data.visits || [];
        const timePatterns = this.analyzeTimePatterns(visits);
        
        // ÿ™ŸàŸÇÿπ ÿ£ŸàŸÇÿßÿ™ ÿßŸÑÿ∞ÿ±Ÿàÿ© ÿßŸÑŸÇÿßÿØŸÖÿ©
        const peakPredictions = this.predictPeakTimes(timePatterns);
        
        // ÿ™ÿ≠ŸÑŸäŸÑ ÿ¥ÿØÿ© ÿßŸÑÿ∞ÿ±Ÿàÿ©
        const peakIntensity = this.analyzePeakIntensity(timePatterns, visits);
        
        return {
            patterns: timePatterns,
            predictions: peakPredictions,
            intensity: peakIntensity,
            recommendations: this.generatePeakTimeRecommendations(peakPredictions),
            insights: [
                `ÿßŸÑÿ∞ÿ±Ÿàÿ© ÿßŸÑŸÇÿßÿØŸÖÿ© ŸÖÿ™ŸàŸÇÿπÿ© ŸÅŸä: ${peakPredictions.next.time}`,
                `ÿ¥ÿØÿ© ÿßŸÑÿ∞ÿ±Ÿàÿ© ÿßŸÑŸÖÿ™ŸàŸÇÿπÿ©: ${peakPredictions.next.intensity}`,
                `ÿ£ŸÅÿ∂ŸÑ ŸàŸÇÿ™ ŸÑŸÑÿßÿ≥ÿ™ÿπÿØÿßÿØ: ${peakPredictions.preparationTime}`
            ]
        };
    }

    // ü§ñ ÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿ© ŸÉÿ¥ŸÅ ÿßŸÑÿ®Ÿàÿ™ÿßÿ™
    async botDetection(data) {
        const visits = data.visits || [];
        
        // ÿ™ÿ≠ŸÑŸäŸÑ ÿ£ŸÜŸÖÿßÿ∑ ÿßŸÑÿ®Ÿàÿ™ÿßÿ™
        const botPatterns = this.analyzeBotPatterns(visits);
        
        // ŸÅÿ≠ÿµ ÿßŸÑÿ≥ŸÑŸàŸÉŸäÿßÿ™ ÿßŸÑŸÖÿ¥ÿ®ŸàŸáÿ©
        const suspiciousBehavior = this.detectSuspiciousBehavior(visits);
        
        // ÿ™ÿµŸÜŸäŸÅ ÿßŸÑÿ≤Ÿäÿßÿ±ÿßÿ™
        const visitClassification = this.classifyVisits(visits, botPatterns);
        
        return {
            detected: visitClassification.bots,
            suspicious: suspiciousBehavior,
            patterns: botPatterns,
            cleanRate: visitClassification.humanPercentage,
            recommendations: this.generateBotProtectionRecommendations(botPatterns),
            insights: [
                `ÿ™ŸÖ ÿßŸÉÿ™ÿ¥ÿßŸÅ ${visitClassification.bots.length} ÿ®Ÿàÿ™ ŸÖÿ≠ÿ™ŸÖŸÑ`,
                `ŸÖÿπÿØŸÑ ÿßŸÑÿ≤Ÿäÿßÿ±ÿßÿ™ ÿßŸÑŸÜÿ∏ŸäŸÅÿ©: ${visitClassification.humanPercentage}%`,
                `ÿ£ŸÉÿ´ÿ± ÿ£ŸÜŸÖÿßÿ∑ ÿßŸÑÿ®Ÿàÿ™ÿßÿ™ ÿ¥ŸäŸàÿπÿßŸã: ${botPatterns.commonPattern}`
            ]
        };
    }

    // üõ°Ô∏è ÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿ© ŸÖŸÉÿßŸÅÿ≠ÿ© ÿßŸÑÿßÿ≠ÿ™ŸäÿßŸÑ
    async fraudDetection(data) {
        const visits = data.visits || [];
        const links = data.links || [];
        
        // ŸÉÿ¥ŸÅ ÿßŸÑŸÜŸÇÿ±ÿßÿ™ ÿßŸÑÿßÿ≠ÿ™ŸäÿßŸÑŸäÿ©
        const fraudulentClicks = this.detectFraudulentClicks(visits);
        
        // ÿ™ÿ≠ŸÑŸäŸÑ ÿ£ŸÜŸÖÿßÿ∑ ÿßŸÑÿßÿ≠ÿ™ŸäÿßŸÑ
        const fraudPatterns = this.analyzeFraudPatterns(visits, links);
        
        // ÿ≠ÿ≥ÿßÿ® ŸÜŸÇÿßÿ∑ ÿßŸÑŸÖÿÆÿßÿ∑ÿ±
        const riskScores = this.calculateRiskScores(visits, fraudPatterns);
        
        return {
            detected: fraudulentClicks,
            patterns: fraudPatterns,
            risks: riskScores,
            protection: this.generateFraudProtection(fraudPatterns),
            insights: [
                `ÿ™ŸÖ ÿßŸÉÿ™ÿ¥ÿßŸÅ ${fraudulentClicks.length} ŸÜŸÇÿ±ÿ© ÿßÿ≠ÿ™ŸäÿßŸÑŸäÿ© ŸÖÿ≠ÿ™ŸÖŸÑÿ©`,
                `ŸÖÿ≥ÿ™ŸàŸâ ÿßŸÑŸÖÿÆÿßÿ∑ÿ± ÿßŸÑÿ≠ÿßŸÑŸä: ${riskScores.overall}`,
                `ÿ£ŸÉÿ´ÿ± ŸÖÿµÿßÿØÿ± ÿßŸÑÿßÿ≠ÿ™ŸäÿßŸÑ: ${fraudPatterns.topSources.join('ÿå ')}`
            ]
        };
    }

    // üîí ÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿ© ÿ≠ŸÖÿßŸäÿ© ÿßŸÑÿ±Ÿàÿßÿ®ÿ∑
    async linkProtection(data) {
        const links = data.links || [];
        const visits = data.visits || [];
        
        // ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿ™ŸáÿØŸäÿØÿßÿ™
        const threats = this.analyzeLinkThreats(visits, links);
        
        // ÿ•ŸÜÿ¥ÿßÿ° ÿ¢ŸÑŸäÿßÿ™ ÿßŸÑÿ≠ŸÖÿßŸäÿ©
        const protection = this.generateProtectionMechanisms(threats);
        
        // ŸÖÿ±ÿßŸÇÿ®ÿ© ÿßŸÑÿ£ŸÖÿßŸÜ
        const securityMonitoring = this.implementSecurityMonitoring(links);
        
        return {
            threats: threats,
            protection: protection,
            monitoring: securityMonitoring,
            score: this.calculateSecurityScore(threats, protection),
            insights: [
                `ÿ™ŸÖ ÿ±ÿµÿØ ${threats.count} ÿ™ŸáÿØŸäÿØ ŸÖÿ≠ÿ™ŸÖŸÑ`,
                `ŸÖÿ≥ÿ™ŸàŸâ ÿßŸÑÿ≠ŸÖÿßŸäÿ©: ${protection.level}`,
                `ÿßŸÑÿ±Ÿàÿßÿ®ÿ∑ ÿßŸÑŸÖÿ≠ŸÖŸäÿ©: ${protection.protectedCount}/${links.length}`
            ]
        };
    }

    // ‚ö° ÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿ© ÿ™ÿ≠ÿ≥ŸäŸÜ ÿ≥ÿ±ÿπÿ© ÿßŸÑÿ™Ÿàÿ¨ŸäŸá
    async redirectOptimization(data) {
        const redirectData = data.redirects || [];
        
        // ÿ™ÿ≠ŸÑŸäŸÑ ÿ£ŸàŸÇÿßÿ™ ÿßŸÑÿßÿ≥ÿ™ÿ¨ÿßÿ®ÿ©
        const responseAnalysis = this.analyzeResponseTimes(redirectData);
        
        // ÿ™ÿ≠ÿ≥ŸäŸÜ ŸÖÿ≥ÿßÿ±ÿßÿ™ ÿßŸÑÿ™Ÿàÿ¨ŸäŸá
        const optimizedPaths = this.optimizeRedirectPaths(redirectData);
        
        // ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ™ÿÆÿ≤ŸäŸÜ ÿßŸÑŸÖÿ§ŸÇÿ™
        const cacheOptimization = this.optimizeCaching(redirectData);
        
        return {
            current: responseAnalysis,
            optimized: optimizedPaths,
            caching: cacheOptimization,
            improvement: this.calculateSpeedImprovement(responseAnalysis, optimizedPaths),
            insights: [
                `ÿ™ÿ≠ÿ≥ŸÜ ŸÅŸä ÿßŸÑÿ≥ÿ±ÿπÿ© ÿ®ŸÜÿ≥ÿ®ÿ© ${optimizedPaths.improvement}%`,
                `ŸÖÿ™Ÿàÿ≥ÿ∑ ŸàŸÇÿ™ ÿßŸÑÿ™Ÿàÿ¨ŸäŸá: ${responseAnalysis.average}ms`,
                `ÿ™ŸàŸÅŸäÿ± ŸÅŸä ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™: ${cacheOptimization.savings}%`
            ]
        };
    }

    // üéØ ÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿ© ÿ™ÿ≠ÿ≥ŸäŸÜ ŸÖÿπÿØŸÑ ÿßŸÑÿ™ÿ≠ŸàŸäŸÑ
    async conversionOptimization(data) {
        const visits = data.visits || [];
        const conversions = data.conversions || [];
        
        // ÿ™ÿ≠ŸÑŸäŸÑ ŸÖÿπÿØŸÑÿßÿ™ ÿßŸÑÿ™ÿ≠ŸàŸäŸÑ
        const conversionAnalysis = this.analyzeConversionRates(visits, conversions);
        
        // ÿ™ÿ≠ÿØŸäÿØ ŸÜŸÇÿßÿ∑ ÿßŸÑÿ™ÿ≠ÿ≥ŸäŸÜ
        const optimizationPoints = this.identifyOptimizationPoints(conversionAnalysis);
        
        // ÿßŸÇÿ™ÿ±ÿßÿ≠ ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™
        const improvements = this.generateConversionImprovements(optimizationPoints);
        
        return {
            current: conversionAnalysis,
            opportunities: optimizationPoints,
            improvements: improvements,
            potential: this.calculatePotentialGains(improvements),
            insights: [
                `ŸÖÿπÿØŸÑ ÿßŸÑÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑÿ≠ÿßŸÑŸä: ${conversionAnalysis.rate}%`,
                `ÿ•ŸÖŸÉÿßŸÜŸäÿ© ÿßŸÑÿ™ÿ≠ÿ≥ŸäŸÜ: +${improvements.potentialIncrease}%`,
                `ÿ£ŸáŸÖ ŸÜŸÇÿ∑ÿ© ŸÑŸÑÿ™ÿ≠ÿ≥ŸäŸÜ: ${optimizationPoints.top.name}`
            ]
        };
    }

    // üîç ÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿ© ÿßŸÑÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ™ŸÑŸÇÿßÿ¶Ÿä ŸÑŸÑŸÄ SEO
    async autoSEOOptimization(data) {
        const links = data.links || [];
        
        // ÿ™ÿ≠ŸÑŸäŸÑ SEO ÿßŸÑÿ≠ÿßŸÑŸä
        const seoAnalysis = this.analyzeSEOStatus(links);
        
        // ÿ•ŸÜÿ¥ÿßÿ° ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ÿ™ŸÑŸÇÿßÿ¶Ÿäÿ©
        const autoImprovements = this.generateAutoSEOImprovements(seoAnalysis);
        
        // ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÉŸÑŸÖÿßÿ™ ÿßŸÑŸÖŸÅÿ™ÿßÿ≠Ÿäÿ©
        const keywordOptimization = this.optimizeKeywords(links);
        
        return {
            current: seoAnalysis,
            improvements: autoImprovements,
            keywords: keywordOptimization,
            score: this.calculateSEOScore(seoAnalysis, autoImprovements),
            insights: [
                `ŸÜŸÇÿßÿ∑ SEO ÿßŸÑÿ≠ÿßŸÑŸäÿ©: ${seoAnalysis.score}/100`,
                `ÿ™ŸÖ ÿ™ÿ≠ÿ≥ŸäŸÜ ${autoImprovements.count} ÿπŸÜÿµÿ± ÿ™ŸÑŸÇÿßÿ¶ŸäÿßŸã`,
                `ÿ£ŸáŸÖ ŸÉŸÑŸÖÿ© ŸÖŸÅÿ™ÿßÿ≠Ÿäÿ©: ${keywordOptimization.topKeyword}`
            ]
        };
    }

    // üß† ÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿ© ÿßŸÑÿ™ŸàÿµŸäÿßÿ™ ÿßŸÑÿ∞ŸÉŸäÿ©
    async aiRecommendations(data) {
        const user = data.user || {};
        const visits = data.visits || [];
        const links = data.links || [];
        
        // ÿ™ÿ≠ŸÑŸäŸÑ ÿ≥ŸÑŸàŸÉ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ
        const userProfile = this.createUserProfile(user, visits, links);
        
        // ÿ•ŸÜÿ¥ÿßÿ° ÿ™ŸàÿµŸäÿßÿ™ ÿ¥ÿÆÿµŸäÿ©
        const personalizedRecommendations = this.generatePersonalizedRecommendations(userProfile);
        
        // ÿ™ŸàÿµŸäÿßÿ™ ŸÑŸÑŸÖÿ≠ÿ™ŸàŸâ
        const contentRecommendations = this.generateContentRecommendations(userProfile, links);
        
        // ÿ™ŸàÿµŸäÿßÿ™ ŸÑŸÑÿ™ŸàŸÇŸäÿ™
        const timingRecommendations = this.generateTimingRecommendations(userProfile, visits);
        
        return {
            profile: userProfile,
            personal: personalizedRecommendations,
            content: contentRecommendations,
            timing: timingRecommendations,
            confidence: this.calculateRecommendationConfidence(userProfile),
            insights: [
                `ŸÜŸàÿπ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑŸÖÿ´ÿßŸÑŸä: ${contentRecommendations.idealType}`,
                `ÿ£ŸÅÿ∂ŸÑ ŸàŸÇÿ™ ŸÑŸÑŸÜÿ¥ÿ±: ${timingRecommendations.optimal}`,
                `ŸÖÿπÿØŸÑ ÿßŸÑŸÜÿ¨ÿßÿ≠ ÿßŸÑŸÖÿ™ŸàŸÇÿπ: ${personalizedRecommendations.successRate}%`
            ]
        };
    }

    // ÿØŸàÿßŸÑ ŸÖÿ≥ÿßÿπÿØÿ© ŸÑŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™
    analyzeClickPatterns(visits) {
        const patterns = {};
        visits.forEach(visit => {
            const hour = visit.timestamp.toDate().getHours();
            patterns[hour] = (patterns[hour] || 0) + 1;
        });
        return patterns;
    }

    calculateBehaviorScore(clickPatterns, interactionTimes) {
        const consistency = this.calculateConsistency(clickPatterns);
        const engagement = this.calculateEngagement(interactionTimes);
        return Math.round((consistency + engagement) / 2);
    }

    // ÿ™ÿ¥ÿ∫ŸäŸÑ ÿ¨ŸÖŸäÿπ ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™
    async runAllAlgorithms() {
        if (this.isRunning) return;
        
        this.isRunning = true;
        this.results = {};
        
        try {
            // ÿ¨ŸÖÿπ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
            const data = await this.collectData();
            
            // ÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™ ÿßŸÑŸÖŸÅÿπŸÑÿ©
            const enabledAlgorithms = this.algorithms.filter(alg => alg.enabled);
            
            for (let algorithm of enabledAlgorithms) {
                try {
                    this.updateAlgorithmStatus(algorithm.id, 'running');
                    const result = await algorithm.algorithm.call(this, data);
                    this.results[algorithm.id] = {
                        ...result,
                        timestamp: new Date(),
                        status: 'complete'
                    };
                    this.updateAlgorithmStatus(algorithm.id, 'complete');
                } catch (error) {
                    console.error(`Algorithm ${algorithm.id} failed:`, error);
                    this.results[algorithm.id] = {
                        error: error.message,
                        status: 'error',
                        timestamp: new Date()
                    };
                    this.updateAlgorithmStatus(algorithm.id, 'error');
                }
            }
            
            // ÿπÿ±ÿ∂ ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨
            this.displayResults();
            
        } catch (error) {
            console.error('Failed to run algorithms:', error);
        } finally {
            this.isRunning = false;
        }
    }

    async collectData() {
        const user = auth.currentUser;
        if (!user) throw new Error('ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿ∫Ÿäÿ± ŸÖÿ≥ÿ¨ŸÑ');
        
        // ÿ¨ŸÖÿπ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÖŸÜ Firebase
        const [linksSnapshot, visitsSnapshot] = await Promise.all([
            db.collection('links').where('userId', '==', user.uid).get(),
            db.collection('visits').orderBy('timestamp', 'desc').limit(1000).get()
        ]);
        
        return {
            user: user,
            links: linksSnapshot.docs.map(doc => ({id: doc.id, ...doc.data()})),
            visits: visitsSnapshot.docs.map(doc => doc.data()),
            redirects: [],
            conversions: []
        };
    }

    // ÿ®ÿßŸÇŸä ÿßŸÑÿØŸàÿßŸÑ ÿßŸÑŸÖÿ≥ÿßÿπÿØÿ©...
    // (ÿ≥Ÿäÿ™ŸÖ ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÖÿ≤ŸäÿØ ÿ≠ÿ≥ÿ® ÿßŸÑÿ≠ÿßÿ¨ÿ©)
}

// ÿ™ŸáŸäÿ¶ÿ© ŸÜÿ∏ÿßŸÖ ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™
const smartAlgorithms = new SmartAlgorithms();

// üéÆ ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ™ÿ≠ŸÉŸÖ ŸàÿßŸÑÿπÿ±ÿ∂ ŸÑŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™ ÿßŸÑÿ∞ŸÉŸäÿ©
class AlgorithmsUIController {
    constructor(smartAlgorithms) {
        this.algorithms = smartAlgorithms;
        this.currentCategory = 'all';
        this.init();
    }

    init() {
        this.renderAlgorithmsGrid();
        this.setupEventListeners();
        this.updateSystemStatus();
    }

    // ÿπÿ±ÿ∂ ÿ¥ÿ®ŸÉÿ© ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™
    renderAlgorithmsGrid() {
        const grid = document.getElementById('algorithmsGrid');
        if (!grid) return;

        const filteredAlgorithms = this.currentCategory === 'all' 
            ? this.algorithms.algorithms 
            : this.algorithms.algorithms.filter(alg => alg.category === this.currentCategory);

        grid.innerHTML = filteredAlgorithms.map(algorithm => `
            <div class="algorithm-card" data-category="${algorithm.category}">
                <div class="algorithm-header">
                    <h5 class="algorithm-title">
                        <i class="${algorithm.icon}"></i>
                        ${algorithm.name}
                    </h5>
                    <span class="algorithm-category category-${algorithm.category}">
                        ${this.getCategoryName(algorithm.category)}
                    </span>
                </div>

                <p class="algorithm-description">${algorithm.description}</p>

                <div class="algorithm-stats">
                    <div class="algorithm-stat">
                        <span class="algorithm-stat-value">${algorithm.complexity}</span>
                        <span class="algorithm-stat-label">ÿßŸÑÿ™ÿπŸÇŸäÿØ</span>
                    </div>
                    <div class="algorithm-stat">
                        <span class="algorithm-stat-value" id="status-${algorithm.id}">ŸÖÿ™ŸàŸÇŸÅ</span>
                        <span class="algorithm-stat-label">ÿßŸÑÿ≠ÿßŸÑÿ©</span>
                    </div>
                    <div class="algorithm-stat">
                        <span class="algorithm-stat-value" id="score-${algorithm.id}">--</span>
                        <span class="algorithm-stat-label">ÿßŸÑŸÜÿ™Ÿäÿ¨ÿ©</span>
                    </div>
                </div>

                <div class="algorithm-progress" id="progress-${algorithm.id}" style="display: none;">
                    <div class="algorithm-progress-bar" style="width: 0%"></div>
                </div>

                <div class="algorithm-controls">
                    <button class="btn btn-sm btn-primary" onclick="algorithmsUI.runSingleAlgorithm('${algorithm.id}')">
                        <i class="fas fa-play"></i> ÿ™ÿ¥ÿ∫ŸäŸÑ
                    </button>
                    <button class="btn btn-sm btn-outline-info" onclick="algorithmsUI.showAlgorithmDetails('${algorithm.id}')">
                        <i class="fas fa-info-circle"></i> ÿßŸÑÿ™ŸÅÿßÿµŸäŸÑ
                    </button>
                    <div class="algorithm-switch">
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="switch-${algorithm.id}" 
                                   ${algorithm.enabled ? 'checked' : ''} 
                                   onchange="algorithmsUI.toggleAlgorithm('${algorithm.id}')">
                            <label class="form-check-label" for="switch-${algorithm.id}">
                                <span class="algorithm-status status-${algorithm.enabled ? 'complete' : 'idle'}"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        `).join('');
    }

    // ÿ•ÿπÿØÿßÿØ ŸÖÿπÿßŸÑÿ¨ÿßÿ™ ÿßŸÑÿ£ÿ≠ÿØÿßÿ´
    setupEventListeners() {
        // ÿ™ÿ¥ÿ∫ŸäŸÑ ÿ¨ŸÖŸäÿπ ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™
        document.getElementById('runAllAlgorithms')?.addEventListener('click', async () => {
            await this.runAllAlgorithms();
        });

        // ÿ™ŸÇÿ±Ÿäÿ± ÿßŸÑÿ£ÿØÿßÿ°
        document.getElementById('algorithmReport')?.addEventListener('click', () => {
            this.generatePerformanceReport();
        });

        // ÿßŸÑÿ™ÿ≠ŸÉŸÖ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä
        document.getElementById('masterAlgorithmSwitch')?.addEventListener('change', (e) => {
            this.toggleAllAlgorithms(e.target.checked);
        });

        // ŸÅŸÑÿ™ÿ±ÿ© ÿßŸÑŸÅÿ¶ÿßÿ™
        document.querySelectorAll('[data-category]').forEach(btn => {
            btn.addEventListener('click', (e) => {
                this.filterByCategory(e.target.dataset.category);
            });
        });
    }

    // ÿ™ÿ¥ÿ∫ŸäŸÑ ÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿ© Ÿàÿßÿ≠ÿØÿ©
    async runSingleAlgorithm(algorithmId) {
        const algorithm = this.algorithms.algorithms.find(alg => alg.id === algorithmId);
        if (!algorithm) return;

        try {
            this.updateAlgorithmStatus(algorithmId, 'running');
            this.showProgress(algorithmId, true);

            // ÿ¨ŸÖÿπ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
            const data = await this.algorithms.collectData();

            // ÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿ©
            const result = await algorithm.algorithm.call(this.algorithms, data);

            // ÿ≠ŸÅÿ∏ ÿßŸÑŸÜÿ™Ÿäÿ¨ÿ©
            this.algorithms.results[algorithmId] = {
                ...result,
                timestamp: new Date(),
                status: 'complete'
            };

            this.updateAlgorithmStatus(algorithmId, 'complete');
            this.showAlgorithmResult(algorithmId, result);

        } catch (error) {
            console.error(`Algorithm ${algorithmId} failed:`, error);
            this.updateAlgorithmStatus(algorithmId, 'error');
            showNotification('error', `ŸÅÿ¥ŸÑ ŸÅŸä ÿ™ÿ¥ÿ∫ŸäŸÑ ${algorithm.name}: ${error.message}`);
        } finally {
            this.showProgress(algorithmId, false);
        }
    }

    // ÿ™ÿ¥ÿ∫ŸäŸÑ ÿ¨ŸÖŸäÿπ ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™
    async runAllAlgorithms() {
        const enabledAlgorithms = this.algorithms.algorithms.filter(alg => alg.enabled);
        
        if (enabledAlgorithms.length === 0) {
            showNotification('info', 'ÿßŸÑÿ±ÿ¨ÿßÿ° ÿ™ŸÅÿπŸäŸÑ ÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿ© Ÿàÿßÿ≠ÿØÿ© ÿπŸÑŸâ ÿßŸÑÿ£ŸÇŸÑ');
            return;
        }

        showNotification('info', `ÿ®ÿØÿ° ÿ™ÿ¥ÿ∫ŸäŸÑ ${enabledAlgorithms.length} ÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿ©...`);

        try {
            await this.algorithms.runAllAlgorithms();
            this.displayAllResults();
            showNotification('success', 'ÿ™ŸÖ ÿ™ÿ¥ÿ∫ŸäŸÑ ÿ¨ŸÖŸäÿπ ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™ ÿ®ŸÜÿ¨ÿßÿ≠!');
        } catch (error) {
            showNotification('error', 'ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ŸÅŸä ÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™');
        }

        this.updateSystemStatus();
    }

    // ÿ™ŸÅÿπŸäŸÑ/ÿ•ŸÑÿ∫ÿßÿ° ÿ™ŸÅÿπŸäŸÑ ÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿ©
    toggleAlgorithm(algorithmId) {
        const algorithm = this.algorithms.algorithms.find(alg => alg.id === algorithmId);
        if (algorithm) {
            algorithm.enabled = !algorithm.enabled;
            this.updateSystemStatus();
        }
    }

    // ÿ™ŸÅÿπŸäŸÑ/ÿ•ŸÑÿ∫ÿßÿ° ÿ™ŸÅÿπŸäŸÑ ÿ¨ŸÖŸäÿπ ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™
    toggleAllAlgorithms(enabled) {
        this.algorithms.algorithms.forEach(algorithm => {
            algorithm.enabled = enabled;
            document.getElementById(`switch-${algorithm.id}`).checked = enabled;
        });
        this.updateSystemStatus();
        showNotification('info', enabled ? 'ÿ™ŸÖ ÿ™ŸÅÿπŸäŸÑ ÿ¨ŸÖŸäÿπ ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™' : 'ÿ™ŸÖ ÿ•ŸÑÿ∫ÿßÿ° ÿ™ŸÅÿπŸäŸÑ ÿ¨ŸÖŸäÿπ ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™');
    }

    // ŸÅŸÑÿ™ÿ±ÿ© ÿ≠ÿ≥ÿ® ÿßŸÑŸÅÿ¶ÿ©
    filterByCategory(category) {
        this.currentCategory = category;
        
        // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ£ÿ≤ÿ±ÿßÿ±
        document.querySelectorAll('[data-category]').forEach(btn => {
            btn.classList.remove('active');
        });
        document.querySelector(`[data-category="${category}"]`).classList.add('active');

        // ÿ•ÿπÿßÿØÿ© ÿπÿ±ÿ∂ ÿßŸÑÿ¥ÿ®ŸÉÿ©
        this.renderAlgorithmsGrid();
    }

    // ÿ™ÿ≠ÿØŸäÿ´ ÿ≠ÿßŸÑÿ© ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿ©
    updateAlgorithmStatus(algorithmId, status) {
        const statusElement = document.getElementById(`status-${algorithmId}`);
        if (statusElement) {
            const statusTexts = {
                'idle': 'ŸÖÿ™ŸàŸÇŸÅ',
                'running': 'ŸÇŸäÿØ ÿßŸÑÿ™ÿ¥ÿ∫ŸäŸÑ',
                'complete': 'ŸÖŸÉÿ™ŸÖŸÑ',
                'error': 'ÿÆÿ∑ÿ£'
            };
            statusElement.textContent = statusTexts[status] || status;
            statusElement.className = `algorithm-stat-value status-${status}`;
        }

        // ÿ™ÿ≠ÿØŸäÿ´ ŸÖÿ§ÿ¥ÿ± ÿßŸÑÿ≠ÿßŸÑÿ©
        const indicator = document.querySelector(`#switch-${algorithmId} + label .algorithm-status`);
        if (indicator) {
            indicator.className = `algorithm-status status-${status}`;
        }
    }

    // ÿ•ÿ∏Ÿáÿßÿ± ÿßŸÑÿ™ŸÇÿØŸÖ
    showProgress(algorithmId, show) {
        const progressElement = document.getElementById(`progress-${algorithmId}`);
        if (progressElement) {
            progressElement.style.display = show ? 'block' : 'none';
            if (show) {
                this.animateProgress(algorithmId);
            }
        }
    }

    // ÿ™ÿ≠ÿ±ŸäŸÉ ÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿ™ŸÇÿØŸÖ
    animateProgress(algorithmId) {
        const progressBar = document.querySelector(`#progress-${algorithmId} .algorithm-progress-bar`);
        if (!progressBar) return;

        let width = 0;
        const interval = setInterval(() => {
            width += Math.random() * 10;
            if (width > 90) width = 90;
            progressBar.style.width = width + '%';
            
            // ÿßŸÑÿ™ŸàŸÇŸÅ ÿπŸÜÿØ ÿßŸÉÿ™ŸÖÿßŸÑ ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿ©
            const result = this.algorithms.results[algorithmId];
            if (result && result.status === 'complete') {
                progressBar.style.width = '100%';
                clearInterval(interval);
            }
        }, 200);
    }

    // ÿπÿ±ÿ∂ ŸÜÿ™Ÿäÿ¨ÿ© ÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿ©
    showAlgorithmResult(algorithmId, result) {
        const algorithm = this.algorithms.algorithms.find(alg => alg.id === algorithmId);
        
        // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÜÿ™Ÿäÿ¨ÿ© ŸÅŸä ÿßŸÑÿ®ÿ∑ÿßŸÇÿ©
        const scoreElement = document.getElementById(`score-${algorithmId}`);
        if (scoreElement) {
            scoreElement.textContent = result.score || '‚úì';
        }

        // ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÜÿ™Ÿäÿ¨ÿ© ŸÑŸÑÿπÿ±ÿ∂ ÿßŸÑÿπÿßŸÖ
        this.addResultToDisplay(algorithm, result);
        
        showNotification('success', `ÿ™ŸÖ ÿ™ÿ¥ÿ∫ŸäŸÑ ${algorithm.name} ÿ®ŸÜÿ¨ÿßÿ≠`);
    }

    // ÿ•ÿ∂ÿßŸÅÿ© ŸÜÿ™Ÿäÿ¨ÿ© ŸÑŸÑÿπÿ±ÿ∂
    addResultToDisplay(algorithm, result) {
        const resultsContainer = document.getElementById('algorithmResults');
        if (!resultsContainer) return;

        // ÿ•ÿ≤ÿßŸÑÿ© ÿ±ÿ≥ÿßŸÑÿ© "ŸÑŸÖ Ÿäÿ™ŸÖ ÿ™ÿ¥ÿ∫ŸäŸÑ"
        if (resultsContainer.querySelector('.text-muted')) {
            resultsContainer.innerHTML = '';
        }

        const resultHTML = `
            <div class="algorithm-result-item" data-algorithm="${algorithm.id}">
                <div class="algorithm-result-title">
                    <i class="${algorithm.icon} me-2"></i>
                    ${algorithm.name}
                </div>
                <div class="algorithm-result-value">
                    ${result.score ? `ÿßŸÑŸÜÿ™Ÿäÿ¨ÿ©: ${result.score}` : 'ÿ™ŸÖ ÿßŸÑÿ™ÿ¥ÿ∫ŸäŸÑ ÿ®ŸÜÿ¨ÿßÿ≠'}
                </div>
                <div class="algorithm-result-description">
                    ${result.insights ? result.insights.join(' ‚Ä¢ ') : 'ÿ™ŸÖ ŸÖÿπÿßŸÑÿ¨ÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ Ÿàÿ•ŸÜÿ™ÿßÿ¨ ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨'}
                </div>
                <small class="text-muted">
                    <i class="fas fa-clock me-1"></i>
                    ${new Date().toLocaleTimeString('ar-EG')}
                </small>
            </div>
        `;

        resultsContainer.insertAdjacentHTML('afterbegin', resultHTML);
    }

    // ÿπÿ±ÿ∂ ÿ¨ŸÖŸäÿπ ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨
    displayAllResults() {
        const resultsContainer = document.getElementById('algorithmResults');
        if (!resultsContainer) return;

        resultsContainer.innerHTML = '';

        Object.entries(this.algorithms.results).forEach(([algorithmId, result]) => {
            const algorithm = this.algorithms.algorithms.find(alg => alg.id === algorithmId);
            if (algorithm && result.status === 'complete') {
                this.addResultToDisplay(algorithm, result);
            }
        });
    }

    // ÿ™ÿ≠ÿØŸäÿ´ ÿ≠ÿßŸÑÿ© ÿßŸÑŸÜÿ∏ÿßŸÖ
    updateSystemStatus() {
        const totalAlgorithms = this.algorithms.algorithms.length;
        const activeAlgorithms = this.algorithms.algorithms.filter(alg => alg.enabled).length;
        const completedAlgorithms = Object.keys(this.algorithms.results).length;

        // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿπÿØÿßÿØÿßÿ™
        document.getElementById('activeAlgorithmsCount').textContent = `${activeAlgorithms}/${totalAlgorithms}`;
        
        // ÿ™ÿ≠ÿØŸäÿ´ ŸÖÿπÿØŸÑ ÿßŸÑÿ£ÿØÿßÿ°
        const performanceRate = totalAlgorithms > 0 ? Math.round((completedAlgorithms / totalAlgorithms) * 100) : 0;
        document.getElementById('performanceRate').textContent = `${performanceRate}%`;

        // ÿ™ÿ≠ÿØŸäÿ´ ŸàŸÇÿ™ ÿ¢ÿÆÿ± ÿ™ÿ≠ÿØŸäÿ´
        document.getElementById('lastAlgorithmUpdate').textContent = new Date().toLocaleTimeString('ar-EG');
    }

    // ÿ•ÿ∏Ÿáÿßÿ± ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿ©
    showAlgorithmDetails(algorithmId) {
        const algorithm = this.algorithms.algorithms.find(alg => alg.id === algorithmId);
        const result = this.algorithms.results[algorithmId];

        const modalContent = `
            <div class="modal fade" id="algorithmDetailsModal" tabindex="-1">
                <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">
                                <i class="${algorithm.icon} me-2"></i>
                                ${algorithm.name}
                            </h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                        </div>
                        <div class="modal-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <h6>ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿ©:</h6>
                                    <ul class="list-unstyled">
                                        <li><strong>ÿßŸÑŸÅÿ¶ÿ©:</strong> ${this.getCategoryName(algorithm.category)}</li>
                                        <li><strong>ÿßŸÑÿ™ÿπŸÇŸäÿØ:</strong> ${algorithm.complexity}</li>
                                        <li><strong>ÿßŸÑÿ≠ÿßŸÑÿ©:</strong> ${algorithm.enabled ? 'ŸÖŸÅÿπŸÑ' : 'ŸÖÿπÿ∑ŸÑ'}</li>
                                    </ul>
                                    <h6>ÿßŸÑŸàÿµŸÅ:</h6>
                                    <p>${algorithm.description}</p>
                                </div>
                                <div class="col-md-6">
                                    <h6>ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨:</h6>
                                    ${result ? `
                                        <div class="alert alert-success">
                                            <strong>ÿ¢ÿÆÿ± ÿ™ÿ¥ÿ∫ŸäŸÑ:</strong> ${result.timestamp.toLocaleString('ar-EG')}<br>
                                            ${result.insights ? `<strong>ÿßŸÑÿ±ÿ§Ÿâ:</strong><br>${result.insights.join('<br>')}` : ''}
                                        </div>
                                    ` : '<p class="text-muted">ŸÑŸÖ Ÿäÿ™ŸÖ ÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿ© ÿ®ÿπÿØ</p>'}
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary" onclick="algorithmsUI.runSingleAlgorithm('${algorithmId}')">
                                <i class="fas fa-play me-2"></i>ÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑÿ¢ŸÜ
                            </button>
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ÿ•ÿ∫ŸÑÿßŸÇ</button>
                        </div>
                    </div>
                </div>
            </div>
        `;

        // ÿ•ÿ≤ÿßŸÑÿ© ÿßŸÑŸÖŸàÿØÿßŸÑ ÿßŸÑÿ≥ÿßÿ®ŸÇ
        document.getElementById('algorithmDetailsModal')?.remove();
        
        // ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÖŸàÿØÿßŸÑ ÿßŸÑÿ¨ÿØŸäÿØ
        document.body.insertAdjacentHTML('beforeend', modalContent);
        
        // ÿ•ÿ∏Ÿáÿßÿ± ÿßŸÑŸÖŸàÿØÿßŸÑ
        new bootstrap.Modal(document.getElementById('algorithmDetailsModal')).show();
    }

    // ÿ•ŸÜÿ™ÿßÿ¨ ÿ™ŸÇÿ±Ÿäÿ± ÿßŸÑÿ£ÿØÿßÿ°
    generatePerformanceReport() {
        const report = {
            totalAlgorithms: this.algorithms.algorithms.length,
            activeAlgorithms: this.algorithms.algorithms.filter(alg => alg.enabled).length,
            completedRuns: Object.keys(this.algorithms.results).length,
            successRate: this.calculateSuccessRate(),
            averageRunTime: this.calculateAverageRunTime(),
            categories: this.getCategoryBreakdown()
        };

        this.showPerformanceReport(report);
    }

    // ÿπÿ±ÿ∂ ÿ™ŸÇÿ±Ÿäÿ± ÿßŸÑÿ£ÿØÿßÿ°
    showPerformanceReport(report) {
        const modalContent = `
            <div class="modal fade" id="performanceReportModal" tabindex="-1">
                <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">
                                <i class="fas fa-chart-line me-2"></i>
                                ÿ™ŸÇÿ±Ÿäÿ± ÿ£ÿØÿßÿ° ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™
                            </h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                        </div>
                        <div class="modal-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="stats-card">
                                        <div class="stats-number">${report.totalAlgorithms}</div>
                                        <div class="stats-label">ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="stats-card">
                                        <div class="stats-number">${report.activeAlgorithms}</div>
                                        <div class="stats-label">ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™ ÿßŸÑŸÖŸÅÿπŸÑÿ©</div>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-3">
                                <div class="col-md-6">
                                    <div class="stats-card">
                                        <div class="stats-number">${report.successRate}%</div>
                                        <div class="stats-label">ŸÖÿπÿØŸÑ ÿßŸÑŸÜÿ¨ÿßÿ≠</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="stats-card">
                                        <div class="stats-number">${report.completedRuns}</div>
                                        <div class="stats-label">ÿπÿØÿØ ÿßŸÑÿ™ÿ¥ÿ∫ŸäŸÑÿßÿ™</div>
                                    </div>
                                </div>
                            </div>
                            <h6 class="mt-4">ÿßŸÑÿ™Ÿàÿ≤Ÿäÿπ ÿ≠ÿ≥ÿ® ÿßŸÑŸÅÿ¶ÿßÿ™:</h6>
                            ${Object.entries(report.categories).map(([category, count]) => `
                                <div class="d-flex justify-content-between">
                                    <span>${this.getCategoryName(category)}:</span>
                                    <span class="badge bg-primary">${count}</span>
                                </div>
                            `).join('')}
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ÿ•ÿ∫ŸÑÿßŸÇ</button>
                        </div>
                    </div>
                </div>
            </div>
        `;

        // ÿ•ÿ∂ÿßŸÅÿ© Ÿàÿ•ÿ∏Ÿáÿßÿ± ÿßŸÑŸÖŸàÿØÿßŸÑ
        document.body.insertAdjacentHTML('beforeend', modalContent);
        new bootstrap.Modal(document.getElementById('performanceReportModal')).show();
    }

    // ÿØŸàÿßŸÑ ŸÖÿ≥ÿßÿπÿØÿ©
    getCategoryName(category) {
        const names = {
            'analytics': 'ÿ™ÿ≠ŸÑŸäŸÑÿßÿ™',
            'prediction': 'ÿ™ŸÜÿ®ÿ§ÿßÿ™',
            'security': 'ÿ£ŸÖÿßŸÜ',
            'optimization': 'ÿ™ÿ≠ÿ≥ŸäŸÜ'
        };
        return names[category] || category;
    }

    calculateSuccessRate() {
        const total = Object.keys(this.algorithms.results).length;
        const successful = Object.values(this.algorithms.results).filter(r => r.status === 'complete').length;
        return total > 0 ? Math.round((successful / total) * 100) : 0;
    }

    calculateAverageRunTime() {
        // ŸÖÿ≠ÿßŸÉÿßÿ© ÿ≠ÿ≥ÿßÿ® ŸÖÿ™Ÿàÿ≥ÿ∑ ŸàŸÇÿ™ ÿßŸÑÿ™ÿ¥ÿ∫ŸäŸÑ
        return '2.3s';
    }

    getCategoryBreakdown() {
        const breakdown = {};
        this.algorithms.algorithms.forEach(alg => {
            breakdown[alg.category] = (breakdown[alg.category] || 0) + 1;
        });
        return breakdown;
    }
}

// ÿ•ÿ∏Ÿáÿßÿ± ŸÇÿ≥ŸÖ ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™
function showAlgorithms() {
    hideAllPanels();
    document.getElementById('algorithmsPanel').style.display = 'block';
}

// ÿ™ŸáŸäÿ¶ÿ© ŸÜÿ∏ÿßŸÖ ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™ ÿπŸÜÿØ ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿµŸÅÿ≠ÿ©
document.addEventListener('DOMContentLoaded', function() {
    // ÿ™ŸáŸäÿ¶ÿ© ŸÜÿ∏ÿßŸÖ ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™
    window.algorithmsUI = new AlgorithmsUIController(smartAlgorithms);
    
    // ÿ•ÿ∂ÿßŸÅÿ© ÿ±ÿßÿ®ÿ∑ ŸÅŸä ÿßŸÑÿ™ŸÜŸÇŸÑ
    const algorithmsLink = document.createElement('li');
    algorithmsLink.className = 'nav-item admin-only';
    algorithmsLink.innerHTML = `
        <a class="nav-link nav-link-modern" href="#algorithms" id="algorithmsLink" aria-label="Smart Algorithms">
            <i class="fas fa-brain nav-icon"></i>
            <span class="nav-text">ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™ ÿßŸÑÿ∞ŸÉŸäÿ©</span>
            <span class="nav-badge" style="background: linear-gradient(135deg, #6a11cb, #2575fc);">AI</span>
        </a>
    `;
    
    // ÿ•ÿØÿ±ÿßÿ¨ ÿßŸÑÿ±ÿßÿ®ÿ∑ ŸÅŸä navbar
    const navList = document.querySelector('.navbar-nav');
    if (navList) {
        navList.insertBefore(algorithmsLink, navList.children[4]); // ŸÇÿ®ŸÑ ÿßŸÑŸÖŸäÿ≤ÿßÿ™
    }
    
    // ŸÖÿπÿßŸÑÿ¨ ÿßŸÑŸÜŸÇÿ± ÿπŸÑŸâ ÿ±ÿßÿ®ÿ∑ ÿßŸÑÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™
    document.getElementById('algorithmsLink')?.addEventListener('click', function(e) {
        e.preventDefault();
        window.location.hash = 'algorithms';
        showAlgorithms();
        updateActiveNavLink('algorithms');
        window.scrollTo(0, 0);
    });
});

        // üìÇ ŸÜÿ∏ÿßŸÖ ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ±Ÿàÿßÿ®ÿ∑ ÿßŸÑŸÖÿ¨ŸÖÿπÿ© (Bulk Link Import)
class BulkLinkImport {
    constructor() {
        this.currentStep = 1;
        this.maxSteps = 4;
        this.selectedContentType = '';
        this.uploadedFile = null;
        this.parsedData = [];
        this.validData = [];
        this.errors = [];
        this.isProcessing = false;
        this.processingStats = {
            total: 0,
            processed: 0,
            success: 0,
            failed: 0
        };
        
        this.contentTypeIcons = {
            'series': 'fas fa-tv',
            'movie': 'fas fa-film', 
            'match': 'fas fa-futbol',
            'recipe': 'fas fa-utensils',
            'game': 'fas fa-gamepad',
            'app': 'fas fa-mobile-alt',
            'channel': 'fas fa-broadcast-tower',
            'reels': 'fas fa-video'
        };
        
        this.contentTypeNames = {
            'series': 'ŸÖÿ≥ŸÑÿ≥ŸÑÿßÿ™',
            'movie': 'ÿ£ŸÅŸÑÿßŸÖ',
            'match': 'ŸÖÿ®ÿßÿ±Ÿäÿßÿ™', 
            'recipe': 'ŸàÿµŸÅÿßÿ™',
            'game': 'ÿ£ŸÑÿπÿßÿ®',
            'app': 'ÿ™ÿ∑ÿ®ŸäŸÇÿßÿ™',
            'channel': 'ŸÇŸÜŸàÿßÿ™',
            'reels': 'ÿ±ŸäŸÑÿ≤'
        };
        
        this.init();
    }

    init() {
        this.setupEventListeners();
        this.updateStepDisplay();
    }

    setupEventListeners() {
        // Content type selection
        document.getElementById('bulkContentType')?.addEventListener('change', (e) => {
            this.handleContentTypeChange(e.target.value);
        });

        // File upload
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('bulkFileInput');
        
        uploadArea?.addEventListener('click', () => fileInput?.click());
        uploadArea?.addEventListener('dragover', this.handleDragOver.bind(this));
        uploadArea?.addEventListener('dragleave', this.handleDragLeave.bind(this));
        uploadArea?.addEventListener('drop', this.handleFileDrop.bind(this));
        
        fileInput?.addEventListener('change', (e) => {
            if (e.target.files[0]) this.handleFileSelect(e.target.files[0]);
        });

        // Remove file
        document.getElementById('removeFile')?.addEventListener('click', () => {
            this.removeFile();
        });

        // Download template
        document.getElementById('downloadTemplate')?.addEventListener('click', () => {
            this.downloadTemplate();
        });

        // Navigation buttons
        document.getElementById('nextStep')?.addEventListener('click', () => {
            this.nextStep();
        });
        
        document.getElementById('prevStep')?.addEventListener('click', () => {
            this.prevStep();
        });

        // Start bulk import
        document.getElementById('startBulkImport')?.addEventListener('click', () => {
            this.startBulkImport();
        });

        // Cancel processing
        document.getElementById('cancelProcessing')?.addEventListener('click', () => {
            this.cancelProcessing();
        });

        // Download report
        document.getElementById('downloadReport')?.addEventListener('click', () => {
            this.downloadReport();
        });
    }

    // Handle content type selection
    handleContentTypeChange(contentType) {
        this.selectedContentType = contentType;
        this.updateContentTypePreview(contentType);
        this.updateStepNavigation();
    }

    updateContentTypePreview(contentType) {
        const preview = document.getElementById('contentTypePreview');
        if (!preview) return;

        if (contentType) {
            const icon = this.contentTypeIcons[contentType];
            const name = this.contentTypeNames[contentType];
            
            preview.innerHTML = `
                <i class="${icon} content-icon ${contentType}"></i>
                <h5>${name}</h5>
                <p class="text-muted">ÿ™ŸÖ ÿßÿÆÿ™Ÿäÿßÿ± ${name} ŸÉŸÜŸàÿπ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ</p>
            `;
            preview.classList.add('active');
        } else {
            preview.innerHTML = `
                <i class="fas fa-film fa-3x text-muted"></i>
                <p class="text-muted mt-2">ÿßÿÆÿ™ÿ± ŸÜŸàÿπ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ŸÑÿ±ÿ§Ÿäÿ© ÿßŸÑŸÖÿπÿßŸäŸÜÿ©</p>
            `;
            preview.classList.remove('active');
        }
    }

    // File handling
    handleDragOver(e) {
        e.preventDefault();
        document.getElementById('uploadArea')?.classList.add('dragover');
    }

    handleDragLeave(e) {
        e.preventDefault();
        document.getElementById('uploadArea')?.classList.remove('dragover');
    }

    handleFileDrop(e) {
        e.preventDefault();
        document.getElementById('uploadArea')?.classList.remove('dragover');
        
        const files = e.dataTransfer.files;
        if (files[0]) this.handleFileSelect(files[0]);
    }

    async handleFileSelect(file) {
        if (!this.validateFile(file)) return;
        
        this.uploadedFile = file;
        this.showFileInfo(file);
        
        try {
            await this.parseFile(file);
            this.updateStepNavigation();
        } catch (error) {
            showNotification('error', `ÿÆÿ∑ÿ£ ŸÅŸä ŸÇÿ±ÿßÿ°ÿ© ÿßŸÑŸÖŸÑŸÅ: ${error.message}`);
        }
    }

    validateFile(file) {
        const maxSize = 50 * 1024 * 1024; // 50MB
        const allowedTypes = [
            'text/csv',
            'application/vnd.ms-excel',
            'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'
        ];

        if (file.size > maxSize) {
            showNotification('error', 'ÿ≠ÿ¨ŸÖ ÿßŸÑŸÖŸÑŸÅ ŸÉÿ®Ÿäÿ± ÿ¨ÿØÿßŸã (ÿ£ŸÇÿµŸâ ÿ≠ÿØ: 50MB)');
            return false;
        }

        if (!allowedTypes.includes(file.type) && !file.name.match(/\.(csv|xlsx|xls)$/i)) {
            showNotification('error', 'ŸÜŸàÿπ ÿßŸÑŸÖŸÑŸÅ ÿ∫Ÿäÿ± ŸÖÿØÿπŸàŸÖ. ŸäŸèÿ±ÿ¨Ÿâ ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ CSV ÿ£Ÿà Excel');
            return false;
        }

        return true;
    }

    showFileInfo(file) {
        const fileInfo = document.getElementById('fileInfo');
        const fileName = document.getElementById('fileName');
        const fileSize = document.getElementById('fileSize');
        
        if (fileInfo && fileName && fileSize) {
            fileName.textContent = file.name;
            fileSize.textContent = this.formatFileSize(file.size);
            fileInfo.style.display = 'block';
        }
    }

    formatFileSize(bytes) {
        if (bytes === 0) return '0 Bytes';
        const k = 1024;
        const sizes = ['Bytes', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }

    removeFile() {
        this.uploadedFile = null;
        this.parsedData = [];
        this.validData = [];
        this.errors = [];
        
        document.getElementById('fileInfo').style.display = 'none';
        document.getElementById('bulkFileInput').value = '';
        
        this.updateStepNavigation();
    }

    // File parsing
    async parseFile(file) {
        const fileExtension = file.name.split('.').pop().toLowerCase();
        
        if (fileExtension === 'csv') {
            await this.parseCSV(file);
        } else {
            await this.parseExcel(file);
        }
        
        this.validateData();
        this.updateDataPreview();
    }

    async parseCSV(file) {
        return new Promise((resolve, reject) => {
            Papa.parse(file, {
                header: true,
                skipEmptyLines: true,
                dynamicTyping: true,
                complete: (results) => {
                    this.parsedData = results.data;
                    document.getElementById('rowCount').textContent = `${results.data.length} ÿµŸÅ`;
                    resolve();
                },
                error: (error) => reject(new Error(`ÿÆÿ∑ÿ£ ŸÅŸä ŸÇÿ±ÿßÿ°ÿ© CSV: ${error.message}`))
            });
        });
    }

    async parseExcel(file) {
        return new Promise((resolve, reject) => {
            const reader = new FileReader();
            
            reader.onload = (e) => {
                try {
                    const workbook = XLSX.read(e.target.result, { type: 'binary' });
                    const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                    const data = XLSX.utils.sheet_to_json(firstSheet);
                    
                    this.parsedData = data;
                    document.getElementById('rowCount').textContent = `${data.length} ÿµŸÅ`;
                    resolve();
                } catch (error) {
                    reject(new Error(`ÿÆÿ∑ÿ£ ŸÅŸä ŸÇÿ±ÿßÿ°ÿ© Excel: ${error.message}`));
                }
            };
            
            reader.onerror = () => reject(new Error('ŸÅÿ¥ŸÑ ŸÅŸä ŸÇÿ±ÿßÿ°ÿ© ÿßŸÑŸÖŸÑŸÅ'));
            reader.readAsBinaryString(file);
        });
    }

    // Data validation
    validateData() {
        this.validData = [];
        this.errors = [];
        
        const requiredFields = ['name', 'originalUrl'];
        const optionalFields = ['socialTitle', 'socialDescription', 'socialImage'];
        
        this.parsedData.forEach((row, index) => {
            const rowNumber = index + 2; // +2 because index starts at 0 and we skip header
            const rowErrors = [];
            
            // Check required fields
            requiredFields.forEach(field => {
                if (!row[field] || row[field].toString().trim() === '') {
                    rowErrors.push(`ÿßŸÑÿµŸÅ ${rowNumber}: ÿßŸÑÿ≠ŸÇŸÑ "${field}" ŸÖÿ∑ŸÑŸàÿ®`);
                }
            });
            
            // Validate URL
            if (row.originalUrl && !this.isValidUrl(row.originalUrl)) {
                rowErrors.push(`ÿßŸÑÿµŸÅ ${rowNumber}: ÿßŸÑÿ±ÿßÿ®ÿ∑ ÿ∫Ÿäÿ± ÿµÿßŸÑÿ≠`);
            }
            
            // Validate name
            if (row.name && !this.isValidSeriesName(row.name)) {
                rowErrors.push(`ÿßŸÑÿµŸÅ ${rowNumber}: ÿßÿ≥ŸÖ ÿ∫Ÿäÿ± ÿµÿßŸÑÿ≠ (Ÿäÿ¨ÿ® ÿ£ŸÜ Ÿäÿ≠ÿ™ŸàŸä ÿπŸÑŸâ ÿ£ÿ≠ÿ±ŸÅ Ÿàÿ£ÿ±ŸÇÿßŸÖ ŸÅŸÇÿ∑)`);
            }
            
            if (rowErrors.length === 0) {
                this.validData.push({
                    ...row,
                    rowNumber: rowNumber
                });
            } else {
                this.errors.push(...rowErrors);
            }
        });
    }

    isValidUrl(url) {
        try {
            new URL(url);
            return true;
        } catch {
            return false;
        }
    }

    isValidSeriesName(name) {
        const regex = /^[\p{Script=Arabic}\w\s\-_,.\u0600-\u06FF]+$/u;
        return regex.test(name);
    }

    // Data preview
    updateDataPreview() {
        const totalRows = document.getElementById('totalRows');
        const validRows = document.getElementById('validRows');
        const errorRows = document.getElementById('errorRows');
        
        if (totalRows) totalRows.textContent = this.parsedData.length;
        if (validRows) validRows.textContent = this.validData.length;
        if (errorRows) errorRows.textContent = this.errors.length;
        
        this.renderPreviewTable();
        this.showValidationErrors();
    }

    renderPreviewTable() {
        const tableHeader = document.getElementById('previewTableHeader');
        const tableBody = document.getElementById('previewTableBody');
        
        if (!tableHeader || !tableBody || this.parsedData.length === 0) return;
        
        // Create header
        const sampleRow = this.parsedData[0];
        const headers = Object.keys(sampleRow);
        
        tableHeader.innerHTML = `
            <tr>
                <th>ÿßŸÑÿµŸÅ</th>
                ${headers.map(header => `<th>${header}</th>`).join('')}
                <th>ÿßŸÑÿ≠ÿßŸÑÿ©</th>
            </tr>
        `;
        
        // Create body (show first 10 rows)
        const previewRows = this.parsedData.slice(0, 10);
        
        tableBody.innerHTML = previewRows.map((row, index) => {
            const rowNumber = index + 2;
            const isValid = this.validData.some(validRow => validRow.rowNumber === rowNumber);
            const statusClass = isValid ? 'text-success' : 'text-danger';
            const statusIcon = isValid ? 'fas fa-check-circle' : 'fas fa-times-circle';
            const statusText = isValid ? 'ÿµÿ≠Ÿäÿ≠' : 'ÿÆÿ∑ÿ£';
            
            return `
                <tr>
                    <td><strong>${rowNumber}</strong></td>
                    ${headers.map(header => 
                        `<td title="${row[header] || ''}">${(row[header] || '').toString().substring(0, 30)}${(row[header] || '').length > 30 ? '...' : ''}</td>`
                    ).join('')}
                    <td class="${statusClass}">
                        <i class="${statusIcon} me-1"></i>${statusText}
                    </td>
                </tr>
            `;
        }).join('');
        
        if (this.parsedData.length > 10) {
            tableBody.innerHTML += `
                <tr>
                    <td colspan="${headers.length + 2}" class="text-center text-muted">
                        ... Ÿàÿπÿ±ÿ∂ ${this.parsedData.length - 10} ÿµŸÅ ÿ•ÿ∂ÿßŸÅŸä
                    </td>
                </tr>
            `;
        }
    }

    showValidationErrors() {
        const errorsContainer = document.getElementById('validationErrors');
        const errorsList = document.getElementById('errorsList');
        
        if (!errorsContainer || !errorsList) return;
        
        if (this.errors.length > 0) {
            errorsList.innerHTML = this.errors.map(error => 
                `<li><i class="fas fa-exclamation-triangle me-2"></i>${error}</li>`
            ).join('');
            errorsContainer.style.display = 'block';
        } else {
            errorsContainer.style.display = 'none';
        }
    }

    // Template download
    downloadTemplate() {
        const headers = [
            'name',
            'originalUrl', 
            'socialTitle',
            'socialDescription',
            'socialImage'
        ];
        
        const sampleData = [
            {
                name: 'ŸÖÿ≥ŸÑÿ≥ŸÑ ÿ™ÿ¨ÿ±Ÿäÿ®Ÿä',
                originalUrl: 'https://example.com/series1',
                socialTitle: 'ÿ¥ÿßŸáÿØ ÿßŸÑŸÖÿ≥ŸÑÿ≥ŸÑ ÿßŸÑÿ¨ÿØŸäÿØ',
                socialDescription: 'ÿ£ÿ≠ÿØÿßÿ´ ŸÖÿ¥ŸàŸÇÿ© ŸàŸÇÿµÿ© ÿ±ÿßÿ¶ÿπÿ©',
                socialImage: 'https://example.com/image1.jpg'
            },
            {
                name: 'ŸÖÿ≥ŸÑÿ≥ŸÑ ÿ¢ÿÆÿ±',
                originalUrl: 'https://example.com/series2', 
                socialTitle: 'ŸÖÿ≥ŸÑÿ≥ŸÑ ÿ±ÿßÿ¶ÿπ ÿ¢ÿÆÿ±',
                socialDescription: 'ÿßÿ≥ÿ™ŸÖÿ™ÿπ ÿ®ÿßŸÑŸÖÿ¥ÿßŸáÿØÿ©',
                socialImage: 'https://example.com/image2.jpg'
            }
        ];
        
        const csv = Papa.unparse({
            fields: headers,
            data: sampleData
        });
        
        const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = `turkify_bulk_template_${this.selectedContentType || 'general'}.csv`;
        link.click();
        
        showNotification('success', 'ÿ™ŸÖ ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑŸÇÿßŸÑÿ® ÿ®ŸÜÿ¨ÿßÿ≠!');
    }

    // Step navigation
    nextStep() {
        if (this.currentStep < this.maxSteps) {
            this.currentStep++;
            this.updateStepDisplay();
            this.updateStepNavigation();
        }
    }

    prevStep() {
        if (this.currentStep > 1) {
            this.currentStep--;
            this.updateStepDisplay();
            this.updateStepNavigation();
        }
    }

    updateStepDisplay() {
        // Hide all steps
        for (let i = 1; i <= this.maxSteps; i++) {
            const step = document.getElementById(`step${i}`);
            if (step) {
                step.style.display = i === this.currentStep ? 'block' : 'none';
                step.classList.toggle('active', i === this.currentStep);
                step.classList.toggle('completed', i < this.currentStep);
            }
        }
    }

    updateStepNavigation() {
        const nextBtn = document.getElementById('nextStep');
        const prevBtn = document.getElementById('prevStep');
        const importBtn = document.getElementById('startBulkImport');
        
        // Previous button
        if (prevBtn) {
            prevBtn.style.display = this.currentStep > 1 ? 'inline-block' : 'none';
        }
        
        // Next button
        if (nextBtn) {
            let canProceed = false;
            
            switch (this.currentStep) {
                case 1:
                    canProceed = !!this.selectedContentType;
                    break;
                case 2:
                    canProceed = !!this.uploadedFile && this.parsedData.length > 0;
                    break;
                case 3:
                    canProceed = this.validData.length > 0;
                    break;
                case 4:
                    canProceed = true;
                    break;
            }
            
            nextBtn.disabled = !canProceed;
            nextBtn.style.display = this.currentStep < this.maxSteps ? 'inline-block' : 'none';
        }
        
        // Import button
        if (importBtn) {
            importBtn.style.display = this.currentStep === this.maxSteps ? 'inline-block' : 'none';
        }
    }

    // Bulk import processing
    async startBulkImport() {
        if (this.isProcessing) return;
        
        this.isProcessing = true;
        this.processingStats = {
            total: this.validData.length,
            processed: 0,
            success: 0,
            failed: 0
        };
        
        // Show processing modal
        const modal = new bootstrap.Modal(document.getElementById('bulkProcessingModal'));
        modal.show();
        
        // Initialize progress
        this.updateProcessingProgress();
        
        try {
            await this.processLinks();
            this.completeProcessing();
        } catch (error) {
            console.error('Bulk import failed:', error);
            showNotification('error', 'ŸÅÿ¥ŸÑ ŸÅŸä ÿßŸÑÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ ÿßŸÑŸÖÿ¨ŸÖÿπ');
        } finally {
            this.isProcessing = false;
        }
    }

    async processLinks() {
        const customDomain = document.getElementById('bulkCustomDomain')?.value || 'turkii.netlify.app';
        const skipErrors = document.getElementById('skipErrors')?.checked || true;
        
        for (let i = 0; i < this.validData.length; i++) {
            if (!this.isProcessing) break; // Stop if cancelled
            
            const linkData = this.validData[i];
            
            try {
                this.updateCurrentItem(linkData);
                
                // Generate link ID
                const linkId = Math.floor(100000 + Math.random() * 900000).toString();
                
                // Create link data
                const newLinkData = {
                    id: linkId,
                    seriesName: linkData.name,
                    linkType: this.selectedContentType,
                    originalUrl: linkData.originalUrl,
                    shortUrl: `https://${customDomain}/?${this.getUrlParam()}=${encodeURIComponent(linkData.name)}&id=${linkId}`,
                    customDomain: customDomain,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                    userId: auth.currentUser?.uid || null,
                    clicks: 0,
                    socialTitle: linkData.socialTitle || `${this.contentTypeNames[this.selectedContentType]} ${linkData.name}`,
                    socialDescription: linkData.socialDescription || `ÿ¥ÿßŸáÿØ ${linkData.name} ÿßŸÑÿ¢ŸÜ!`,
                    socialImage: linkData.socialImage || 'https://via.placeholder.com/1200x630/4A154B/FFFFFF?text=Turkify+Pro',
                    bulkImported: true,
                    importBatch: new Date().toISOString()
                };
                
                // Save to Firebase
                await db.collection('links').doc(linkId).set(newLinkData);
                
                this.processingStats.success++;
                this.addLogEntry('success', `ÿ™ŸÖ ÿ•ŸÜÿ¥ÿßÿ°: ${linkData.name}`);
                
            } catch (error) {
                this.processingStats.failed++;
                this.addLogEntry('error', `ŸÅÿ¥ŸÑ: ${linkData.name} - ${error.message}`);
                
                if (!skipErrors) {
                    throw error;
                }
            }
            
            this.processingStats.processed++;
            this.updateProcessingProgress();
            
            // Small delay to prevent overwhelming Firebase
            await new Promise(resolve => setTimeout(resolve, 100));
        }
    }

    getUrlParam() {
        const params = {
            'series': 'halqat-alyawm-min-musalsal',
            'movie': 'movie',
            'match': 'match',
            'recipe': 'recipe',
            'game': 'game', 
            'app': 'app',
            'channel': 'channel',
            'reels': 'reels'
        };
        return params[this.selectedContentType] || this.selectedContentType;
    }

    updateCurrentItem(linkData) {
        const currentItemName = document.getElementById('currentItemName');
        const currentItemUrl = document.getElementById('currentItemUrl');
        
        if (currentItemName) currentItemName.textContent = linkData.name;
        if (currentItemUrl) currentItemUrl.textContent = linkData.originalUrl;
    }

    updateProcessingProgress() {
        const { total, processed, success, failed } = this.processingStats;
        const remaining = total - processed;
        const percentage = total > 0 ? (processed / total) * 100 : 0;
        
        // Update counters
        document.getElementById('processedCount').textContent = processed;
        document.getElementById('successCount').textContent = success;
        document.getElementById('failedCount').textContent = failed;
        document.getElementById('remainingCount').textContent = remaining;
        
        // Update progress bar
        const progressBar = document.getElementById('bulkProgressBar');
        if (progressBar) {
            progressBar.style.width = `${percentage}%`;
            progressBar.textContent = `${Math.round(percentage)}%`;
        }
        
        // Update progress text
        const progressText = document.getElementById('progressText');
        if (progressText) {
            progressText.textContent = `ÿ™ŸÖÿ™ ŸÖÿπÿßŸÑÿ¨ÿ© ${processed} ŸÖŸÜ ${total} ÿ±ÿßÿ®ÿ∑`;
        }
    }

    addLogEntry(type, message) {
        const logContainer = document.getElementById('processingLog');
        if (!logContainer) return;
        
        const timestamp = new Date().toLocaleTimeString('ar-EG');
        const icons = {
            success: 'fas fa-check-circle',
            error: 'fas fa-times-circle',
            info: 'fas fa-info-circle'
        };
        
        const logEntry = document.createElement('div');
        logEntry.className = `log-entry ${type}`;
        logEntry.innerHTML = `
            <span class="log-timestamp">${timestamp}</span>
            <i class="${icons[type]} me-2"></i>
            <span>${message}</span>
        `;
        
        logContainer.appendChild(logEntry);
        logContainer.scrollTop = logContainer.scrollHeight;
    }

    completeProcessing() {
        const { total, success, failed } = this.processingStats;
        
        // Update current item to completed
        document.getElementById('currentItemName').textContent = 'ŸÖŸÉÿ™ŸÖŸÑ!';
        document.getElementById('currentItemUrl').textContent = `ÿ™ŸÖ ÿ•ŸÜÿ¥ÿßÿ° ${success} ÿ±ÿßÿ®ÿ∑ ÿ®ŸÜÿ¨ÿßÿ≠`;
        
        // Hide spinner
        document.querySelector('.processing-spinner').style.display = 'none';
        
        // Show completion buttons
        document.getElementById('downloadReport').style.display = 'inline-block';
        document.getElementById('closeProcessing').style.display = 'inline-block';
        document.getElementById('cancelProcessing').style.display = 'none';
        
        // Show final notification
        if (failed === 0) {
            showNotification('success', `ÿ™ŸÖ ÿ•ŸÜÿ¥ÿßÿ° ÿ¨ŸÖŸäÿπ ÿßŸÑÿ±Ÿàÿßÿ®ÿ∑ (${success}) ÿ®ŸÜÿ¨ÿßÿ≠!`);
        } else {
            showNotification('warning', `ÿ™ŸÖ ÿ•ŸÜÿ¥ÿßÿ° ${success} ÿ±ÿßÿ®ÿ∑ÿå ŸÅÿ¥ŸÑ ŸÅŸä ${failed} ÿ±ÿßÿ®ÿ∑`);
        }
        
        // Reload links table
        if (typeof loadLinks === 'function') {
            loadLinks();
        }
    }

    cancelProcessing() {
        this.isProcessing = false;
        showNotification('info', 'ÿ™ŸÖ ÿ•ŸäŸÇÿßŸÅ ÿßŸÑÿπŸÖŸÑŸäÿ©');
    }

    downloadReport() {
        const { total, success, failed, processed } = this.processingStats;
        
        const report = {
            timestamp: new Date().toISOString(),
            contentType: this.selectedContentType,
            contentTypeName: this.contentTypeNames[this.selectedContentType],
            fileName: this.uploadedFile?.name,
            summary: {
                totalRows: total,
                processedRows: processed,
                successfulLinks: success,
                failedLinks: failed,
                successRate: ((success / total) * 100).toFixed(2) + '%'
            },
            details: this.validData.map((item, index) => ({
                rowNumber: item.rowNumber,
                name: item.name,
                originalUrl: item.originalUrl,
                status: index < success ? 'success' : 'failed'
            }))
        };
        
        const reportJson = JSON.stringify(report, null, 2);
        const blob = new Blob([reportJson], { type: 'application/json' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = `turkify_bulk_import_report_${new Date().toISOString().split('T')[0]}.json`;
        link.click();
        
        showNotification('success', 'ÿ™ŸÖ ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ™ŸÇÿ±Ÿäÿ± ÿ®ŸÜÿ¨ÿßÿ≠!');
    }
}

// Initialize bulk import system
let bulkImport;

document.addEventListener('DOMContentLoaded', function() {
    // Check if we're on admin page
    const adminPanel = document.getElementById('adminPanel');
    if (adminPanel) {
        bulkImport = new BulkLinkImport();
    }
});
        
    </script>
</body>
</html>
